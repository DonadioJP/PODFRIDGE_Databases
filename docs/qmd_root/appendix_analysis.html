<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tina Lasisi &amp; João P. Donadio">
<meta name="dcterms.date" content="2025-10-04">

<title>Annual DNA collection from Murphy &amp; Tong Study – PODFRIDGE-Databases</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-985aa47af68dae11cd4d235c71fb941e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="../site_libs/datatables-binding-0.34.0/datatables.js"></script>

<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="../site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">

<script src="../site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>

<script src="../site_libs/jszip-1.13.6/jszip.min.js"></script>

<link href="../site_libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">

<script src="../site_libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script>

<script src="../site_libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script>

<script src="../site_libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script>

<script src="../site_libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script>

<link href="../site_libs/dt-ext-colreorder-1.13.6/css/colReorder.dataTables.min.css" rel="stylesheet">

<script src="../site_libs/dt-ext-colreorder-1.13.6/js/dataTables.colReorder.min.js"></script>

<link href="../site_libs/dt-ext-scroller-1.13.6/css/scroller.dataTables.min.css" rel="stylesheet">

<script src="../site_libs/dt-ext-scroller-1.13.6/js/dataTables.scroller.min.js"></script>

<link href="../site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">

<script src="../site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>

<link href="../site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">

<script src="../site_libs/selectize-0.12.0/selectize.min.js"></script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">



<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PODFRIDGE-Databases</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analyses" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analyses</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analyses">    
        <li>
    <a class="dropdown-item" href="../analysis/ndis_scraping.html">
 <span class="dropdown-text">NDIS analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../analysis/sdis_summary.html">
 <span class="dropdown-text">SDIS summary</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../analysis/foia_processing.html">
 <span class="dropdown-text">FOIA processing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../analysis/appendix_analysis.html">
 <span class="dropdown-text">Appendix racial analysis</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#executive-summary" id="toc-executive-summary" class="nav-link active" data-scroll-target="#executive-summary">Executive Summary</a>
  <ul class="collapse">
  <li><a href="#key-findings" id="toc-key-findings" class="nav-link" data-scroll-target="#key-findings">Key Findings</a></li>
  </ul></li>
  <li><a href="#methodology-overview" id="toc-methodology-overview" class="nav-link" data-scroll-target="#methodology-overview">Methodology Overview</a>
  <ul class="collapse">
  <li><a href="#data-collection-period" id="toc-data-collection-period" class="nav-link" data-scroll-target="#data-collection-period">Data Collection Period</a></li>
  <li><a href="#general-challenges-encountered" id="toc-general-challenges-encountered" class="nav-link" data-scroll-target="#general-challenges-encountered">General Challenges Encountered</a></li>
  </ul></li>
  <li><a href="#national-summary-table" id="toc-national-summary-table" class="nav-link" data-scroll-target="#national-summary-table">National Summary Table</a>
  <ul class="collapse">
  <li><a href="#methodology-parsing-dna-collection-data" id="toc-methodology-parsing-dna-collection-data" class="nav-link" data-scroll-target="#methodology-parsing-dna-collection-data">Methodology: Parsing DNA Collection Data</a></li>
  <li><a href="#disparity-analysis" id="toc-disparity-analysis" class="nav-link" data-scroll-target="#disparity-analysis">Disparity Analysis</a></li>
  </ul></li>
  <li><a href="#state-by-state-detailed-methodology" id="toc-state-by-state-detailed-methodology" class="nav-link" data-scroll-target="#state-by-state-detailed-methodology">State-by-State Detailed Methodology</a>
  <ul class="collapse">
  <li><a href="#methodology-parsing-state-methodology-paragraphs" id="toc-methodology-parsing-state-methodology-paragraphs" class="nav-link" data-scroll-target="#methodology-parsing-state-methodology-paragraphs">Methodology: Parsing State Methodology Paragraphs</a></li>
  </ul></li>
  <li><a href="#combining-information-into-master-dataset" id="toc-combining-information-into-master-dataset" class="nav-link" data-scroll-target="#combining-information-into-master-dataset">Combining Information into Master Dataset</a></li>
  <li><a href="#data-export-and-versioning" id="toc-data-export-and-versioning" class="nav-link" data-scroll-target="#data-export-and-versioning">Data Export and Versioning</a></li>
  <li><a href="#summary-and-key-findings" id="toc-summary-and-key-findings" class="nav-link" data-scroll-target="#summary-and-key-findings">Summary and Key Findings</a>
  <ul class="collapse">
  <li><a href="#dataset-completeness" id="toc-dataset-completeness" class="nav-link" data-scroll-target="#dataset-completeness">Dataset Completeness</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Annual DNA collection from Murphy &amp; Tong Study</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tina Lasisi &amp; João P. Donadio </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 4, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="executive-summary" class="level2">
<h2 class="anchored" data-anchor-id="executive-summary">Executive Summary</h2>
<p>This document provides complete transparency regarding the data sources and methodology used to compile racial disparities in DNA collection across U.S. states. The original data was collected in Summer 2017, with most data points from 2013-2016.</p>
<section id="key-findings" class="level3">
<h3 class="anchored" data-anchor-id="key-findings">Key Findings</h3>
<ul>
<li><p><strong>Consistent racial disparities</strong>: Black populations show the highest DNA collection rates relative to their population percentage in nearly all states</p></li>
<li><p><strong>Data limitations</strong>: Many states lack comprehensive conviction data, requiring the use of prison admission proxies</p></li>
<li><p><strong>Methodological challenges</strong>: Hispanic/Latino populations often uncounted or miscategorized in state data</p></li>
</ul>
</section>
</section>
<section id="methodology-overview" class="level2">
<h2 class="anchored" data-anchor-id="methodology-overview">Methodology Overview</h2>
<section id="data-collection-period" class="level3">
<h3 class="anchored" data-anchor-id="data-collection-period">Data Collection Period</h3>
<ul>
<li><p>Primary collection: Summer 2017</p></li>
<li><p>Data years used: Single year per state (2012-2016, varies by availability)</p></li>
<li><p>Census baseline: 2010 U.S. Census for demographic comparisons</p></li>
</ul>
</section>
<section id="general-challenges-encountered" class="level3">
<h3 class="anchored" data-anchor-id="general-challenges-encountered">General Challenges Encountered</h3>
<ol type="1">
<li><p><strong>Conviction Data Scarcity</strong>: Most states do not publicly disclose comprehensive felony conviction data</p></li>
<li><p><strong>Prison Admission Proxy</strong>: Prison admissions used as substitute for conviction data in majority of states</p></li>
<li><p><strong>Racial Classification Inconsistencies</strong>:</p></li>
</ol>
<pre><code>-   Many states only report "Black" and "White" categories

-   Hispanic/Latino often classified as ethnicity rather than race

-   "Other" category frequently used without specification</code></pre>
<ol start="4" type="1">
<li><strong>Arrest Data Gaps</strong>: Racial makeup of arrests often unavailable or incomplete</li>
</ol>
</section>
</section>
<section id="national-summary-table" class="level2">
<h2 class="anchored" data-anchor-id="national-summary-table">National Summary Table</h2>
<section id="methodology-parsing-dna-collection-data" class="level3">
<h3 class="anchored" data-anchor-id="methodology-parsing-dna-collection-data">Methodology: Parsing DNA Collection Data</h3>
<p>The national summary data was extracted from a structured text file (<code>MurphyTong_Racial_Breakdown.txt</code>) containing three distinct data sections for each state:</p>
<ol type="1">
<li><strong>DNA Collection Data</strong>: Percentage and absolute counts of DNA profiles collected by race (e.g., “46% B (18,253)”)</li>
<li><strong>Population Demographics</strong>: Percentage of state population by race from 2010 Census</li>
</ol>
<p><strong>Processing Steps</strong>:</p>
<ul>
<li><strong>State Identification</strong>: The parser identifies state entries using standard two-letter abbreviations (AL, AK, AZ, etc.)</li>
<li><strong>Section Segmentation</strong>: For each state, the text is divided into three sections based on the pattern of “% B” (Black percentage) occurrences</li>
<li><strong>Data Extraction</strong>: Regular expressions extract both percentages and counts from the first section, and percentages only from the demographic and rate sections</li>
<li><strong>Pattern Matching</strong>: The code uses regex patterns like <code>([0-9.]+)%\s*B\s*\(([0-9,]+)\)</code> to capture both percentage (e.g., 46%) and count (e.g., 18,253) for DNA collection data</li>
<li><strong>Race Categories</strong>: Data is extracted for five racial categories: Black (B), Hispanic (H), Asian (A), Native American (N), and White (W)</li>
</ul>
<p>This automated parsing ensures reproducibility and allows for systematic extraction of data from the original Murphy &amp; Tong study format.</p>
<div class="cell">
<details class="code-fold">
<summary>Show summary code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to parse DNA collection data from text file</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>parse_dna_data <span class="ot">&lt;-</span> <span class="cf">function</span>(file_path) {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read the entire file</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  text_data <span class="ot">&lt;-</span> <span class="fu">readLines</span>(file_path, <span class="at">warn =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove empty lines</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  text_data <span class="ot">&lt;-</span> text_data[text_data <span class="sc">!=</span> <span class="st">""</span>]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize list to store parsed data</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  parsed_data <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># State abbreviations (for reference)</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  state_abbrevs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"AL"</span>, <span class="st">"AK"</span>, <span class="st">"AZ"</span>, <span class="st">"AR"</span>, <span class="st">"CA"</span>, <span class="st">"CO"</span>, <span class="st">"CT"</span>, <span class="st">"DE"</span>, <span class="st">"FL"</span>, <span class="st">"GA"</span>, </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"HI"</span>, <span class="st">"ID"</span>, <span class="st">"IL"</span>, <span class="st">"IN"</span>, <span class="st">"IA"</span>, <span class="st">"KS"</span>, <span class="st">"KY"</span>, <span class="st">"LA"</span>, <span class="st">"ME"</span>, <span class="st">"MD"</span>, </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"MA"</span>, <span class="st">"MI"</span>, <span class="st">"MN"</span>, <span class="st">"MS"</span>, <span class="st">"MO"</span>, <span class="st">"MT"</span>, <span class="st">"NE"</span>, <span class="st">"NV"</span>, <span class="st">"NH"</span>, <span class="st">"NJ"</span>, </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"NM"</span>, <span class="st">"NY"</span>, <span class="st">"NC"</span>, <span class="st">"ND"</span>, <span class="st">"OH"</span>, <span class="st">"OK"</span>, <span class="st">"OR"</span>, <span class="st">"PA"</span>, <span class="st">"RI"</span>, <span class="st">"SC"</span>, </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"SD"</span>, <span class="st">"TN"</span>, <span class="st">"TX"</span>, <span class="st">"UT"</span>, <span class="st">"VT"</span>, <span class="st">"VA"</span>, <span class="st">"WA"</span>, <span class="st">"WV"</span>, <span class="st">"WI"</span>, <span class="st">"WY"</span>, <span class="st">"DC"</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Function to extract percentage and count from patterns like "46% B (18,253)"</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  extract_race_data <span class="ot">&lt;-</span> <span class="cf">function</span>(text, race_letter) {</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    pattern <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"([0-9.]+)%</span><span class="sc">\\</span><span class="st">s*"</span>, race_letter, <span class="st">"</span><span class="sc">\\</span><span class="st">s*</span><span class="sc">\\</span><span class="st">(([0-9,]+)</span><span class="sc">\\</span><span class="st">)"</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    matches <span class="ot">&lt;-</span> <span class="fu">str_match</span>(text, pattern)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(matches[<span class="dv">1</span>])) {</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>      pct <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(matches[<span class="dv">2</span>])</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>      count <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, matches[<span class="dv">3</span>]))</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">pct =</span> pct, <span class="at">count =</span> count))</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">pct =</span> <span class="cn">NA</span>, <span class="at">count =</span> <span class="cn">NA</span>))</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Function to extract just percentage (for demographics and collection rates)</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  extract_percentage <span class="ot">&lt;-</span> <span class="cf">function</span>(text, race_letter) {</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    pattern <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"([0-9.]+)%</span><span class="sc">\\</span><span class="st">s*"</span>, race_letter)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    matches <span class="ot">&lt;-</span> <span class="fu">str_match</span>(text, pattern)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(matches[<span class="dv">1</span>])) {</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">as.numeric</span>(matches[<span class="dv">2</span>]))</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Process each line</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (i <span class="sc">&lt;=</span> <span class="fu">length</span>(text_data)) {</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    line <span class="ot">&lt;-</span> text_data[i]</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if line is a state abbreviation</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (line <span class="sc">%in%</span> state_abbrevs) {</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>      state <span class="ot">&lt;-</span> line</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Initialize data structure for this state</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>      state_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> state,</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">Black_DNA_Pct =</span> <span class="cn">NA</span>, <span class="at">Black_DNA_N =</span> <span class="cn">NA</span>,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">Hispanic_DNA_Pct =</span> <span class="cn">NA</span>, <span class="at">Hispanic_DNA_N =</span> <span class="cn">NA</span>,</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">Asian_DNA_Pct =</span> <span class="cn">NA</span>, <span class="at">Asian_DNA_N =</span> <span class="cn">NA</span>,</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">Native_American_DNA_Pct =</span> <span class="cn">NA</span>, <span class="at">Native_American_DNA_N =</span> <span class="cn">NA</span>,</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">White_DNA_Pct =</span> <span class="cn">NA</span>, <span class="at">White_DNA_N =</span> <span class="cn">NA</span>,</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">Black_Pop_Pct =</span> <span class="cn">NA</span>, <span class="at">Hispanic_Pop_Pct =</span> <span class="cn">NA</span>, <span class="at">Asian_Pop_Pct =</span> <span class="cn">NA</span>,</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">Native_American_Pop_Pct =</span> <span class="cn">NA</span>, <span class="at">White_Pop_Pct =</span> <span class="cn">NA</span>,</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">Black_Collection_Rate =</span> <span class="cn">NA</span>, <span class="at">Hispanic_Collection_Rate =</span> <span class="cn">NA</span>,</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">Asian_Collection_Rate =</span> <span class="cn">NA</span>, <span class="at">Native_American_Collection_Rate =</span> <span class="cn">NA</span>,</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">White_Collection_Rate =</span> <span class="cn">NA</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Collect all lines for this state until we hit the next state or end of file</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>      state_lines <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>      i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>      <span class="cf">while</span> (i <span class="sc">&lt;=</span> <span class="fu">length</span>(text_data) <span class="sc">&amp;&amp;</span> <span class="sc">!</span>(text_data[i] <span class="sc">%in%</span> state_abbrevs)) {</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>        state_lines <span class="ot">&lt;-</span> <span class="fu">c</span>(state_lines, text_data[i])</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>        i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Combine all lines for this state into one text block</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>      state_text <span class="ot">&lt;-</span> <span class="fu">paste</span>(state_lines, <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Split into sections based on the pattern of % B occurrences</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>      <span class="co"># We need to identify the three sections: DNA Collection, Demographics, Collection Rates</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Find all "% B" patterns to help identify sections</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>      b_patterns <span class="ot">&lt;-</span> <span class="fu">str_locate_all</span>(state_text, <span class="st">"[0-9.]+%</span><span class="sc">\\</span><span class="st">s*B"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(b_patterns) <span class="sc">&gt;=</span> <span class="dv">1</span>) {</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>        <span class="co"># First section: DNA Collection (has counts in parentheses)</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>        dna_section_start <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>        dna_section_end <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">nrow</span>(b_patterns) <span class="sc">&gt;=</span> <span class="dv">2</span>) b_patterns[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span> <span class="cf">else</span> <span class="fu">nchar</span>(state_text)</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>        dna_section <span class="ot">&lt;-</span> <span class="fu">substr</span>(state_text, dna_section_start, dna_section_end)</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract DNA collection data (with counts)</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>        black_dna <span class="ot">&lt;-</span> <span class="fu">extract_race_data</span>(dna_section, <span class="st">"B"</span>)</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>        hispanic_dna <span class="ot">&lt;-</span> <span class="fu">extract_race_data</span>(dna_section, <span class="st">"H"</span>)</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>        asian_dna <span class="ot">&lt;-</span> <span class="fu">extract_race_data</span>(dna_section, <span class="st">"A"</span>)</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>        native_dna <span class="ot">&lt;-</span> <span class="fu">extract_race_data</span>(dna_section, <span class="st">"N"</span>)</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>        white_dna <span class="ot">&lt;-</span> <span class="fu">extract_race_data</span>(dna_section, <span class="st">"W"</span>)</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Black_DNA_Pct <span class="ot">&lt;-</span> black_dna<span class="sc">$</span>pct</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Black_DNA_N <span class="ot">&lt;-</span> black_dna<span class="sc">$</span>count</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Hispanic_DNA_Pct <span class="ot">&lt;-</span> hispanic_dna<span class="sc">$</span>pct</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Hispanic_DNA_N <span class="ot">&lt;-</span> hispanic_dna<span class="sc">$</span>count</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Asian_DNA_Pct <span class="ot">&lt;-</span> asian_dna<span class="sc">$</span>pct</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Asian_DNA_N <span class="ot">&lt;-</span> asian_dna<span class="sc">$</span>count</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Native_American_DNA_Pct <span class="ot">&lt;-</span> native_dna<span class="sc">$</span>pct</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Native_American_DNA_N <span class="ot">&lt;-</span> native_dna<span class="sc">$</span>count</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>White_DNA_Pct <span class="ot">&lt;-</span> white_dna<span class="sc">$</span>pct</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>White_DNA_N <span class="ot">&lt;-</span> white_dna<span class="sc">$</span>count</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(b_patterns) <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Second section: Demographics (percentages only, no parentheses)</span></span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>        demo_section_start <span class="ot">&lt;-</span> b_patterns[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>        demo_section_end <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">nrow</span>(b_patterns) <span class="sc">&gt;=</span> <span class="dv">3</span>) b_patterns[<span class="dv">3</span>,<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span> <span class="cf">else</span> <span class="fu">nchar</span>(state_text)</span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>        demo_section <span class="ot">&lt;-</span> <span class="fu">substr</span>(state_text, demo_section_start, demo_section_end)</span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract demographic percentages</span></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Black_Pop_Pct <span class="ot">&lt;-</span> <span class="fu">extract_percentage</span>(demo_section, <span class="st">"B"</span>)</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Hispanic_Pop_Pct <span class="ot">&lt;-</span> <span class="fu">extract_percentage</span>(demo_section, <span class="st">"H"</span>)</span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Asian_Pop_Pct <span class="ot">&lt;-</span> <span class="fu">extract_percentage</span>(demo_section, <span class="st">"A"</span>)</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Native_American_Pop_Pct <span class="ot">&lt;-</span> <span class="fu">extract_percentage</span>(demo_section, <span class="st">"N"</span>)</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>White_Pop_Pct <span class="ot">&lt;-</span> <span class="fu">extract_percentage</span>(demo_section, <span class="st">"W"</span>)</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(b_patterns) <span class="sc">&gt;=</span> <span class="dv">3</span>) {</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Third section: Collection Rates (percentages only, no parentheses)</span></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>        rate_section_start <span class="ot">&lt;-</span> b_patterns[<span class="dv">3</span>,<span class="dv">1</span>]</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>        rate_section <span class="ot">&lt;-</span> <span class="fu">substr</span>(state_text, rate_section_start, <span class="fu">nchar</span>(state_text))</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract collection rate percentages</span></span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Black_Collection_Rate <span class="ot">&lt;-</span> <span class="fu">extract_percentage</span>(rate_section, <span class="st">"B"</span>)</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Hispanic_Collection_Rate <span class="ot">&lt;-</span> <span class="fu">extract_percentage</span>(rate_section, <span class="st">"H"</span>)</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Asian_Collection_Rate <span class="ot">&lt;-</span> <span class="fu">extract_percentage</span>(rate_section, <span class="st">"A"</span>)</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>Native_American_Collection_Rate <span class="ot">&lt;-</span> <span class="fu">extract_percentage</span>(rate_section, <span class="st">"N"</span>)</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>        state_data<span class="sc">$</span>White_Collection_Rate <span class="ot">&lt;-</span> <span class="fu">extract_percentage</span>(rate_section, <span class="st">"W"</span>)</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add to parsed data</span></span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>      parsed_data[[<span class="fu">length</span>(parsed_data) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> state_data</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Don't increment i here since we already did it in the while loop</span></span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>      i <span class="ot">&lt;-</span> i <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to data frame</span></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(parsed_data, data.frame))</span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>racial_data_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"annual_dna_collection"</span>, <span class="st">"intermediate"</span>, <span class="st">"MurphyTong_Racial_Breakdown.txt"</span>))</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> <span class="fu">parse_dna_data</span>(racial_data_path)</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a><span class="co"># Display interactive table</span></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(summary_data, </span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>, <span class="at">scrollX =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>          <span class="at">caption =</span> <span class="st">"Complete state-by-state breakdown of DNA collection by race"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-national-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-national-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Racial Breakdown of Annual DNA Collection for Each State
</figcaption>
<div aria-describedby="tbl-national-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-edfac98c4e3470a54e0c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-edfac98c4e3470a54e0c">{"x":{"filter":"none","vertical":false,"caption":"<caption>Complete state-by-state breakdown of DNA collection by race<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50"],["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],[46,7.6,12.6,42.3,25,12.8,25.5,79.90000000000001,34.8,54.5,4.6,3,58.2,24.8,20.8,26.8,29.3,65.8,7.1,62.8,18.5,33.4,25.6,59.6,31.4,1.9,23.1,28.5,6.4,52.8,6,51.8,52.3,9.199999999999999,36.2,26.7,10.2,40.6,25.4,54,7.3,35.9,31.2,5.4,10.7,50.5,18.6,28,37.3,3.9],[18253,914,9313,4401,141488,28486,2250,9399,280152,9851,516,244,18094,3591,4793,13016,34762,10840,226,34835,2712,85888,39743,6328,3701,47,566,1602,40,9444,157,68684,12270,2983,26015,2841,515,4159,3672,3752,2961,14544,22169,5993,295,6249,1376,955,3482,129],[null,2.8,32,2.7,37.6,24,18.1,5.6,0.5,2.4,4.6,16.2,12.6,2.8,3.3,null,5.1,4,2,null,15.6,0.1,null,0.9,1.1,null,11.4,21.3,null,8.4,52,31.6,null,0.3,0.6,7.7,16.3,9.699999999999999,20.3,null,null,0.5,32.8,0.1,null,2.4,14.4,6,null,14.4],[null,23604,23604,275,213361,53778,1591,660,4338,433,516,1300,3906,398,751,null,5993,657,65,null,2288,357,null,91,130,null,279,1201,null,1499,1363,41970,null,92,402,815,824,991,2941,null,null,213,23267,141,null,294,1070,205,null,484],[null,3,0.5,0.04,null,0.03,null,null,0.6,0.4,21.6,null,null,null,0.9,0.1,null,null,null,0.7,null,0.4,2.7,null,0.4,1,0.5,2.4,0.5,1.3,null,3.7,0.05,0.6,0.03,null,null,null,null,null,0.7,0.3,null,2.4,0.9,null,null,null,1.2,null],[null,365,358,4,null,61,null,null,4420,72,2399,null,null,null,199,62,null,null,null,372,null,946,4129,null,50,24,11,135,3,225,null,4939,11,178,25,null,null,null,null,null,287,127,null,2597,25,null,null,null,111,null],[null,43.1,8.199999999999999,null,0.4,0.08,null,null,0.1,0.05,42.1,3,null,null,1.1,0.3,1,null,2,0.1,null,0.5,5.1,null,0.2,17.4,4.6,1.8,0.5,0.1,11,null,0.1,15.1,0.02,10.8,3.1,null,null,null,29.6,0.1,null,5.9,0.4,null,5.2,1,5.1,7.7],[null,5191,6041,null,2177,189,null,null,1074,9,4682,244,null,null,253,142,1199,null,65,77,null,1347,7912,null,20,428,112,101,3,22,288,null,31,4893,17,1147,154,null,null,null,12028,40,null,6466,11,null,382,34,478,258],[54,43.5,46.6,55,37,63.1,56.4,14.5,64,42.1,27.1,77.8,29.3,72.40000000000001,74,72.8,64.7,30.2,88.90000000000001,36.4,65.90000000000001,65.5,66.7,39.5,66.90000000000001,79.7,60.5,46,92.59999999999999,37.5,31,12.9,47.5,74.5,63.2,54.9,70.40000000000001,49.7,54.3,46,62.5,63.2,36,86.2,88,47.1,61.9,65,56.3,74],[21292,5237,34353,5715,210144,140920,4968,1701,514348,4682,3018,6253,9094,10479,17021,35318,76716,4972,2846,20207,9681,168422,103741,4193,7882,1961,1483,2590,578,6708,813,17116,11138,24363,45454,5853,3552,5088,7852,3203,25411,25620,25519,94992,2423,5836,4585,2218,5253,2482],[26.8,3.9,4.8,15.7,6.5,4.5,11.6,22.4,16.8,31.7,2.6,0.8,14.7,9.6,3.5,6.3,8.300000000000001,32.5,1.4,30.5,8.4,14.2,6,37.6,11.8,0.6,5,9.300000000000001,1.5,14.8,2.6,17.6,22.1,2.4,12.7,7.8,2.1,11.7,7.9,27.6,1.8,17.1,12.5,1.3,1.3,19.7,4.1,3.6,6.6,1.4],[4.2,7,30.7,7.2,38.8,21.3,15.4,9,24.5,9.4,10.4,12.2,16.9,6.7,5.7,11.6,3.4,5,1.6,9.5,11.2,4.9,5.2,3.1,4.1,3.6,10.4,28.1,3.4,19.7,48,18.8,9.1,3.5,3.6,10.1,12.7,6.8,14.4,5.5,3.6,5.2,38.8,13.7,1.8,9,12.4,1.5,6.6,9.9],[1.4,6.3,3.4,1.6,14.7,3.2,4.6,3.9,2.8,4,37.3,1.5,5.5,2.1,2.4,2.9,1.4,1.8,1.2,6.5,6.6,3,4.9,1.1,2,0.8,2.3,8.5,2.6,9.699999999999999,1.7,8.800000000000001,2.8,1.4,2.1,2.2,4.4,3.4,3.6,1.6,1.4,1.8,4.7,2.5,1.6,6.5,8.4,0.8,2.8,1],[0.7,14.8,5.3,null,1.7,1.6,0.5,0.7,0.5,0.5,9.9,1.7,0.6,0.4,0.5,1.2,0.3,0.8,0.7,0.6,0.5,0.7,1.3,0.6,0.6,6.6,1.4,1.6,0.2,0.6,10.5,1,1.6,5.5,0.3,9.1,1.8,0.4,1,0.5,8.9,0.4,1,1.5,0.4,0.5,1.9,0.2,1.1,2.7],[66,61.5,55.8,73.09999999999999,38,68.7,68.2,63.2,55.3,53.9,22.9,82.5,61.9,80,86.7,76.40000000000001,85.09999999999999,59.1,93.59999999999999,52,73.5,75.59999999999999,81,57,79.8,86.5,80,50.7,91,56.2,38.4,56,63.8,85.8,79.8,66.5,76.59999999999999,77.40000000000001,73.90000000000001,63.8,82.90000000000001,74.40000000000001,43,79,93.3,62.7,69.8,92.3,81.90000000000001,84],[1.4,3.2,2.8,0.9,5.6,11.4,0.5,4.4,8.1,0.3,1.4,1.8,1,0.6,4.4,7,9.4,0.7,1.2,1.9,0.5,6.1,12,0.6,0.5,0.8,0.6,0.6,0.2,0.7,0.3,2,0.6,16.4,1.8,0.9,0.6,0.3,4.4,0.3,19,1.3,0.6,15,3.6,0.4,0.5,1.5,0.9,1.6],[null,0.7,1.1,0.1,1.4,4.6,0.3,0.8,0.1,0.04,0.4,0.6,0.2,0.1,0.4,null,4,0.3,0.3,null,0.3,0.1,null,0.1,0.1,null,0.1,0.2,null,0.1,0.1,1.1,null,0.4,0.1,0.2,0.2,0.1,1.9,null,null,0.1,0.2,0.03,null,0.04,0.1,0.8,null,0.8],[null,0.8,0.2,0.01,null,0.03,null,null,0.8,0.02,0.5,null,null,null,0.3,0.1,null,null,null,0.1,null,0.3,1.5,null,0.04,0.3,0.03,0.1,0.01,0.03,null,0.3,null,1.7,0.01,null,null,null,null,null,2.4,0.1,null,3.4,0.3,null,null,null,0.1,null],[null,4.7,1.6,null,0.3,null,null,null,1,0.02,3.3,0.9,null,null,1.6,0.4,9,null,0.7,0.2,null,1.9,11,null,0.1,0.6,0.4,0.2,0.1,0.04,0.1,null,0.02,11.7,0.1,0.3,0.2,null,null,null,15.6,0.2,null,14.1,0.4,null,0.3,0.9,0.8,1.6],[0.7,1.2,0.9,0.3,1.4,3.7,0.2,0.3,4.5,0.1,0.9,0.5,0.1,0.2,0.6,0.6,2,0.2,0.2,0.7,0.2,2.2,2.3,0.3,0.2,0.2,0.1,0.2,0.1,0.1,0.1,0.2,0.2,3.8,0.5,0.2,0.1,0.1,1,0.1,3.5,0.5,0.2,3.9,0.4,0.1,0.1,0.1,0.1,0.5]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>State<\/th>\n      <th>Black_DNA_Pct<\/th>\n      <th>Black_DNA_N<\/th>\n      <th>Hispanic_DNA_Pct<\/th>\n      <th>Hispanic_DNA_N<\/th>\n      <th>Asian_DNA_Pct<\/th>\n      <th>Asian_DNA_N<\/th>\n      <th>Native_American_DNA_Pct<\/th>\n      <th>Native_American_DNA_N<\/th>\n      <th>White_DNA_Pct<\/th>\n      <th>White_DNA_N<\/th>\n      <th>Black_Pop_Pct<\/th>\n      <th>Hispanic_Pop_Pct<\/th>\n      <th>Asian_Pop_Pct<\/th>\n      <th>Native_American_Pop_Pct<\/th>\n      <th>White_Pop_Pct<\/th>\n      <th>Black_Collection_Rate<\/th>\n      <th>Hispanic_Collection_Rate<\/th>\n      <th>Asian_Collection_Rate<\/th>\n      <th>Native_American_Collection_Rate<\/th>\n      <th>White_Collection_Rate<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"State","targets":1},{"name":"Black_DNA_Pct","targets":2},{"name":"Black_DNA_N","targets":3},{"name":"Hispanic_DNA_Pct","targets":4},{"name":"Hispanic_DNA_N","targets":5},{"name":"Asian_DNA_Pct","targets":6},{"name":"Asian_DNA_N","targets":7},{"name":"Native_American_DNA_Pct","targets":8},{"name":"Native_American_DNA_N","targets":9},{"name":"White_DNA_Pct","targets":10},{"name":"White_DNA_N","targets":11},{"name":"Black_Pop_Pct","targets":12},{"name":"Hispanic_Pop_Pct","targets":13},{"name":"Asian_Pop_Pct","targets":14},{"name":"Native_American_Pop_Pct","targets":15},{"name":"White_Pop_Pct","targets":16},{"name":"Black_Collection_Rate","targets":17},{"name":"Hispanic_Collection_Rate","targets":18},{"name":"Asian_Collection_Rate","targets":19},{"name":"Native_American_Collection_Rate","targets":20},{"name":"White_Collection_Rate","targets":21}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="disparity-analysis" class="level3">
<h3 class="anchored" data-anchor-id="disparity-analysis">Disparity Analysis</h3>
<div class="cell">
<details class="code-fold">
<summary>Show disparity analysis code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate disparity ratios</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>disparity_data <span class="ot">&lt;-</span> summary_data <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Black_Collection_Rate) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(White_Collection_Rate)) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Black_White_Ratio =</span> Black_Collection_Rate <span class="sc">/</span> White_Collection_Rate) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Black_White_Ratio))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(disparity_data <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">20</span>), <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(State, Black_White_Ratio), <span class="at">y =</span> Black_White_Ratio)) <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"darkred"</span>) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 20 States: Black-White DNA Collection Disparity Ratio"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Ratio of collection rates (higher = greater disparity)"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"State"</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Black/White Collection Rate Ratio"</span>) <span class="sc">+</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-disparity-rates" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-disparity-rates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="appendix_analysis_files/figure-html/fig-disparity-rates-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-disparity-rates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: DNA Collection Rates by Race Relative to Population Percentage
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="state-by-state-detailed-methodology" class="level2">
<h2 class="anchored" data-anchor-id="state-by-state-detailed-methodology">State-by-State Detailed Methodology</h2>
<section id="methodology-parsing-state-methodology-paragraphs" class="level3">
<h3 class="anchored" data-anchor-id="methodology-parsing-state-methodology-paragraphs">Methodology: Parsing State Methodology Paragraphs</h3>
<p>The detailed methodology for each state was extracted from a separate text file (<code>MurphyTong_States_Paragraphs.txt</code>) containing narrative descriptions of data collection approaches for all 50 states. This section explains how we systematically parsed this unstructured text into a structured dataset.</p>
<p><strong>Processing Steps</strong>:</p>
<ol type="1">
<li><p><strong>State Detection</strong>: The parser identifies state entries by searching for the 50 U.S. state names as they appear in the text</p></li>
<li><p><strong>Section Extraction</strong>: For each state, the parser captures all text from the state name until the next state name appears</p></li>
<li><p><strong>Component Parsing</strong>: Within each state’s section, the code extracts four key components:</p>
<ul>
<li><strong>Legal Framework</strong>: The statutory basis for DNA collection in that state</li>
<li><strong>Collection Triggers</strong>: Specific offenses or events that trigger DNA collection</li>
<li><strong>Data Sources</strong>: Types of data used (e.g., conviction records, prison admissions, arrest data)</li>
<li><strong>Source URLs</strong>: Web links to the original data sources</li>
<li><strong>Data Limitations</strong>: Known gaps, proxies, or methodological caveats</li>
</ul></li>
<li><p><strong>Structured Data Creation</strong>: Each data source line is parsed into a type-note pair (e.g., “Prison admissions: Used as proxy for conviction data”)</p></li>
<li><p><strong>Categorization</strong>: The parser automatically categorizes:</p>
<ul>
<li><strong>Collection trigger types</strong>: Comprehensive, selective, felony-only, etc.</li>
<li><strong>Data limitation types</strong>: Missing conviction data, ethnicity issues, limited racial categories, etc.</li>
<li><strong>Data source types</strong>: Conviction data, arrest data, prison data, sex crime data, etc.</li>
</ul></li>
</ol>
<p>This systematic extraction allows for consistent comparison across states and identification of common patterns in data collection methodologies and limitations.</p>
<div class="cell">
<details class="code-fold">
<summary>Show paragraph extraction code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-define all 50 U.S. states</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>us_states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Alabama"</span>, <span class="st">"Alaska"</span>, <span class="st">"Arizona"</span>, <span class="st">"Arkansas"</span>, <span class="st">"California"</span>, <span class="st">"Colorado"</span>, <span class="st">"Connecticut"</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Delaware"</span>, <span class="st">"Florida"</span>, <span class="st">"Georgia"</span>, <span class="st">"Hawaii"</span>, <span class="st">"Idaho"</span>, <span class="st">"Illinois"</span>, <span class="st">"Indiana"</span>, <span class="st">"Iowa"</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Kansas"</span>, <span class="st">"Kentucky"</span>, <span class="st">"Louisiana"</span>, <span class="st">"Maine"</span>, <span class="st">"Maryland"</span>, <span class="st">"Massachusetts"</span>, <span class="st">"Michigan"</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Minnesota"</span>, <span class="st">"Mississippi"</span>, <span class="st">"Missouri"</span>, <span class="st">"Montana"</span>, <span class="st">"Nebraska"</span>, <span class="st">"Nevada"</span>, <span class="st">"New Hampshire"</span>, </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"New Jersey"</span>, <span class="st">"New Mexico"</span>, <span class="st">"New York"</span>, <span class="st">"North Carolina"</span>, <span class="st">"North Dakota"</span>, <span class="st">"Ohio"</span>, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Oklahoma"</span>, <span class="st">"Oregon"</span>, <span class="st">"Pennsylvania"</span>, <span class="st">"Rhode Island"</span>, <span class="st">"South Carolina"</span>, <span class="st">"South Dakota"</span>, </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Tennessee"</span>, <span class="st">"Texas"</span>, <span class="st">"Utah"</span>, <span class="st">"Vermont"</span>, <span class="st">"Virginia"</span>, <span class="st">"Washington"</span>, <span class="st">"West Virginia"</span>, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Wisconsin"</span>, <span class="st">"Wyoming"</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the text file</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>data_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"annual_dna_collection"</span>, <span class="st">"intermediate"</span>, <span class="st">"MurphyTong_States_Paragraphs.txt"</span>))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>text_content <span class="ot">&lt;-</span> <span class="fu">readLines</span>(data_file, <span class="at">warn =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all lines into a single string</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>full_text <span class="ot">&lt;-</span> <span class="fu">paste</span>(text_content, <span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pattern to match state names</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>state_pattern <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"(?m)^[[:space:]]*("</span>, <span class="fu">paste</span>(us_states, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="st">")</span><span class="sc">\\</span><span class="st">b"</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>state_matches <span class="ot">&lt;-</span> <span class="fu">str_locate_all</span>(full_text, state_pattern)[[<span class="dv">1</span>]]</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract state sections</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>state_sections <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>state_names <span class="ot">&lt;-</span> <span class="fu">character</span>()</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(state_matches) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(state_matches)) {</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    start_pos <span class="ot">&lt;-</span> state_matches[i, <span class="st">"start"</span>]</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">&lt;</span> <span class="fu">nrow</span>(state_matches)) {</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>      end_pos <span class="ot">&lt;-</span> state_matches[i <span class="sc">+</span> <span class="dv">1</span>, <span class="st">"start"</span>] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>      end_pos <span class="ot">&lt;-</span> <span class="fu">nchar</span>(full_text)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    state_name <span class="ot">&lt;-</span> <span class="fu">substr</span>(full_text, start_pos, state_matches[i, <span class="st">"end"</span>])</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    state_content <span class="ot">&lt;-</span> <span class="fu">substr</span>(full_text, start_pos, end_pos)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    state_names <span class="ot">&lt;-</span> <span class="fu">c</span>(state_names, state_name)</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    state_sections <span class="ot">&lt;-</span> <span class="fu">c</span>(state_sections, state_content)</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to extract information from each state section</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>parse_state_section <span class="ot">&lt;-</span> <span class="cf">function</span>(section, state_name) {</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(state_name)) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract legal framework</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>  legal_framework <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(section, <span class="st">"Legal Framework:[^</span><span class="sc">\n</span><span class="st">]+"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    {<span class="fu">ifelse</span>(<span class="fu">is.na</span>(.), <span class="cn">NA</span>, <span class="fu">str_remove</span>(., <span class="st">"Legal Framework:"</span>) <span class="sc">%&gt;%</span> <span class="fu">str_trim</span>())}</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract collection triggers</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>  collection_triggers <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(section, <span class="st">"Collection Triggers:[^</span><span class="sc">\n</span><span class="st">]+"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    {<span class="fu">ifelse</span>(<span class="fu">is.na</span>(.), <span class="cn">NA</span>, <span class="fu">str_remove</span>(., <span class="st">"Collection Triggers:"</span>) <span class="sc">%&gt;%</span> <span class="fu">str_trim</span>())}</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract data sources - capture everything until Source URLs or Data Limitations</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>  data_sources_text <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(section, <span class="st">"Data Sources:[</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">S]*?(?=Source URLs:|Data Limitations:|$)"</span>)</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>  data_source_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">data_source_type =</span> <span class="cn">NA_character_</span>, <span class="at">data_source_note =</span> <span class="cn">NA_character_</span>)</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(data_sources_text)) {</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    data_sources_text <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(data_sources_text, <span class="st">"Data Sources:"</span>) <span class="sc">%&gt;%</span> <span class="fu">str_trim</span>()</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Split by newlines and clean up</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    data_source_lines <span class="ot">&lt;-</span> <span class="fu">str_split</span>(data_sources_text, <span class="st">"</span><span class="sc">\\</span><span class="st">n"</span>)[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_trim</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">discard</span>(<span class="sc">~</span> .x <span class="sc">==</span> <span class="st">""</span> <span class="sc">|</span> <span class="fu">str_detect</span>(.x, <span class="st">"^Source URLs:|^Data Limitations:"</span>))</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(data_source_lines) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>      data_source_df <span class="ot">&lt;-</span> <span class="fu">map_df</span>(data_source_lines, <span class="cf">function</span>(line) {</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">str_detect</span>(line, <span class="st">":"</span>)) {</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tibble</span>(</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">data_source_type =</span> <span class="fu">str_extract</span>(line, <span class="st">"^[^:]+"</span>) <span class="sc">%&gt;%</span> <span class="fu">str_trim</span>(),</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">data_source_note =</span> <span class="fu">str_remove</span>(line, <span class="st">"^[^:]+:"</span>) <span class="sc">%&gt;%</span> <span class="fu">str_trim</span>()</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tibble</span>(</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>            <span class="at">data_source_type =</span> line,</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>            <span class="at">data_source_note =</span> <span class="cn">NA_character_</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract source URLs</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>  source_urls_text <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(section, <span class="st">"Source URLs:[</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">S]*?(?=Data Limitations:|$)"</span>)</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>  source_urls <span class="ot">&lt;-</span> <span class="fu">character</span>(<span class="dv">0</span>)</span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(source_urls_text)) {</span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>    source_urls_text <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(source_urls_text, <span class="st">"Source URLs:"</span>) <span class="sc">%&gt;%</span> <span class="fu">str_trim</span>()</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>    source_url_lines <span class="ot">&lt;-</span> <span class="fu">str_split</span>(source_urls_text, <span class="st">"</span><span class="sc">\\</span><span class="st">n"</span>)[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_trim</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>      <span class="fu">discard</span>(<span class="sc">~</span> .x <span class="sc">==</span> <span class="st">""</span> <span class="sc">|</span> <span class="fu">str_detect</span>(.x, <span class="st">"^Data Limitations:"</span>))</span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(source_url_lines) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>      source_urls <span class="ot">&lt;-</span> source_url_lines</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract data limitations - capture everything until next state or end</span></span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>  data_limitations_text <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(section, <span class="st">"Data Limitations:[</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">S]*?(?=</span><span class="sc">\\</span><span class="st">b(A|Ala|Alas|Ari|Arka|Cali|Colo|Conn|Del|Flo|Geo|Haw|Ida|Ill|Ind|Iow|Kan|Ken|Lou|Mai|Mar|Mas|Mic|Min|Mis|Mon|Neb|Nev|New|Nor|Ohi|Okl|Ore|Pen|Rho|Sou|Ten|Tex|Uta|Ver|Vir|Was|Wis|Wyo)</span><span class="sc">\\</span><span class="st">b|$)"</span>)</span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>  data_limitations <span class="ot">&lt;-</span> <span class="cn">NA_character_</span></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(data_limitations_text)) {</span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>    data_limitations_text <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(data_limitations_text, <span class="st">"Data Limitations:"</span>) <span class="sc">%&gt;%</span> <span class="fu">str_trim</span>()</span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>    data_limitations_lines <span class="ot">&lt;-</span> <span class="fu">str_split</span>(data_limitations_text, <span class="st">"</span><span class="sc">\\</span><span class="st">n"</span>)[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_trim</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>      <span class="fu">discard</span>(<span class="sc">~</span> .x <span class="sc">==</span> <span class="st">""</span> <span class="sc">|</span> <span class="fu">str_detect</span>(.x, <span class="st">"^</span><span class="sc">\\</span><span class="st">b(A|Ala|Alas|Ari|Arka|Cali|Colo|Conn|Del|Flo|Geo|Haw|Ida|Ill|Ind|Iow|Kan|Ken|Lou|Mai|Mar|Mas|Mic|Min|Mis|Mon|Neb|Nev|New|Nor|Ohi|Okl|Ore|Pen|Rho|Sou|Ten|Tex|Uta|Ver|Vir|Was|Wis|Wyo)</span><span class="sc">\\</span><span class="st">b"</span>))</span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(data_limitations_lines) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>      data_limitations <span class="ot">&lt;-</span> <span class="fu">paste</span>(data_limitations_lines, <span class="at">collapse =</span> <span class="st">"; "</span>)</span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If no data sources were found, create at least one row for the state</span></span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(data_source_df) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>    data_source_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">data_source_type =</span> <span class="cn">NA_character_</span>, <span class="at">data_source_note =</span> <span class="cn">NA_character_</span>)</span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create result dataframe</span></span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>  result_df <span class="ot">&lt;-</span> data_source_df <span class="sc">%&gt;%</span></span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a>      <span class="at">state =</span> state_name,</span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a>      <span class="at">legal_framework =</span> legal_framework,</span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>      <span class="at">collection_triggers =</span> collection_triggers,</span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>      <span class="at">source_url =</span> <span class="fu">ifelse</span>(<span class="fu">length</span>(source_urls) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="fu">paste</span>(source_urls, <span class="at">collapse =</span> <span class="st">"; "</span>), <span class="cn">NA_character_</span>),</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">data_limitations =</span> data_limitations,</span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">.before =</span> <span class="fu">everything</span>()</span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result_df)</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse all state sections</span></span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>state_data_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(state_sections), <span class="cf">function</span>(i) {</span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse_state_section</span>(state_sections[[i]], state_names[i])</span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all results into one dataframe</span></span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>state_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(state_data_list)</span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up the data - remove rows where all data columns are NA</span></span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>final_df <span class="ot">&lt;-</span> state_data <span class="sc">%&gt;%</span></span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), <span class="sc">~</span> <span class="fu">ifelse</span>(.x <span class="sc">==</span> <span class="st">""</span> <span class="sc">|</span> <span class="fu">is.na</span>(.x), <span class="cn">NA</span>, .x))) <span class="sc">%&gt;%</span></span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">is.na</span>(data_source_type) <span class="sc">&amp;</span> <span class="fu">is.na</span>(source_url) <span class="sc">&amp;</span> <span class="fu">is.na</span>(data_limitations)))</span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill in the missing legal_framework and other methodology for each state</span></span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>final_df_clean <span class="ot">&lt;-</span> final_df <span class="sc">%&gt;%</span></span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">%&gt;%</span></span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(legal_framework, collection_triggers, <span class="at">.direction =</span> <span class="st">"downup"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let's fill source_url and data_limitations across all rows for each state</span></span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>final_df_clean <span class="ot">&lt;-</span> final_df_clean <span class="sc">%&gt;%</span></span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">%&gt;%</span></span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_url =</span> <span class="fu">ifelse</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(source_url)), <span class="cn">NA</span>, </span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste</span>(<span class="fu">na.omit</span>(<span class="fu">unique</span>(source_url)), <span class="at">collapse =</span> <span class="st">"; "</span>)),</span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_limitations =</span> <span class="fu">ifelse</span>(<span class="fu">all</span>(<span class="fu">is.na</span>(data_limitations)), <span class="cn">NA</span>,</span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">paste</span>(<span class="fu">na.omit</span>(<span class="fu">unique</span>(data_limitations)), <span class="at">collapse =</span> <span class="st">"; "</span>))</span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a><span class="co"># Create categorization columns for easier analysis</span></span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a>final_df_clean <span class="ot">&lt;-</span> final_df_clean <span class="sc">%&gt;%</span></span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Categorize collection triggers</span></span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">collection_trigger_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(collection_triggers, <span class="st">"(?i)all felony.*convictions.*arrests.*all felonies"</span>) <span class="sc">~</span> <span class="st">"Comprehensive: All felonies + broad arrests"</span>,</span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(collection_triggers, <span class="st">"(?i)all felony.*convictions.*arrests.*certain|specific"</span>) <span class="sc">~</span> <span class="st">"Selective: All felonies + specific arrests"</span>,</span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(collection_triggers, <span class="st">"(?i)all felony.*convictions.*arrests"</span>) <span class="sc">~</span> <span class="st">"Broad: All felonies + various arrests"</span>,</span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(collection_triggers, <span class="st">"(?i)all felony.*convictions"</span>) <span class="sc">~</span> <span class="st">"Felony convictions only"</span>,</span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(collection_triggers, <span class="st">"(?i)felony.*misdemeanor.*convictions"</span>) <span class="sc">~</span> <span class="st">"Mixed: Felony + misdemeanor convictions"</span>,</span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other/Unspecified"</span></span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Categorize data limitations</span></span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_limitation_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(data_limitations) <span class="sc">~</span> <span class="st">"No limitations noted"</span>,</span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(data_limitations, <span class="st">"(?i)no direct.*conviction data"</span>) <span class="sc">~</span> <span class="st">"Missing conviction data"</span>,</span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(data_limitations, <span class="st">"(?i)prison admissions.*proxy"</span>) <span class="sc">~</span> <span class="st">"Prison data as proxy"</span>,</span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(data_limitations, <span class="st">"(?i)hispanic|ethnicity"</span>) <span class="sc">~</span> <span class="st">"Ethnicity categorization issues"</span>,</span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(data_limitations, <span class="st">"(?i)racial.*limited|black.*white.*only"</span>) <span class="sc">~</span> <span class="st">"Limited racial categories"</span>,</span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(data_limitations, <span class="st">"(?i)no.*data.*available|unavailable"</span>) <span class="sc">~</span> <span class="st">"Various data unavailable"</span>,</span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other limitations"</span></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Categorize data source types</span></span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_source_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(data_source_type, <span class="st">"(?i)conviction"</span>) <span class="sc">~</span> <span class="st">"Conviction Data"</span>,</span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(data_source_type, <span class="st">"(?i)arrest"</span>) <span class="sc">~</span> <span class="st">"Arrest Data"</span>,</span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(data_source_type, <span class="st">"(?i)sex|sexual"</span>) <span class="sc">~</span> <span class="st">"Sex Crime Data"</span>,</span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(data_source_type, <span class="st">"(?i)prison|admission|correction"</span>) <span class="sc">~</span> <span class="st">"Prison/Incarceration Data"</span>,</span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other Data Source"</span></span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a summary table for quick overview - ONE ROW PER STATE</span></span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>methodology_summary <span class="ot">&lt;-</span> final_df_clean <span class="sc">%&gt;%</span></span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(state, legal_framework, collection_triggers, collection_trigger_category, </span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a>           data_limitations, data_limitation_category, source_url) <span class="sc">%&gt;%</span></span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(state)</span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a><span class="co"># Create interactive table</span></span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a>datatable_methodology <span class="ot">&lt;-</span> <span class="fu">datatable</span>(</span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a>  methodology_summary,</span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>, <span class="st">'ColReorder'</span>, <span class="st">'Scroller'</span>),</span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'colvis'</span>),</span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollY =</span> <span class="st">"600px"</span>,</span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a>    <span class="at">scroller =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a>    <span class="at">columnDefs =</span> <span class="fu">list</span>(</span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">className =</span> <span class="st">'dt-left'</span>, <span class="at">targets =</span> <span class="dv">0</span><span class="sc">:</span>(<span class="fu">ncol</span>(methodology_summary)<span class="sc">-</span><span class="dv">1</span>)),</span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">width =</span> <span class="st">'200px'</span>, <span class="at">targets =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span></span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">'top'</span>,</span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a>  <span class="at">class =</span> <span class="st">'cell-border stripe hover'</span></span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(</span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">names</span>(methodology_summary),</span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontSize =</span> <span class="st">'12px'</span>,</span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a>    <span class="at">lineHeight =</span> <span class="st">'90%'</span></span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the table</span></span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true" tabindex="-1"></a>datatable_methodology</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-c475504aa61bead59f2f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c475504aa61bead59f2f">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["\n\nAlaska","\n\nArizona","\n\nArkansas","\n\nCalifornia","\n\nColorado","\n\nConnecticut","\n\nDelaware","\n\nFlorida","\n\nHawaii","\n\nIdaho","\n\nIllinois","\n\nIndiana","\n\nIowa","\n\nKansas","\n\nKentucky","\n\nLouisiana","\n\nMaine","\n\nMassachusetts","\n\nMichigan","\n\nMinnesota","\n\nMissouri","\nGeorgia","\nMaryland","\nMississippi","\nMontana","\nNebraska","\nNevada","\nNew Hampshire","\nNew Jersey","\nNew Mexico","\nNew York","\nNorth Carolina","\nNorth Dakota","\nOhio","\nOklahoma","\nOregon","\nPennsylvania","\nRhode Island","\nSouth Carolina","\nSouth Dakota","\nTennessee","\nTexas","\nUtah","\nVermont","\nVirginia","\nWashington","\nWest Virginia","\nWisconsin","\nWyoming","Alabama"],["AK Stat § 44.41.035 (2014)","AZ Rev Stat §13-610 (2016)","AR Code §12-12-1109 &amp; §12-12-1006","CA Penal Code §296","CO Rev Stat §16-23-103 (2016)","CT Gen Stat §54-102g (2012)","29 DE Code §4713 (2017)","FL Stat §943.325 (2016)","HI Rev Stat §844D-31, 39 (2011)","ID Code §19-5506 (2016)","730 ILCS §5/5-4-3 (2013)","IN Code §10-13-6-10 (2017)","IA Code §81.2 (2016)","KS Stat §21-2511 (2013)","KY Rev Stat §17.170 (1996)","LA Rev Stat § 15:609 (2011)","25 ME Rev Stat § 1574 (2017)","MA Code Chapter 22E §3 (2006)","Mich. Comp. Laws §750.250m (2006)","MN Stat § 299C.105 (2016)","MO Rev. Stat § 650.055 (2011)","GA Code §35-3-160 (2014)","MD Public Safety Code Ann. §2-504 (2009)","MS Code § 47-5-183 (2013)","MT Code § 44-6-103 (2017)","NE Code § 29-4106 (2017)","NV Rev Stat § 176.09123 (2013)","NH Rev Stat § 651-C:2 (2015)","NJ Rev Stat § 53:1-20.20 (2016)","NM Stat § 29-16-6 (1996) for convictions; § 29-3-10 (2016) for arrests.","NY Exec L § 995-C (2014)","NC Gen Stat § 15A-266.4 (2013)","ND Century Code § 31-13-03 (2013)","Ohio Rev Code § 2901.07 (2015)","74 OK Stat § 74-150.27a (2015)","OR Rev Stat § 137.076 (2011)","44 PA Cons Stat § 2316 (2017)","RI Gen L § 12-1.5-8 (2014)","SC Code § 23-3-620 (2012)","SD Codified L § 23-5A-6 (2013) for convictions; § 23-5A-5.2 (2013) for arrests.","TN Code § 40-35-321 (2010)","TX Gov’t Code § 411.1471","UT Code § 53-10-404 (2006)","20 V.S.A. § 1932 (2017)","VA Code § 19.2-310.2 (2006)","WA Rev Code § 43.43.754 (2005)","WV Code § 15-2B-6 (2012)","WI Code § 973.047 (2011)","WY Stat § 7-19-403 (1997)","AL Code § 36-18-25 (2013)"],["All felony and sex crime misdemeanor convictions; arrests for all felonies and crimes against a person","All felony and sex crime misdemeanor convictions; arrests for certain dangerous/serious offenses and misdemeanors","All felony and sex crime misdemeanor convictions; arrests for capital murder, first degree murder, kidnapping, rape, and sexual assault","All felony and sex crime misdemeanor convictions; any felony arrest","All felony and sex crime misdemeanor convictions; any felony arrest","All felony and sex crime misdemeanor convictions; arrests for serious felonies with prior convictions","All felony and sex crime misdemeanor convictions","All felony and sex crime misdemeanor convictions; stalking, voyeurism, obscene materials, gang-related offenses; felony arrests","Felony and sex crime misdemeanor convictions","All felony convictions","All felony and sex crime misdemeanor convictions; specific violent crime arrests (with automatic expungement if not convicted)","All felony convictions","All felony, sex crime misdemeanor, and aggravated misdemeanor convictions","All felony and sex crime misdemeanor convictions; felony and misdemeanor arrests","All felony and sex crime misdemeanor convictions","All felony and sex crime misdemeanor convictions; specific misdemeanors; related arrests","All felony and sex crime misdemeanor convictions","All felony convictions","All felony and sex crime misdemeanor convictions; violent felony arrests","All felony and sex crime misdemeanor convictions; specific felony/misdemeanor arrests","Felony convictions for offenses against the person, burglary, and sexual offenses; sex crime misdemeanor convictions; arrests for similar offenses.","All felony convictions","All felony and sex crime misdemeanor convictions; 4th degree burglary; vehicle breaking/entering; related arrests","All felony convictions","All felony convictions.","All felony and certain misdemeanor convictions.","All felony and certain misdemeanor convictions; all felony arrests.","All felony and sex crime misdemeanor convictions.","All felony and certain misdemeanor convictions; arrests for enumerated offenses (e.g., murder, manslaughter, sexual offenses).","All felony and sex crime misdemeanor convictions; all felony arrests.","All felony and misdemeanor convictions.","All felony and sex crime misdemeanor convictions.","All felony and sex crime misdemeanor convictions; all felony arrests.","All felony and sex crime misdemeanor convictions; all felony arrests.","All felony and sex crime misdemeanor convictions; other specified misdemeanors; arrests of undocumented aliens.","All felony and sex crime misdemeanor convictions.","All felony and sex crime misdemeanor convictions.","All felony and sex crime misdemeanor convictions.","All felony and sex crime misdemeanor convictions; certain arrests (expunged automatically).","All felony and sex crime misdemeanor convictions; arrests for felonies, crimes of violence, and sex offenses.","All felony and sex crime misdemeanor convictions; all felony arrests.","All felony and sex crime misdemeanor convictions; arrests if arrestee had a prior conviction (expunged automatically).","All felony, sex crime misdemeanor, and class A misdemeanor convictions; most felony arrests.","All felony and sex crime misdemeanor convictions; felony arrests (expunged automatically).","All felony and sex crime misdemeanor convictions; felony arrests (expunged automatically).","All felony and sex crime misdemeanor convictions.","All felony and sex crime misdemeanor convictions.","All felony and crimes of sexual contact convictions; arrests (expunged automatically).","All felony convictions.","All felony and sex crime misdemeanor convictions; arrests for all felonies and sexual offenses"],["Comprehensive: All felonies + broad arrests","Selective: All felonies + specific arrests","Broad: All felonies + various arrests","Felony convictions only","Felony convictions only","Broad: All felonies + various arrests","Felony convictions only","Broad: All felonies + various arrests","Mixed: Felony + misdemeanor convictions","Felony convictions only","Selective: All felonies + specific arrests","Felony convictions only","Felony convictions only","Broad: All felonies + various arrests","Felony convictions only","Selective: All felonies + specific arrests","Felony convictions only","Felony convictions only","Broad: All felonies + various arrests","Selective: All felonies + specific arrests","Mixed: Felony + misdemeanor convictions","Felony convictions only","Broad: All felonies + various arrests","Felony convictions only","Felony convictions only","Felony convictions only","Broad: All felonies + various arrests","Felony convictions only","Broad: All felonies + various arrests","Broad: All felonies + various arrests","Felony convictions only","Felony convictions only","Broad: All felonies + various arrests","Broad: All felonies + various arrests","Broad: All felonies + various arrests","Felony convictions only","Felony convictions only","Felony convictions only","Broad: All felonies + various arrests","Broad: All felonies + various arrests","Broad: All felonies + various arrests","Broad: All felonies + various arrests","Broad: All felonies + various arrests","Broad: All felonies + various arrests","Broad: All felonies + various arrests","Felony convictions only","Felony convictions only","Broad: All felonies + various arrests","Felony convictions only","Comprehensive: All felonies + broad arrests"],["No specific conviction data; Racial makeup estimated from current prison population; Sex crime convictions not specified","Prison admissions used as proxy for convictions; Hispanic/Latino counting uncertain due to separate ethnicity categorization","No specific sexual misdemeanor conviction data; Hispanic not included in racial categories","No sex crime misdemeanor conviction data; Asian population data missing despite large state presence; 6% of arrestees categorized as \"Other\"","No sex crime misdemeanor conviction data; Prison admissions used as proxy","No data on arrests for prior convicts; Prison admissions proxy used","Prison admissions proxy used; No specific sex crime misdemeanor data","Enumerated misdemeanor data unavailable; Hispanic not separate category in arrests","13.9% remain in \"Others\" category; Sex crime misdemeanor data unavailable","No actual felony conviction data","Prison admissions proxy used","Prison admissions proxy used","None noted (comprehensive data available)","Shawnee County used as proxy for state racial makeup; Only Black/White categories available","Racial makeup estimated from prison population","No arrest racial data available","Incomplete year data; No racial makeup in conviction data","3% categorized as \"others\"","White/non-white division required estimation; Hispanic not included in arrest data","Hispanic classified as ethnicity, not race","No direct felony conviction data available.; Prison admission data is not broken down by specific offense.; Arrest data does not include Hispanic ethnicity as a separate category.","No actual conviction data available","Only Black/White categories with 126 \"others\"","Only White/Black/Hispanic categories","No direct felony conviction data available.","No direct felony or misdemeanor conviction data available.","No direct felony or misdemeanor conviction data available.; Arrest data for all felonies with racial makeup was unavailable.","No direct felony or sex crime misdemeanor conviction data available.","No direct felony or misdemeanor conviction data available.; For arrest data, Hispanic is not listed as a race (likely included in White/Black categories).","No direct felony or sex crime misdemeanor conviction data available.; Racial makeup of new prison admissions was unavailable.; Total arrest data was available, but racial makeup of that data was not.","N/","No direct felony or sex crime misdemeanor conviction data available.; Data only categorizes race as White, Black, or Other.","No direct felony or sex crime misdemeanor conviction data available.; Racial makeup of the specific prison admission data was unavailable.","No direct felony or sex crime misdemeanor conviction data available.; Arrest data was pieced together from multiple non-matching years.; Racial makeup for arrests only included White and Black categories.","No direct felony or misdemeanor conviction data available.; Arrest data for undocumented aliens was unavailable.","No direct felony or sex crime misdemeanor conviction data available.; Racial makeup of the specific admission data was unavailable.","No direct felony or sex crime misdemeanor conviction data available.; Racial categories in admissions data limited to Black, White, and Other.","No direct felony or sex crime misdemeanor conviction data available.","No direct felony or sex crime misdemeanor conviction data available.; Admissions data only categorizes race as Black or White.","No direct sex crime misdemeanor conviction data available.; Hispanics are considered an ethnicity, not a race, and are not included in the racial makeup.","No direct felony or sex crime misdemeanor conviction data available.; Arrest data did not include Hispanic as a race category.","No direct felony or sex crime misdemeanor conviction data available.","No direct felony or misdemeanor conviction data available.; Racial makeup for felony arrests had to be estimated from non-felony arrest data.; Hispanic is not a race category for arrests; individuals are likely mixed into other categories.","No direct felony or sex crime misdemeanor conviction data available.; Data does not include Hispanic as a race.","No direct felony or sex crime misdemeanor conviction data available.","No direct felony or sex crime misdemeanor conviction data available.; Racial makeup for the specific prison admissions was unavailable.","No direct felony or sex crime misdemeanor conviction data available.; Racial makeup for the specific prison admissions was unavailable.","No direct felony or crimes of sexual contact conviction data available.","No direct felony conviction data available.; Racial makeup of the cleared offenses data was unavailable.","No direct felony conviction data available; No sexual misdemeanor data; Racial categories limited to Black and White only; Other racial groups data unavailable"],["Other limitations","Prison data as proxy","Ethnicity categorization issues","Other limitations","Prison data as proxy","Prison data as proxy","Prison data as proxy","Ethnicity categorization issues","Various data unavailable","Other limitations","Prison data as proxy","Prison data as proxy","Various data unavailable","Other limitations","Other limitations","Various data unavailable","Other limitations","Other limitations","Ethnicity categorization issues","Ethnicity categorization issues","Missing conviction data","Various data unavailable","Other limitations","Ethnicity categorization issues","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Other limitations","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data","Missing conviction data"],["https://www.bjs.gov/content/pub/pdf/p14.pdf; https://www.prisonpolicy.org/profiles/AK.html; https://dps.alaska.gov/getmedia/5f0157ad-3f97-4798-8198-89de9ead6e2c/Supplemental-Crime-in-Alaska-Report; https://dps.alaska.gov/getmedia/fd4b27c3-7660-4527-9d88-fcbaf6438cf0/2015-CIAK-Revised-02-08-2017","https://corrections.az.gov/sites/default/files/REPORTS/Inmate_Population/inmate_population_fact_sheet_as_of_06-30-2015.pdf; https://www.prisonpolicy.org/profiles/AZ.html; https://www.azdps.gov/sites/default/files/media/Crime_In_Arizona_Report_2014.pdf","https://adc.arkansas.gov/images/uploads/Statistical_Information_2015_rev1.pdf; https://www.acic.org/Websites/acic/images/pdfs/2015_RaceSexPersonsArrested_State.pdf",null,"https://drive.google.com/file/d/0B21TrpBx507cczBTWVduZFRXYzQ/view; http://cdpsdocs.state.co.us/ors/docs/reports/2016-SB15-185-Rpt.pdf","https://www.bjs.gov/content/pub/pdf/p14.pdf; https://www.prisonpolicy.org/profiles/CT.html",null,"http://www.dc.state.fl.us/pub/annual/1415/FDC_AR2014-15.pdf; https://www.prisonpolicy.org/profiles/FL.html; http://www.fdle.state.fl.us/FSAC/Data-Statistics/UCR-Arrest-Data.aspx","https://dps.hawaii.gov/wp-content/uploads/2016/12/PSD-ANNUAL-REPORT-2015.pdf; http://www.justicepolicy.org/uploads/justicepolicy/documents/10-09_rep_disparatetreatmentofnativehawaiians_rd-ac.pdf; https://www.prisonpolicy.org/profiles/HI.html","https://www.idoc.idaho.gov/content/document/annual_report_fy14_0; https://www.prisonpolicy.org/profiles/ID.html",null,null,null,"https://www.doc.ks.gov/publications/Reports/2016; https://drive.google.com/file/d/1gTc4F1GYp5pTdSoEsU5UT8Br90vjiD2q/view; http://cjonline.com/news-local/2015-12-21/arrest-rates-race-show-wide-disparities-topeka-nationally","https://justice.ky.gov/Documents/Sourcebook/Sourcebook2012Content.pdf; https://www.prisonpolicy.org/profiles/KY.html","http://www.doc.la.gov/media/1/Briefing%20Book/Jan%202017/recid.admis.rels.jan.17.pdf; https://www.prisonpolicy.org/profiles/LA.html","https://cpb-us-w2.wpmucdn.com/wpsites.maine.edu/dist/2/115/files/2018/06/2014-Maine-Crime-and-Justice-Databook-1anezqt.pdf; https://www.prisonpolicy.org/profiles/ME.html",null,"https://www.michigan.gov/documents/corrections/MDOC_2015_Statistical_Report_-_2016.08.23_532907_7.pdf; https://www.prisonpolicy.org/profiles/MI.html","https://www.doc.state.mn.us/pages/files/6914/3826/9238/Minnesota_Department_of_Corrections_Adult_Inmate_Profile_07-01-2015.pdf; https://dps.mn.gov/divisions/bca/bca-divisions/mnjis/Documents/2015-Minnesota-Uniform-Crime-Report.pdf","http://www.doc.mo.gov/docs/2015-MO-Offender-Profile.pdf (p. 61); https://www.mshp.dps.missouri.gov/MSHPWeb/SAC/data_and_statistics_ucr_query_backup.html (Database query for 2015 statewide arrests)",null,"https://www.dpscs.state.md.us/publicinfo/publications/pdfs/DOC2013AnnualRpt.pdf; https://mdsp.maryland.gov/Document%20Downloads/2014_MD_Crime_UCR.pdf",null,"https://cor.mt.gov/Portals/104/Resources/Reports/2015BiennialReport.pdf (p. A-8, A-16)","https://corrections.nebraska.gov/sites/default/files/files/46/2014_ndcs_annual_report_reduced.pdf (p. 37)","http://doc.nv.gov/uploadedFiles/docnvgov/content/About/Statistics/Annual_Abstracts_by_Fiscal_Year/fy2013.pdf (p. 35, 39)","https://www.nh.gov/nhdoc/divisions/publicinformation/documents/annual-report-2014.pdf (p. 15-16)","https://www.state.nj.us/corrections/pdf/annual_report/2015_Annual_Report.pdf (p. 33); https://www.state.nj.us/corrections/pdf/offender_statistics/2012_Release_Recidivism_Report.pdf (p. 13); https://www.state.nj.us/corrections/pdf/offender_statistics/2012/By%20Ethnicity_Race%202012.pdf (p. 1); https://www.njsp.org/ucr/2014/pdf/2014_uniform_crime_report.pdf (p. 50)","http://nmsc.unm.edu/reports/2016/new-mexico-prison-population-forecast-fy2017-fy2026.pdf (p. 10-11); https://www.prisonpolicy.org/profiles/NM.html","https://www.ncjrs.gov/pdffiles1/nij/grants/247227.pdf (p. 203 for felonies, p. 214 for misdemeanors)","http://randp.doc.state.nc.us/pubdocs/0007073.PDF (p. 12)","https://docr.nd.gov/sites/www/files/documents/statistics/factsheets/2015_FACT_SHEET.pdf (p. 2); https://www.prisonpolicy.org/profiles/ND.html; https://attorneygeneral.nd.gov/sites/ag/files/documents/2015-CrimeReport.pdf (p. 35-36)","http://drc.ohio.gov/Portals/0/Reentry/Reports/Annuals/Annual%20Report%202015.pdf?ver=2016-08-03-152549-077 (p. 37); https://ucr.fbi.gov/crime-in-the-u.s/2010/crime-in-the-u.s.-2010/tables/10tbl69.xls; http://www.dispatch.com/content/stories/local/2013/09/18/drug-arrests-dwarf-those-for-other-crimes.html; http://www.publicsafety.ohio.gov/links/ocjs_statistics.pdf (p. 33)","http://doc.publishpath.com/Default.aspx?shortcut=agency-wide-2014-annual-report#inmatepop","https://www.oregon.gov/doc/RESRCH/docs/admissions_county_20130630.pdf; https://www.prisonpolicy.org/profiles/OR.html","https://www.cor.pa.gov/About%20Us/Statistics/Documents/Reports/2014%20Annual%20Statistical%20Report.pdf","http://www.doc.ri.gov/administration/planning/docs/FY15%20Population%20Report.pdf (p. 10, 12)","http://www.doc.sc.gov/research/SystemOverview/ADM_REL_FromBASEPOP_FY16.pdf","https://atg.sd.gov/docs/CSD2012.pdf (p. 44 for convictions, p. 53 for arrests)","https://www.tn.gov/content/dam/tn/correction/documents/StatisticalAbstract2014.pdf (p. 33); https://www.tn.gov/content/dam/tn/tbi/documents/tibrs/Crime%20In%20Tennessee%202015.pdf (p. 8, 10)","https://www.tdcj.state.tx.us/documents/Statistical_Report_FY2014.pdf (p. 2)","https://justice.utah.gov/Documents/CCJJ/Justice%20Reinvestment%20Initiative/JRI%202016%20Annual%20Report.pdf (p. 8); https://crbiprod.utah.gov/cognos10/cgi-bin/cognos.cgi?b_action=xts.run&amp;m=portal/cc.xts&amp;m_tab=i49FF9376626A452880347AFAEB8B4111 (Live data); https://site.utah.gov/dps-criminal/wp-content/uploads/sites/15/2016/09/2015-Preliminary-Crime-in-Utah-Report9_8_2016.pdf (p. 4, 83)","http://www.doc.state.vt.us/about/reports/ff-archive/facts-figures-fy2014/view (p. 64)","https://vadoc.virginia.gov/About/facts/research/new-statsum/offenderpopulationtrends_fy10-fy14.pdf (p. 3)","https://www.bjs.gov/content/pub/pdf/p14.pdf (p. 10); https://www.prisonpolicy.org/profiles/WA.html","http://www.wvlegislature.gov/legisdocs/reports/agency/C02_FY_2014_2726.pdf (p. 62); https://www.prisonpolicy.org/profiles/WV.html","https://doc.wi.gov/DataResearch/InteractiveDashboards/DAIAdmissions2000to2016.pdf (p. 7)","https://docs.google.com/a/wyo.gov/viewer?a=v&amp;pid=sites&amp;srcid=d3lvLmdvdnxkY2ktLS1wdWJsaWN8Z3g6YzI4ODdkY2RlNzRhOGNj (p. 14); https://www.prisonpolicy.org/profiles/WY.html","http://www.doc.state.al.us/docs/AnnualRpts/2014AnnualReport.pdf; http://alea.gov/documents/documents/CrimeInAlabama-2014.pdf"]],"container":"<table class=\"cell-border stripe hover\">\n  <thead>\n    <tr>\n      <th>state<\/th>\n      <th>legal_framework<\/th>\n      <th>collection_triggers<\/th>\n      <th>collection_trigger_category<\/th>\n      <th>data_limitations<\/th>\n      <th>data_limitation_category<\/th>\n      <th>source_url<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","colvis"],"scrollX":true,"scrollY":"600px","scroller":true,"pageLength":10,"columnDefs":[{"className":"dt-left","targets":[0,1,2,3,4,5,6]},{"width":"200px","targets":[1,2,3]},{"name":"state","targets":0},{"name":"legal_framework","targets":1},{"name":"collection_triggers","targets":2},{"name":"collection_trigger_category","targets":3},{"name":"data_limitations","targets":4},{"name":"data_limitation_category","targets":5},{"name":"source_url","targets":6}],"autoWidth":true,"order":[],"orderClasses":false,"orderCellsTop":true,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[0]; $(this.api().cell(row, 0).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'font-size':'12px','line-height':'90%'});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="combining-information-into-master-dataset" class="level2">
<h2 class="anchored" data-anchor-id="combining-information-into-master-dataset">Combining Information into Master Dataset</h2>
<p>The final dataset combines quantitative DNA collection metrics with qualitative methodology to create a comprehensive one-row-per-state resource. This integration allows researchers to understand both the magnitude of DNA collection and the quality/limitations of the underlying data sources.</p>
<p><strong>Integration Process</strong>:</p>
<ol type="1">
<li><strong>Primary Dataset</strong>: The <code>summary_data</code> table contains all quantitative metrics:
<ul>
<li>DNA collection counts and percentages by race</li>
<li>State population demographics by race</li>
<li>Collection rates per 100,000 population by race</li>
</ul></li>
<li><strong>Study Methodology Addition</strong>: The <code>methodology_summary</code> table provides contextual information:
<ul>
<li>Legal framework for DNA collection</li>
<li>Specific collection triggers</li>
<li>Data source types and limitations</li>
<li>Source URLs for verification</li>
</ul></li>
<li><strong>Joining Strategy</strong>:
<ul>
<li>States are matched using full state names</li>
<li>A crosswalk table converts two-letter abbreviations to full names</li>
<li>Left join ensures all states from the summary data are retained</li>
</ul></li>
<li><strong>Column Selection</strong>: The final dataset includes:
<ul>
<li><strong>State identifier</strong>: Full state name</li>
<li><strong>Collection metrics</strong>: All DNA collection counts, percentages, and rates by race</li>
<li><strong>Methodology context</strong>: Legal framework, collection triggers, data limitations</li>
<li><strong>Quality flags</strong>: Categorized data limitation types for filtering/analysis</li>
</ul></li>
<li><strong>Output Format</strong>: One row per state with 30+ columns covering demographics, collection rates, and methodology</li>
</ol>
<p>This unified structure enables analyses that account for data quality differences across states when interpreting racial disparities in DNA collection.</p>
<div class="cell">
<details class="code-fold">
<summary>Show data combination and exportation code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create state name crosswalk for joining</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>state_crosswalk <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">State =</span> <span class="fu">c</span>(<span class="st">"AL"</span>, <span class="st">"AK"</span>, <span class="st">"AZ"</span>, <span class="st">"AR"</span>, <span class="st">"CA"</span>, <span class="st">"CO"</span>, <span class="st">"CT"</span>, <span class="st">"DE"</span>, <span class="st">"FL"</span>, <span class="st">"GA"</span>, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"HI"</span>, <span class="st">"ID"</span>, <span class="st">"IL"</span>, <span class="st">"IN"</span>, <span class="st">"IA"</span>, <span class="st">"KS"</span>, <span class="st">"KY"</span>, <span class="st">"LA"</span>, <span class="st">"ME"</span>, <span class="st">"MD"</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">"MA"</span>, <span class="st">"MI"</span>, <span class="st">"MN"</span>, <span class="st">"MS"</span>, <span class="st">"MO"</span>, <span class="st">"MT"</span>, <span class="st">"NE"</span>, <span class="st">"NV"</span>, <span class="st">"NH"</span>, <span class="st">"NJ"</span>, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"NM"</span>, <span class="st">"NY"</span>, <span class="st">"NC"</span>, <span class="st">"ND"</span>, <span class="st">"OH"</span>, <span class="st">"OK"</span>, <span class="st">"OR"</span>, <span class="st">"PA"</span>, <span class="st">"RI"</span>, <span class="st">"SC"</span>, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"SD"</span>, <span class="st">"TN"</span>, <span class="st">"TX"</span>, <span class="st">"UT"</span>, <span class="st">"VT"</span>, <span class="st">"VA"</span>, <span class="st">"WA"</span>, <span class="st">"WV"</span>, <span class="st">"WI"</span>, <span class="st">"WY"</span>, <span class="st">"DC"</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">state_full =</span> <span class="fu">c</span>(<span class="st">"Alabama"</span>, <span class="st">"Alaska"</span>, <span class="st">"Arizona"</span>, <span class="st">"Arkansas"</span>, <span class="st">"California"</span>, <span class="st">"Colorado"</span>, </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Connecticut"</span>, <span class="st">"Delaware"</span>, <span class="st">"Florida"</span>, <span class="st">"Georgia"</span>, <span class="st">"Hawaii"</span>, <span class="st">"Idaho"</span>, </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Illinois"</span>, <span class="st">"Indiana"</span>, <span class="st">"Iowa"</span>, <span class="st">"Kansas"</span>, <span class="st">"Kentucky"</span>, <span class="st">"Louisiana"</span>, </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Maine"</span>, <span class="st">"Maryland"</span>, <span class="st">"Massachusetts"</span>, <span class="st">"Michigan"</span>, <span class="st">"Minnesota"</span>, </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Mississippi"</span>, <span class="st">"Missouri"</span>, <span class="st">"Montana"</span>, <span class="st">"Nebraska"</span>, <span class="st">"Nevada"</span>, </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"New Hampshire"</span>, <span class="st">"New Jersey"</span>, <span class="st">"New Mexico"</span>, <span class="st">"New York"</span>, <span class="st">"North Carolina"</span>, </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"North Dakota"</span>, <span class="st">"Ohio"</span>, <span class="st">"Oklahoma"</span>, <span class="st">"Oregon"</span>, <span class="st">"Pennsylvania"</span>, </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Rhode Island"</span>, <span class="st">"South Carolina"</span>, <span class="st">"South Dakota"</span>, <span class="st">"Tennessee"</span>, <span class="st">"Texas"</span>, </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Utah"</span>, <span class="st">"Vermont"</span>, <span class="st">"Virginia"</span>, <span class="st">"Washington"</span>, <span class="st">"West Virginia"</span>, </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Wisconsin"</span>, <span class="st">"Wyoming"</span>, <span class="st">"District of Columbia"</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Join summary data with methodology</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>annual_dna_combined <span class="ot">&lt;-</span> summary_data <span class="sc">%&gt;%</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(state_crosswalk, <span class="at">by =</span> <span class="st">"State"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(methodology_summary, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state_full"</span> <span class="ot">=</span> <span class="st">"state"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># State identifier</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> state_full,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_abbrev =</span> State,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># DNA Collection metrics</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    Black_DNA_Pct, Black_DNA_N,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    Hispanic_DNA_Pct, Hispanic_DNA_N,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    Asian_DNA_Pct, Asian_DNA_N,</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    Native_American_DNA_Pct, Native_American_DNA_N,</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    White_DNA_Pct, White_DNA_N,</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Population demographics</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    Black_Pop_Pct, Hispanic_Pop_Pct, Asian_Pop_Pct,</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    Native_American_Pop_Pct, White_Pop_Pct,</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collection rates</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    Black_Collection_Rate, Hispanic_Collection_Rate,</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    Asian_Collection_Rate, Native_American_Collection_Rate,</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    White_Collection_Rate,</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Methodology</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    legal_framework,</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    collection_triggers,</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    collection_trigger_category,</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    data_limitations,</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    data_limitation_category,</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    source_url</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total DNA profiles</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>annual_dna_combined <span class="ot">&lt;-</span> annual_dna_combined <span class="sc">%&gt;%</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Black_DNA_N, Hispanic_DNA_N, Asian_DNA_N, Native_American_DNA_N, White_DNA_N), <span class="sc">~</span> <span class="fu">replace_na</span>(., <span class="dv">0</span>)),</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">Total_DNA_Profiles =</span> Black_DNA_N <span class="sc">+</span> Hispanic_DNA_N <span class="sc">+</span> Asian_DNA_N <span class="sc">+</span> </span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>                         Native_American_DNA_N <span class="sc">+</span> White_DNA_N</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Total_DNA_Profiles, <span class="at">.after =</span> White_DNA_N)</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Show interactive preview</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>  annual_dna_combined,</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensions =</span> <span class="fu">c</span>(<span class="st">'Buttons'</span>, <span class="st">'ColReorder'</span>, <span class="st">'Scroller'</span>),</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'Bfrtip'</span>,</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">c</span>(<span class="st">'copy'</span>, <span class="st">'csv'</span>, <span class="st">'excel'</span>, <span class="st">'colvis'</span>),</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollY =</span> <span class="st">"400px"</span>,</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">scroller =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">10</span>,</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">columnDefs =</span> <span class="fu">list</span>(</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">className =</span> <span class="st">'dt-left'</span>, <span class="at">targets =</span> <span class="dv">0</span><span class="sc">:</span>(<span class="fu">ncol</span>(annual_dna_combined)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">'top'</span>,</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">class =</span> <span class="st">'cell-border stripe hover'</span>,</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Complete Annual DNA Collection Dataset - One Row Per State"</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatStyle</span>(</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">names</span>(annual_dna_combined),</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontSize =</span> <span class="st">'11px'</span>,</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">lineHeight =</span> <span class="st">'90%'</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-185cbb3fe4673a32c908" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-185cbb3fe4673a32c908">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.9\" data-max=\"79.9\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"40\" data-max=\"280152\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.1\" data-max=\"52\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"213361\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.03\" data-max=\"21.6\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"4939\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.02\" data-max=\"43.1\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"12028\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"12.9\" data-max=\"92.6\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"578\" data-max=\"514348\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"624\" data-max=\"804332\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.6\" data-max=\"37.6\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.5\" data-max=\"48\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.8\" data-max=\"37.3\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.2\" data-max=\"14.8\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"22.9\" data-max=\"93.6\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.2\" data-max=\"19\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.03\" data-max=\"4.6\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.01\" data-max=\"3.4\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.02\" data-max=\"15.6\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.1\" data-max=\"4.5\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"caption":"<caption>Complete Annual DNA Collection Dataset - One Row Per State<\/caption>","data":[["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],[46,7.6,12.6,42.3,25,12.8,25.5,79.90000000000001,34.8,54.5,4.6,3,58.2,24.8,20.8,26.8,29.3,65.8,7.1,62.8,18.5,33.4,25.6,59.6,31.4,1.9,23.1,28.5,6.4,52.8,6,51.8,52.3,9.199999999999999,36.2,26.7,10.2,40.6,25.4,54,7.3,35.9,31.2,5.4,10.7,50.5,18.6,28,37.3,3.9],[18253,914,9313,4401,141488,28486,2250,9399,280152,9851,516,244,18094,3591,4793,13016,34762,10840,226,34835,2712,85888,39743,6328,3701,47,566,1602,40,9444,157,68684,12270,2983,26015,2841,515,4159,3672,3752,2961,14544,22169,5993,295,6249,1376,955,3482,129],[null,2.8,32,2.7,37.6,24,18.1,5.6,0.5,2.4,4.6,16.2,12.6,2.8,3.3,null,5.1,4,2,null,15.6,0.1,null,0.9,1.1,null,11.4,21.3,null,8.4,52,31.6,null,0.3,0.6,7.7,16.3,9.699999999999999,20.3,null,null,0.5,32.8,0.1,null,2.4,14.4,6,null,14.4],[0,23604,23604,275,213361,53778,1591,660,4338,433,516,1300,3906,398,751,0,5993,657,65,0,2288,357,0,91,130,0,279,1201,0,1499,1363,41970,0,92,402,815,824,991,2941,0,0,213,23267,141,0,294,1070,205,0,484],[null,3,0.5,0.04,null,0.03,null,null,0.6,0.4,21.6,null,null,null,0.9,0.1,null,null,null,0.7,null,0.4,2.7,null,0.4,1,0.5,2.4,0.5,1.3,null,3.7,0.05,0.6,0.03,null,null,null,null,null,0.7,0.3,null,2.4,0.9,null,null,null,1.2,null],[0,365,358,4,0,61,0,0,4420,72,2399,0,0,0,199,62,0,0,0,372,0,946,4129,0,50,24,11,135,3,225,0,4939,11,178,25,0,0,0,0,0,287,127,0,2597,25,0,0,0,111,0],[null,43.1,8.199999999999999,null,0.4,0.08,null,null,0.1,0.05,42.1,3,null,null,1.1,0.3,1,null,2,0.1,null,0.5,5.1,null,0.2,17.4,4.6,1.8,0.5,0.1,11,null,0.1,15.1,0.02,10.8,3.1,null,null,null,29.6,0.1,null,5.9,0.4,null,5.2,1,5.1,7.7],[0,5191,6041,0,2177,189,0,0,1074,9,4682,244,0,0,253,142,1199,0,65,77,0,1347,7912,0,20,428,112,101,3,22,288,0,31,4893,17,1147,154,0,0,0,12028,40,0,6466,11,0,382,34,478,258],[54,43.5,46.6,55,37,63.1,56.4,14.5,64,42.1,27.1,77.8,29.3,72.40000000000001,74,72.8,64.7,30.2,88.90000000000001,36.4,65.90000000000001,65.5,66.7,39.5,66.90000000000001,79.7,60.5,46,92.59999999999999,37.5,31,12.9,47.5,74.5,63.2,54.9,70.40000000000001,49.7,54.3,46,62.5,63.2,36,86.2,88,47.1,61.9,65,56.3,74],[21292,5237,34353,5715,210144,140920,4968,1701,514348,4682,3018,6253,9094,10479,17021,35318,76716,4972,2846,20207,9681,168422,103741,4193,7882,1961,1483,2590,578,6708,813,17116,11138,24363,45454,5853,3552,5088,7852,3203,25411,25620,25519,94992,2423,5836,4585,2218,5253,2482],[39545,35311,73669,10395,567170,223434,8809,11760,804332,15047,11131,8041,31094,14468,23017,48538,118670,16469,3202,55491,14681,256960,155525,10612,11783,2460,2451,5629,624,17898,2621,132709,23450,32509,71913,10656,5045,10238,14465,6955,40687,40544,70955,110189,2754,12379,7413,3412,9324,3353],[26.8,3.9,4.8,15.7,6.5,4.5,11.6,22.4,16.8,31.7,2.6,0.8,14.7,9.6,3.5,6.3,8.300000000000001,32.5,1.4,30.5,8.4,14.2,6,37.6,11.8,0.6,5,9.300000000000001,1.5,14.8,2.6,17.6,22.1,2.4,12.7,7.8,2.1,11.7,7.9,27.6,1.8,17.1,12.5,1.3,1.3,19.7,4.1,3.6,6.6,1.4],[4.2,7,30.7,7.2,38.8,21.3,15.4,9,24.5,9.4,10.4,12.2,16.9,6.7,5.7,11.6,3.4,5,1.6,9.5,11.2,4.9,5.2,3.1,4.1,3.6,10.4,28.1,3.4,19.7,48,18.8,9.1,3.5,3.6,10.1,12.7,6.8,14.4,5.5,3.6,5.2,38.8,13.7,1.8,9,12.4,1.5,6.6,9.9],[1.4,6.3,3.4,1.6,14.7,3.2,4.6,3.9,2.8,4,37.3,1.5,5.5,2.1,2.4,2.9,1.4,1.8,1.2,6.5,6.6,3,4.9,1.1,2,0.8,2.3,8.5,2.6,9.699999999999999,1.7,8.800000000000001,2.8,1.4,2.1,2.2,4.4,3.4,3.6,1.6,1.4,1.8,4.7,2.5,1.6,6.5,8.4,0.8,2.8,1],[0.7,14.8,5.3,null,1.7,1.6,0.5,0.7,0.5,0.5,9.9,1.7,0.6,0.4,0.5,1.2,0.3,0.8,0.7,0.6,0.5,0.7,1.3,0.6,0.6,6.6,1.4,1.6,0.2,0.6,10.5,1,1.6,5.5,0.3,9.1,1.8,0.4,1,0.5,8.9,0.4,1,1.5,0.4,0.5,1.9,0.2,1.1,2.7],[66,61.5,55.8,73.09999999999999,38,68.7,68.2,63.2,55.3,53.9,22.9,82.5,61.9,80,86.7,76.40000000000001,85.09999999999999,59.1,93.59999999999999,52,73.5,75.59999999999999,81,57,79.8,86.5,80,50.7,91,56.2,38.4,56,63.8,85.8,79.8,66.5,76.59999999999999,77.40000000000001,73.90000000000001,63.8,82.90000000000001,74.40000000000001,43,79,93.3,62.7,69.8,92.3,81.90000000000001,84],[1.4,3.2,2.8,0.9,5.6,11.4,0.5,4.4,8.1,0.3,1.4,1.8,1,0.6,4.4,7,9.4,0.7,1.2,1.9,0.5,6.1,12,0.6,0.5,0.8,0.6,0.6,0.2,0.7,0.3,2,0.6,16.4,1.8,0.9,0.6,0.3,4.4,0.3,19,1.3,0.6,15,3.6,0.4,0.5,1.5,0.9,1.6],[null,0.7,1.1,0.1,1.4,4.6,0.3,0.8,0.1,0.04,0.4,0.6,0.2,0.1,0.4,null,4,0.3,0.3,null,0.3,0.1,null,0.1,0.1,null,0.1,0.2,null,0.1,0.1,1.1,null,0.4,0.1,0.2,0.2,0.1,1.9,null,null,0.1,0.2,0.03,null,0.04,0.1,0.8,null,0.8],[null,0.8,0.2,0.01,null,0.03,null,null,0.8,0.02,0.5,null,null,null,0.3,0.1,null,null,null,0.1,null,0.3,1.5,null,0.04,0.3,0.03,0.1,0.01,0.03,null,0.3,null,1.7,0.01,null,null,null,null,null,2.4,0.1,null,3.4,0.3,null,null,null,0.1,null],[null,4.7,1.6,null,0.3,null,null,null,1,0.02,3.3,0.9,null,null,1.6,0.4,9,null,0.7,0.2,null,1.9,11,null,0.1,0.6,0.4,0.2,0.1,0.04,0.1,null,0.02,11.7,0.1,0.3,0.2,null,null,null,15.6,0.2,null,14.1,0.4,null,0.3,0.9,0.8,1.6],[0.7,1.2,0.9,0.3,1.4,3.7,0.2,0.3,4.5,0.1,0.9,0.5,0.1,0.2,0.6,0.6,2,0.2,0.2,0.7,0.2,2.2,2.3,0.3,0.2,0.2,0.1,0.2,0.1,0.1,0.1,0.2,0.2,3.8,0.5,0.2,0.1,0.1,1,0.1,3.5,0.5,0.2,3.9,0.4,0.1,0.1,0.1,0.1,0.5],["AL Code § 36-18-25 (2013)",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["All felony and sex crime misdemeanor convictions; arrests for all felonies and sexual offenses",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["Comprehensive: All felonies + broad arrests",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["No direct felony conviction data available; No sexual misdemeanor data; Racial categories limited to Black and White only; Other racial groups data unavailable",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["Missing conviction data",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["http://www.doc.state.al.us/docs/AnnualRpts/2014AnnualReport.pdf; http://alea.gov/documents/documents/CrimeInAlabama-2014.pdf",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"cell-border stripe hover\">\n  <thead>\n    <tr>\n      <th>state<\/th>\n      <th>state_abbrev<\/th>\n      <th>Black_DNA_Pct<\/th>\n      <th>Black_DNA_N<\/th>\n      <th>Hispanic_DNA_Pct<\/th>\n      <th>Hispanic_DNA_N<\/th>\n      <th>Asian_DNA_Pct<\/th>\n      <th>Asian_DNA_N<\/th>\n      <th>Native_American_DNA_Pct<\/th>\n      <th>Native_American_DNA_N<\/th>\n      <th>White_DNA_Pct<\/th>\n      <th>White_DNA_N<\/th>\n      <th>Total_DNA_Profiles<\/th>\n      <th>Black_Pop_Pct<\/th>\n      <th>Hispanic_Pop_Pct<\/th>\n      <th>Asian_Pop_Pct<\/th>\n      <th>Native_American_Pop_Pct<\/th>\n      <th>White_Pop_Pct<\/th>\n      <th>Black_Collection_Rate<\/th>\n      <th>Hispanic_Collection_Rate<\/th>\n      <th>Asian_Collection_Rate<\/th>\n      <th>Native_American_Collection_Rate<\/th>\n      <th>White_Collection_Rate<\/th>\n      <th>legal_framework<\/th>\n      <th>collection_triggers<\/th>\n      <th>collection_trigger_category<\/th>\n      <th>data_limitations<\/th>\n      <th>data_limitation_category<\/th>\n      <th>source_url<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","colvis"],"scrollX":true,"scrollY":"400px","scroller":true,"pageLength":10,"columnDefs":[{"className":"dt-left","targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]},{"name":"state","targets":0},{"name":"state_abbrev","targets":1},{"name":"Black_DNA_Pct","targets":2},{"name":"Black_DNA_N","targets":3},{"name":"Hispanic_DNA_Pct","targets":4},{"name":"Hispanic_DNA_N","targets":5},{"name":"Asian_DNA_Pct","targets":6},{"name":"Asian_DNA_N","targets":7},{"name":"Native_American_DNA_Pct","targets":8},{"name":"Native_American_DNA_N","targets":9},{"name":"White_DNA_Pct","targets":10},{"name":"White_DNA_N","targets":11},{"name":"Total_DNA_Profiles","targets":12},{"name":"Black_Pop_Pct","targets":13},{"name":"Hispanic_Pop_Pct","targets":14},{"name":"Asian_Pop_Pct","targets":15},{"name":"Native_American_Pop_Pct","targets":16},{"name":"White_Pop_Pct","targets":17},{"name":"Black_Collection_Rate","targets":18},{"name":"Hispanic_Collection_Rate","targets":19},{"name":"Asian_Collection_Rate","targets":20},{"name":"Native_American_Collection_Rate","targets":21},{"name":"White_Collection_Rate","targets":22},{"name":"legal_framework","targets":23},{"name":"collection_triggers","targets":24},{"name":"collection_trigger_category","targets":25},{"name":"data_limitations","targets":26},{"name":"data_limitation_category","targets":27},{"name":"source_url","targets":28}],"autoWidth":true,"order":[],"orderClasses":false,"orderCellsTop":true,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[0]; $(this.api().cell(row, 0).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[7]; $(this.api().cell(row, 7).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[8]; $(this.api().cell(row, 8).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[9]; $(this.api().cell(row, 9).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[10]; $(this.api().cell(row, 10).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[11]; $(this.api().cell(row, 11).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[12]; $(this.api().cell(row, 12).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[13]; $(this.api().cell(row, 13).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[14]; $(this.api().cell(row, 14).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[15]; $(this.api().cell(row, 15).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[16]; $(this.api().cell(row, 16).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[17]; $(this.api().cell(row, 17).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[18]; $(this.api().cell(row, 18).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[19]; $(this.api().cell(row, 19).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[20]; $(this.api().cell(row, 20).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[21]; $(this.api().cell(row, 21).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[22]; $(this.api().cell(row, 22).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[23]; $(this.api().cell(row, 23).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[24]; $(this.api().cell(row, 24).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[25]; $(this.api().cell(row, 25).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[26]; $(this.api().cell(row, 26).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[27]; $(this.api().cell(row, 27).node()).css({'font-size':'11px','line-height':'90%'});\nvar value=data[28]; $(this.api().cell(row, 28).node()).css({'font-size':'11px','line-height':'90%'});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="data-export-and-versioning" class="level2">
<h2 class="anchored" data-anchor-id="data-export-and-versioning">Data Export and Versioning</h2>
<div class="cell">
<details class="code-fold">
<summary>Show export code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create output directory structure</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>intermediate_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"annual_dna_collection"</span>, <span class="st">"intermediate"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(intermediate_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>final_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"annual_dna_collection"</span>, <span class="st">"final"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(final_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>frozen_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"v1.0"</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(frozen_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Export final combined dataset</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>output_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(final_dir, <span class="st">"Annual_DNA_Collection.csv"</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(annual_dna_combined, output_path)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"✓ Exported Annual DNA Collection dataset to:"</span>, output_path, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create frozen version (v1.0) for long-term reference</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>frozen_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(frozen_dir, <span class="st">"Annual_DNA_Collection.csv"</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(annual_dna_combined, frozen_path)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"✓ Created frozen version 1.0 at:"</span>, frozen_path, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>))</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Also export the methodology summary separately for reference</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>methodology_output_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(intermediate_dir, <span class="st">"State_Methodology.csv"</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(methodology_summary, methodology_output_path)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"✓ Exported study methodology summary to:"</span>, methodology_output_path, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Exported Annual DNA Collection dataset to: C:/Users/Donadio/Documents/PODFRIDGE_Databases/data/annual_dna_collection/final/Annual_DNA_Collection.csv 
✓ Created frozen version 1.0 at: C:/Users/Donadio/Documents/PODFRIDGE_Databases/data/v1.0/Annual_DNA_Collection.csv 

✓ Exported study methodology summary to: C:/Users/Donadio/Documents/PODFRIDGE_Databases/data/annual_dna_collection/intermediate/State_Methodology.csv </code></pre>
</div>
</div>
</section>
<section id="summary-and-key-findings" class="level2">
<h2 class="anchored" data-anchor-id="summary-and-key-findings">Summary and Key Findings</h2>
<section id="dataset-completeness" class="level3">
<h3 class="anchored" data-anchor-id="dataset-completeness">Dataset Completeness</h3>
<div class="cell">
<details class="code-fold">
<summary>Show completeness analysis</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze data completeness by category</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>completeness_summary <span class="ot">&lt;-</span> annual_dna_combined <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">States_with_Black_Data =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(Black_Collection_Rate)),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">States_with_Hispanic_Data =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(Hispanic_Collection_Rate)),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">States_with_Asian_Data =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(Asian_Collection_Rate)),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">States_with_Native_American_Data =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(Native_American_Collection_Rate)),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">States_with_White_Data =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(White_Collection_Rate)),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">States_with_Legal_Framework =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(legal_framework))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">t</span>(completeness_summary), <span class="at">col.names =</span> <span class="st">"Count"</span>, </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Data Completeness Across States"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Data Completeness Across States</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">States_with_Black_Data</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: left;">States_with_Hispanic_Data</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">States_with_Asian_Data</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="even">
<td style="text-align: left;">States_with_Native_American_Data</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">States_with_White_Data</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: left;">States_with_Legal_Framework</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>