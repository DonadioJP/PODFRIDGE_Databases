<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tina Lasisi | Edit: João P. Donadio">
<meta name="dcterms.date" content="2025-10-04">

<title>FOIA Document OCR Processing – PODFRIDGE-Databases</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-985aa47af68dae11cd4d235c71fb941e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="../site_libs/tabwid-1.1.3/tabwid.js"></script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="../site_libs/datatables-binding-0.34.0/datatables.js"></script>

<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<script src="../site_libs/jszip-1.13.6/jszip.min.js"></script>

<link href="../site_libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">

<script src="../site_libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script>

<script src="../site_libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script>

<script src="../site_libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script>

<script src="../site_libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script>

<link href="../site_libs/dt-ext-colreorder-1.13.6/css/colReorder.dataTables.min.css" rel="stylesheet">

<script src="../site_libs/dt-ext-colreorder-1.13.6/js/dataTables.colReorder.min.js"></script>

<link href="../site_libs/dt-ext-scroller-1.13.6/css/scroller.dataTables.min.css" rel="stylesheet">

<script src="../site_libs/dt-ext-scroller-1.13.6/js/dataTables.scroller.min.js"></script>

<link href="../site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">

<script src="../site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>

<link href="../site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">

<script src="../site_libs/selectize-0.12.0/selectize.min.js"></script>

<link href="../site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">

<script src="../site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>



<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PODFRIDGE-Databases</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-analyses" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Analyses</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-analyses">    
        <li>
    <a class="dropdown-item" href="../analysis/ndis_scraping.html">
 <span class="dropdown-text">NDIS analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../analysis/sdis_summary.html">
 <span class="dropdown-text">SDIS summary</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../analysis/foia_processing.html">
 <span class="dropdown-text">FOIA processing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../analysis/appendix_analysis.html">
 <span class="dropdown-text">Appendix racial analysis</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a></li>
  <li><a href="#materials-and-methods" id="toc-materials-and-methods" class="nav-link" data-scroll-target="#materials-and-methods"><span class="header-section-number">2</span> Materials and Methods</a>
  <ul>
  <li><a href="#data-sources" id="toc-data-sources" class="nav-link" data-scroll-target="#data-sources"><span class="header-section-number">2.1</span> Data Sources</a>
  <ul class="collapse">
  <li><a href="#raw-foia-responses" id="toc-raw-foia-responses" class="nav-link" data-scroll-target="#raw-foia-responses"><span class="header-section-number">2.1.1</span> Raw FOIA Responses</a></li>
  </ul></li>
  <li><a href="#processing-workflow" id="toc-processing-workflow" class="nav-link" data-scroll-target="#processing-workflow"><span class="header-section-number">2.2</span> Processing workflow</a></li>
  <li><a href="#helper-functions" id="toc-helper-functions" class="nav-link" data-scroll-target="#helper-functions"><span class="header-section-number">2.3</span> Helper Functions</a>
  <ul class="collapse">
  <li><a href="#data-processing-helper-functions-reference" id="toc-data-processing-helper-functions-reference" class="nav-link" data-scroll-target="#data-processing-helper-functions-reference"><span class="header-section-number">2.3.1</span> Data Processing Helper Functions Reference</a></li>
  </ul></li>
  <li><a href="#file-structure-and-contents" id="toc-file-structure-and-contents" class="nav-link" data-scroll-target="#file-structure-and-contents"><span class="header-section-number">2.4</span> File Structure and Contents</a>
  <ul class="collapse">
  <li><a href="#state-specific-files-datafoiaintermediatestate_foia_data.csv" id="toc-state-specific-files-datafoiaintermediatestate_foia_data.csv" class="nav-link" data-scroll-target="#state-specific-files-datafoiaintermediatestate_foia_data.csv"><span class="header-section-number">2.4.1</span> State-Specific Files: <code>data/foia/intermediate/[state]_foia_data.csv</code></a></li>
  <li><a href="#raw-data-characteristics" id="toc-raw-data-characteristics" class="nav-link" data-scroll-target="#raw-data-characteristics"><span class="header-section-number">2.4.2</span> Raw Data Characteristics</a></li>
  </ul></li>
  <li><a href="#prepare-combined-dataset" id="toc-prepare-combined-dataset" class="nav-link" data-scroll-target="#prepare-combined-dataset"><span class="header-section-number">2.5</span> Prepare Combined Dataset</a></li>
  <li><a href="#prepare-metadata-documentation-table" id="toc-prepare-metadata-documentation-table" class="nav-link" data-scroll-target="#prepare-metadata-documentation-table"><span class="header-section-number">2.6</span> Prepare Metadata Documentation Table</a></li>
  </ul></li>
  <li><a href="#state-by-state-standardization" id="toc-state-by-state-standardization" class="nav-link" data-scroll-target="#state-by-state-standardization"><span class="header-section-number">3</span> State-by-state Standardization</a>
  <ul>
  <li><a href="#california-ca" id="toc-california-ca" class="nav-link" data-scroll-target="#california-ca"><span class="header-section-number">3.1</span> California (CA)</a>
  <ul class="collapse">
  <li><a href="#examine-raw-data" id="toc-examine-raw-data" class="nav-link" data-scroll-target="#examine-raw-data"><span class="header-section-number">3.1.1</span> Examine Raw Data</a></li>
  <li><a href="#verify-data-consistency" id="toc-verify-data-consistency" class="nav-link" data-scroll-target="#verify-data-consistency"><span class="header-section-number">3.1.2</span> Verify Data Consistency</a></li>
  <li><a href="#address-data-gaps" id="toc-address-data-gaps" class="nav-link" data-scroll-target="#address-data-gaps"><span class="header-section-number">3.1.3</span> Address Data Gaps</a>
  <ul class="collapse">
  <li><a href="#create-unknown-category" id="toc-create-unknown-category" class="nav-link" data-scroll-target="#create-unknown-category"><span class="header-section-number">3.1.3.1</span> Create Unknown Category</a></li>
  <li><a href="#create-combined-totals" id="toc-create-combined-totals" class="nav-link" data-scroll-target="#create-combined-totals"><span class="header-section-number">3.1.3.2</span> Create Combined Totals</a></li>
  <li><a href="#calculate-percentages" id="toc-calculate-percentages" class="nav-link" data-scroll-target="#calculate-percentages"><span class="header-section-number">3.1.3.3</span> Calculate Percentages</a></li>
  <li><a href="#standardize-terminology" id="toc-standardize-terminology" class="nav-link" data-scroll-target="#standardize-terminology"><span class="header-section-number">3.1.3.4</span> Standardize Terminology</a></li>
  </ul></li>
  <li><a href="#prepare-for-combined-dataset" id="toc-prepare-for-combined-dataset" class="nav-link" data-scroll-target="#prepare-for-combined-dataset"><span class="header-section-number">3.1.4</span> Prepare for Combined Dataset</a></li>
  <li><a href="#document-metadata" id="toc-document-metadata" class="nav-link" data-scroll-target="#document-metadata"><span class="header-section-number">3.1.5</span> Document Metadata</a></li>
  <li><a href="#visualizations" id="toc-visualizations" class="nav-link" data-scroll-target="#visualizations"><span class="header-section-number">3.1.6</span> Visualizations</a></li>
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics"><span class="header-section-number">3.1.7</span> Summary Statistics</a></li>
  <li><a href="#summary-of-california-processing" id="toc-summary-of-california-processing" class="nav-link" data-scroll-target="#summary-of-california-processing"><span class="header-section-number">3.1.8</span> Summary of California Processing</a></li>
  </ul></li>
  <li><a href="#florida-fl" id="toc-florida-fl" class="nav-link" data-scroll-target="#florida-fl"><span class="header-section-number">3.2</span> Florida (FL)</a>
  <ul class="collapse">
  <li><a href="#examine-raw-data-1" id="toc-examine-raw-data-1" class="nav-link" data-scroll-target="#examine-raw-data-1"><span class="header-section-number">3.2.1</span> Examine Raw Data</a></li>
  <li><a href="#verify-data-consistency-1" id="toc-verify-data-consistency-1" class="nav-link" data-scroll-target="#verify-data-consistency-1"><span class="header-section-number">3.2.2</span> Verify Data Consistency</a></li>
  <li><a href="#address-data-gaps-1" id="toc-address-data-gaps-1" class="nav-link" data-scroll-target="#address-data-gaps-1"><span class="header-section-number">3.2.3</span> Address Data Gaps</a>
  <ul class="collapse">
  <li><a href="#standardize-terminology-1" id="toc-standardize-terminology-1" class="nav-link" data-scroll-target="#standardize-terminology-1"><span class="header-section-number">3.2.3.1</span> Standardize Terminology</a></li>
  </ul></li>
  <li><a href="#prepare-for-combined-dataset-1" id="toc-prepare-for-combined-dataset-1" class="nav-link" data-scroll-target="#prepare-for-combined-dataset-1"><span class="header-section-number">3.2.4</span> Prepare for Combined Dataset</a></li>
  <li><a href="#document-metadata-1" id="toc-document-metadata-1" class="nav-link" data-scroll-target="#document-metadata-1"><span class="header-section-number">3.2.5</span> Document Metadata</a></li>
  <li><a href="#visualizations-1" id="toc-visualizations-1" class="nav-link" data-scroll-target="#visualizations-1"><span class="header-section-number">3.2.6</span> Visualizations</a></li>
  <li><a href="#summary-statistics-1" id="toc-summary-statistics-1" class="nav-link" data-scroll-target="#summary-statistics-1"><span class="header-section-number">3.2.7</span> Summary Statistics</a></li>
  <li><a href="#summary-of-florida-processing" id="toc-summary-of-florida-processing" class="nav-link" data-scroll-target="#summary-of-florida-processing"><span class="header-section-number">3.2.8</span> Summary of Florida Processing</a></li>
  </ul></li>
  <li><a href="#indiana-in" id="toc-indiana-in" class="nav-link" data-scroll-target="#indiana-in"><span class="header-section-number">3.3</span> Indiana (IN)</a>
  <ul class="collapse">
  <li><a href="#examine-raw-data-2" id="toc-examine-raw-data-2" class="nav-link" data-scroll-target="#examine-raw-data-2"><span class="header-section-number">3.3.1</span> Examine Raw Data</a></li>
  <li><a href="#verify-data-consistency-2" id="toc-verify-data-consistency-2" class="nav-link" data-scroll-target="#verify-data-consistency-2"><span class="header-section-number">3.3.2</span> Verify Data Consistency</a></li>
  <li><a href="#address-data-gaps-2" id="toc-address-data-gaps-2" class="nav-link" data-scroll-target="#address-data-gaps-2"><span class="header-section-number">3.3.3</span> Address Data Gaps</a>
  <ul class="collapse">
  <li><a href="#convert-string-values-to-numeric" id="toc-convert-string-values-to-numeric" class="nav-link" data-scroll-target="#convert-string-values-to-numeric"><span class="header-section-number">3.3.3.1</span> Convert String Values to Numeric</a></li>
  <li><a href="#solve-percentages-inconsistency" id="toc-solve-percentages-inconsistency" class="nav-link" data-scroll-target="#solve-percentages-inconsistency"><span class="header-section-number">3.3.3.2</span> Solve Percentages Inconsistency</a></li>
  <li><a href="#standardize-terminology-2" id="toc-standardize-terminology-2" class="nav-link" data-scroll-target="#standardize-terminology-2"><span class="header-section-number">3.3.3.3</span> Standardize Terminology</a></li>
  <li><a href="#create-combined-total-profiles" id="toc-create-combined-total-profiles" class="nav-link" data-scroll-target="#create-combined-total-profiles"><span class="header-section-number">3.3.3.4</span> Create Combined Total Profiles</a></li>
  <li><a href="#calculate-counts-from-percentages" id="toc-calculate-counts-from-percentages" class="nav-link" data-scroll-target="#calculate-counts-from-percentages"><span class="header-section-number">3.3.3.5</span> Calculate Counts from Percentages</a></li>
  </ul></li>
  <li><a href="#verify-data-consistency-3" id="toc-verify-data-consistency-3" class="nav-link" data-scroll-target="#verify-data-consistency-3"><span class="header-section-number">3.3.4</span> Verify Data Consistency</a></li>
  <li><a href="#prepare-for-combined-dataset-2" id="toc-prepare-for-combined-dataset-2" class="nav-link" data-scroll-target="#prepare-for-combined-dataset-2"><span class="header-section-number">3.3.5</span> Prepare for Combined Dataset</a></li>
  <li><a href="#document-metadata-2" id="toc-document-metadata-2" class="nav-link" data-scroll-target="#document-metadata-2"><span class="header-section-number">3.3.6</span> Document Metadata</a></li>
  <li><a href="#visualizations-2" id="toc-visualizations-2" class="nav-link" data-scroll-target="#visualizations-2"><span class="header-section-number">3.3.7</span> Visualizations</a></li>
  <li><a href="#summary-statistics-2" id="toc-summary-statistics-2" class="nav-link" data-scroll-target="#summary-statistics-2"><span class="header-section-number">3.3.8</span> Summary Statistics</a></li>
  <li><a href="#summary-of-indiana-processing" id="toc-summary-of-indiana-processing" class="nav-link" data-scroll-target="#summary-of-indiana-processing"><span class="header-section-number">3.3.9</span> Summary of Indiana Processing</a></li>
  </ul></li>
  <li><a href="#maine-me" id="toc-maine-me" class="nav-link" data-scroll-target="#maine-me"><span class="header-section-number">3.4</span> Maine (ME)</a>
  <ul class="collapse">
  <li><a href="#examine-raw-data-3" id="toc-examine-raw-data-3" class="nav-link" data-scroll-target="#examine-raw-data-3"><span class="header-section-number">3.4.1</span> Examine Raw Data</a></li>
  <li><a href="#verify-data-consistency-4" id="toc-verify-data-consistency-4" class="nav-link" data-scroll-target="#verify-data-consistency-4"><span class="header-section-number">3.4.2</span> Verify Data Consistency</a></li>
  <li><a href="#address-data-gaps-3" id="toc-address-data-gaps-3" class="nav-link" data-scroll-target="#address-data-gaps-3"><span class="header-section-number">3.4.3</span> Address Data Gaps</a>
  <ul class="collapse">
  <li><a href="#solve-percentages-inconsistency-1" id="toc-solve-percentages-inconsistency-1" class="nav-link" data-scroll-target="#solve-percentages-inconsistency-1"><span class="header-section-number">3.4.3.1</span> Solve Percentages Inconsistency</a></li>
  <li><a href="#recalculate-counts-from-percentages" id="toc-recalculate-counts-from-percentages" class="nav-link" data-scroll-target="#recalculate-counts-from-percentages"><span class="header-section-number">3.4.3.2</span> Recalculate Counts from Percentages</a></li>
  </ul></li>
  <li><a href="#verify-data-consistency-5" id="toc-verify-data-consistency-5" class="nav-link" data-scroll-target="#verify-data-consistency-5"><span class="header-section-number">3.4.4</span> Verify Data Consistency</a></li>
  <li><a href="#prepare-for-combined-dataset-3" id="toc-prepare-for-combined-dataset-3" class="nav-link" data-scroll-target="#prepare-for-combined-dataset-3"><span class="header-section-number">3.4.5</span> Prepare for Combined Dataset</a></li>
  <li><a href="#document-metadata-3" id="toc-document-metadata-3" class="nav-link" data-scroll-target="#document-metadata-3"><span class="header-section-number">3.4.6</span> Document Metadata</a></li>
  <li><a href="#visualizations-3" id="toc-visualizations-3" class="nav-link" data-scroll-target="#visualizations-3"><span class="header-section-number">3.4.7</span> Visualizations</a></li>
  <li><a href="#summary-statistics-3" id="toc-summary-statistics-3" class="nav-link" data-scroll-target="#summary-statistics-3"><span class="header-section-number">3.4.8</span> Summary Statistics</a></li>
  <li><a href="#summary-of-maine-processing" id="toc-summary-of-maine-processing" class="nav-link" data-scroll-target="#summary-of-maine-processing"><span class="header-section-number">3.4.9</span> Summary of Maine Processing</a></li>
  </ul></li>
  <li><a href="#nevada-nv" id="toc-nevada-nv" class="nav-link" data-scroll-target="#nevada-nv"><span class="header-section-number">3.5</span> Nevada (NV)</a>
  <ul class="collapse">
  <li><a href="#examine-raw-data-4" id="toc-examine-raw-data-4" class="nav-link" data-scroll-target="#examine-raw-data-4"><span class="header-section-number">3.5.1</span> Examine Raw Data</a></li>
  <li><a href="#verify-data-consistency-6" id="toc-verify-data-consistency-6" class="nav-link" data-scroll-target="#verify-data-consistency-6"><span class="header-section-number">3.5.2</span> Verify Data Consistency</a></li>
  <li><a href="#address-data-gaps-4" id="toc-address-data-gaps-4" class="nav-link" data-scroll-target="#address-data-gaps-4"><span class="header-section-number">3.5.3</span> Address Data Gaps</a>
  <ul class="collapse">
  <li><a href="#standardize-terminology-3" id="toc-standardize-terminology-3" class="nav-link" data-scroll-target="#standardize-terminology-3"><span class="header-section-number">3.5.3.1</span> Standardize Terminology</a></li>
  <li><a href="#verify-consistency" id="toc-verify-consistency" class="nav-link" data-scroll-target="#verify-consistency"><span class="header-section-number">3.5.3.2</span> Verify Consistency</a></li>
  </ul></li>
  <li><a href="#prepare-for-combined-dataset-4" id="toc-prepare-for-combined-dataset-4" class="nav-link" data-scroll-target="#prepare-for-combined-dataset-4"><span class="header-section-number">3.5.4</span> Prepare for Combined Dataset</a></li>
  <li><a href="#document-metadata-4" id="toc-document-metadata-4" class="nav-link" data-scroll-target="#document-metadata-4"><span class="header-section-number">3.5.5</span> Document Metadata</a></li>
  <li><a href="#visualizations-4" id="toc-visualizations-4" class="nav-link" data-scroll-target="#visualizations-4"><span class="header-section-number">3.5.6</span> Visualizations</a></li>
  <li><a href="#summary-statistics-4" id="toc-summary-statistics-4" class="nav-link" data-scroll-target="#summary-statistics-4"><span class="header-section-number">3.5.7</span> Summary Statistics</a></li>
  <li><a href="#summary-of-nevada-processing" id="toc-summary-of-nevada-processing" class="nav-link" data-scroll-target="#summary-of-nevada-processing"><span class="header-section-number">3.5.8</span> Summary of Nevada Processing</a></li>
  </ul></li>
  <li><a href="#south-dakota-sd" id="toc-south-dakota-sd" class="nav-link" data-scroll-target="#south-dakota-sd"><span class="header-section-number">3.6</span> South Dakota (SD)</a>
  <ul class="collapse">
  <li><a href="#examine-raw-data-5" id="toc-examine-raw-data-5" class="nav-link" data-scroll-target="#examine-raw-data-5"><span class="header-section-number">3.6.1</span> Examine Raw Data</a></li>
  <li><a href="#gender-race-intersection-analysis" id="toc-gender-race-intersection-analysis" class="nav-link" data-scroll-target="#gender-race-intersection-analysis"><span class="header-section-number">3.6.2</span> Gender-race intersection analysis</a></li>
  <li><a href="#verify-data-consistency-7" id="toc-verify-data-consistency-7" class="nav-link" data-scroll-target="#verify-data-consistency-7"><span class="header-section-number">3.6.3</span> Verify Data Consistency</a></li>
  <li><a href="#address-data-gaps-5" id="toc-address-data-gaps-5" class="nav-link" data-scroll-target="#address-data-gaps-5"><span class="header-section-number">3.6.4</span> Address Data Gaps</a>
  <ul class="collapse">
  <li><a href="#standardize-terminology-4" id="toc-standardize-terminology-4" class="nav-link" data-scroll-target="#standardize-terminology-4"><span class="header-section-number">3.6.4.1</span> Standardize Terminology</a></li>
  <li><a href="#recalculate-counts-from-percentages-1" id="toc-recalculate-counts-from-percentages-1" class="nav-link" data-scroll-target="#recalculate-counts-from-percentages-1"><span class="header-section-number">3.6.4.2</span> Recalculate Counts from Percentages</a></li>
  </ul></li>
  <li><a href="#verify-data-consistency-8" id="toc-verify-data-consistency-8" class="nav-link" data-scroll-target="#verify-data-consistency-8"><span class="header-section-number">3.6.5</span> Verify Data Consistency</a></li>
  <li><a href="#prepare-for-combined-dataset-5" id="toc-prepare-for-combined-dataset-5" class="nav-link" data-scroll-target="#prepare-for-combined-dataset-5"><span class="header-section-number">3.6.6</span> Prepare for Combined Dataset</a></li>
  <li><a href="#document-metadata-5" id="toc-document-metadata-5" class="nav-link" data-scroll-target="#document-metadata-5"><span class="header-section-number">3.6.7</span> Document Metadata</a></li>
  <li><a href="#visualizations-5" id="toc-visualizations-5" class="nav-link" data-scroll-target="#visualizations-5"><span class="header-section-number">3.6.8</span> Visualizations</a></li>
  <li><a href="#summary-statistics-5" id="toc-summary-statistics-5" class="nav-link" data-scroll-target="#summary-statistics-5"><span class="header-section-number">3.6.9</span> Summary Statistics</a></li>
  <li><a href="#summary-of-south-dakota-processing" id="toc-summary-of-south-dakota-processing" class="nav-link" data-scroll-target="#summary-of-south-dakota-processing"><span class="header-section-number">3.6.10</span> Summary of South Dakota Processing</a></li>
  </ul></li>
  <li><a href="#texas-tx" id="toc-texas-tx" class="nav-link" data-scroll-target="#texas-tx"><span class="header-section-number">3.7</span> Texas (TX)</a>
  <ul class="collapse">
  <li><a href="#examine-raw-data-6" id="toc-examine-raw-data-6" class="nav-link" data-scroll-target="#examine-raw-data-6"><span class="header-section-number">3.7.1</span> Examine Raw Data</a></li>
  <li><a href="#verify-data-consistency-9" id="toc-verify-data-consistency-9" class="nav-link" data-scroll-target="#verify-data-consistency-9"><span class="header-section-number">3.7.2</span> Verify Data Consistency</a></li>
  <li><a href="#address-data-gaps-6" id="toc-address-data-gaps-6" class="nav-link" data-scroll-target="#address-data-gaps-6"><span class="header-section-number">3.7.3</span> Address Data Gaps</a>
  <ul class="collapse">
  <li><a href="#add-missing-male-category" id="toc-add-missing-male-category" class="nav-link" data-scroll-target="#add-missing-male-category"><span class="header-section-number">3.7.3.1</span> Add Missing Male category</a></li>
  <li><a href="#standardize-terminology-5" id="toc-standardize-terminology-5" class="nav-link" data-scroll-target="#standardize-terminology-5"><span class="header-section-number">3.7.3.2</span> Standardize Terminology</a></li>
  <li><a href="#create-unknown-category-1" id="toc-create-unknown-category-1" class="nav-link" data-scroll-target="#create-unknown-category-1"><span class="header-section-number">3.7.3.3</span> Create Unknown Category</a></li>
  <li><a href="#create-combined-totals-1" id="toc-create-combined-totals-1" class="nav-link" data-scroll-target="#create-combined-totals-1"><span class="header-section-number">3.7.3.4</span> Create Combined Totals</a></li>
  <li><a href="#calculate-percentages-1" id="toc-calculate-percentages-1" class="nav-link" data-scroll-target="#calculate-percentages-1"><span class="header-section-number">3.7.3.5</span> Calculate Percentages</a></li>
  </ul></li>
  <li><a href="#verify-data-consistency-10" id="toc-verify-data-consistency-10" class="nav-link" data-scroll-target="#verify-data-consistency-10"><span class="header-section-number">3.7.4</span> Verify Data Consistency</a></li>
  <li><a href="#prepare-for-combined-dataset-6" id="toc-prepare-for-combined-dataset-6" class="nav-link" data-scroll-target="#prepare-for-combined-dataset-6"><span class="header-section-number">3.7.5</span> Prepare for Combined Dataset</a></li>
  <li><a href="#document-metadata-6" id="toc-document-metadata-6" class="nav-link" data-scroll-target="#document-metadata-6"><span class="header-section-number">3.7.6</span> Document Metadata</a></li>
  <li><a href="#visualizations-6" id="toc-visualizations-6" class="nav-link" data-scroll-target="#visualizations-6"><span class="header-section-number">3.7.7</span> Visualizations</a></li>
  <li><a href="#summary-statistics-6" id="toc-summary-statistics-6" class="nav-link" data-scroll-target="#summary-statistics-6"><span class="header-section-number">3.7.8</span> Summary Statistics</a></li>
  <li><a href="#summary-of-texas-processing" id="toc-summary-of-texas-processing" class="nav-link" data-scroll-target="#summary-of-texas-processing"><span class="header-section-number">3.7.9</span> Summary of Texas Processing</a></li>
  </ul></li>
  <li><a href="#combined-dataset" id="toc-combined-dataset" class="nav-link" data-scroll-target="#combined-dataset"><span class="header-section-number">3.8</span> Combined Dataset</a></li>
  <li><a href="#metadata-table" id="toc-metadata-table" class="nav-link" data-scroll-target="#metadata-table"><span class="header-section-number">3.9</span> Metadata table</a></li>
  </ul></li>
  <li><a href="#saving-processed-data" id="toc-saving-processed-data" class="nav-link" data-scroll-target="#saving-processed-data"><span class="header-section-number">4</span> Saving Processed Data</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions"><span class="header-section-number">5</span> Conclusions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">FOIA Document OCR Processing</h1>
<p class="subtitle lead">Processing Murphy &amp; Tong FOIA Documents about State DNA Database Racial Composition</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tina Lasisi | Edit: João P. Donadio </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 4, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Overview</h1>
<p>This document details the processing of Freedom of Information Act (FOIA) responses from seven U.S. states regarding the demographic composition of their State DNA Index System (SDIS) databases. These responses were obtained by Professor Erin Murphy (NYU Law) in 2018 as part of research on racial disparities in DNA databases.</p>
</section>
<section id="materials-and-methods" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Materials and Methods</h1>
<section id="data-sources" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="data-sources"><span class="header-section-number">2.1</span> Data Sources</h2>
<section id="raw-foia-responses" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="raw-foia-responses"><span class="header-section-number">2.1.1</span> Raw FOIA Responses</h3>
<p>The original FOIA responses are stored in two formats:</p>
<ul>
<li><strong>PDFs</strong>: <code>raw/foia_pdfs/</code> - Original scanned documents</li>
<li><strong>HTML</strong>: <code>raw/foia_html/</code> - OCR’d versions for easier extraction</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List of required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>required_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyverse"</span>,    <span class="co"># Data manipulation and visualization</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"here"</span>,         <span class="co"># File path management</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"knitr"</span>,        <span class="co"># Dynamic report generation</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kableExtra"</span>,   <span class="co"># Enhanced table formatting</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ggplot2"</span>,      <span class="co"># Data visualization</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"patchwork"</span>,    <span class="co"># Plot composition and layout</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"scales"</span>,       <span class="co"># Axis scaling and formatting</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyr"</span>,        <span class="co"># Data tidying and reshaping</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tibble"</span>,       <span class="co"># Modern data frames</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"flextable"</span>,    <span class="co"># Advanced table formatting</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DT"</span>,           <span class="co"># Interactive tables</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cowplot"</span>,      <span class="co"># Plotting composition</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sf"</span>,           <span class="co"># Simple Features for spatial data</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"usmap"</span>        <span class="co"># Mapping US states</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to install missing packages</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>install_missing <span class="ot">&lt;-</span> <span class="cf">function</span>(packages) {</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (pkg <span class="cf">in</span> packages) {</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(pkg, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Installing missing package:"</span>, pkg))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">install.packages</span>(pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Install any missing packages</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">install_missing</span>(required_packages)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Load all packages</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(knitr)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(kableExtra)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(scales)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyr)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tibble)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(flextable)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(cowplot)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(sf)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(usmap)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify all packages loaded successfully</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>loaded_packages <span class="ot">&lt;-</span> <span class="fu">sapply</span>(required_packages, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(loaded_packages)) {</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"All packages loaded successfully!"</span>)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"The following packages failed to load: "</span>, </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>          <span class="fu">paste</span>(<span class="fu">names</span>(loaded_packages)[<span class="sc">!</span>loaded_packages], <span class="at">collapse =</span> <span class="st">", "</span>))</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Display options</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">tibble.width =</span> <span class="cn">Inf</span>)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Path to per-state files (run notebook from analysis/)</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>base_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">".."</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>per_state <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"foia"</span>, <span class="st">"intermediate"</span>)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Discover available per-state CSV files</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>state_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(per_state, <span class="at">pattern =</span> <span class="st">"*_foia_data</span><span class="sc">\\</span><span class="st">.csv$"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(state_files) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"No per-state FOIA files found in"</span>, per_state, <span class="st">". Check the folder path."</span>))</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>stem_to_state <span class="ot">&lt;-</span> <span class="cf">function</span>(stem) {</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  toks <span class="ot">&lt;-</span> <span class="fu">str_split</span>(stem, <span class="st">"_"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"foia"</span> <span class="sc">%in%</span> toks) {</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    toks <span class="ot">&lt;-</span> toks[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">which</span>(toks <span class="sc">==</span> <span class="st">"foia"</span>) <span class="sc">-</span> <span class="dv">1</span>)]</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(tools<span class="sc">::</span><span class="fu">toTitleCase</span>(toks), <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>states_available <span class="ot">&lt;-</span> <span class="fu">map_chr</span>(<span class="fu">basename</span>(state_files), <span class="sc">~</span> <span class="fu">stem_to_state</span>(<span class="fu">str_remove</span>(.x, <span class="st">"_foia_data</span><span class="sc">\\</span><span class="st">.csv"</span>)))</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"✓ Found"</span>, <span class="fu">length</span>(state_files), <span class="st">"per-state files:</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> states_available) {</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"  •"</span>, s, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Initialize empty containers for the loop that follows</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>foia_combined <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>foia_state_metadata <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Found 7 per-state files:
  • California 
  • Florida 
  • Indiana 
  • Maine 
  • Nevada 
  • South Dakota 
  • Texas </code></pre>
</div>
</div>
</section>
</section>
<section id="processing-workflow" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="processing-workflow"><span class="header-section-number">2.2</span> Processing workflow</h2>
<p>For transparency, each state file is processed independently then merged into a single <strong>combined long‑format table (<code>foia_combined</code>)</strong>:</p>
<ol type="1">
<li><p><strong>Load one file per state</strong> from <code>data/foia/intermediate/</code>.</p></li>
<li><p><strong>Append</strong> its rows to <code>foia_combined</code>. A parallel dataframe, <strong><code>foia_state_metadata</code></strong>, records what each state reported (counts, percentages, which categories) and any state-specific characteristics (e.g.&nbsp;Nevada’s “flags” terminology).</p></li>
<li><p><strong>Quality‑check each state</strong>:</p>
<ul>
<li>verify that race and gender percentages sum to ≈ 100 % when provided,</li>
<li>confirm that demographic counts sum to the state’s reported total profiles,</li>
<li><strong>calculate</strong> any missing counts or percentages and tag those rows <code>value_source = "calculated"</code>.</li>
</ul></li>
<li><p><strong>Save outputs</strong></p>
<ul>
<li><code>data/foia/final/foia_data_clean.csv</code> — the fully combined tidy table with both reported and calculated values,</li>
<li><code>data/foia/intermediate/foia_state_metadata.csv</code> — one row per state summarising coverage and caveats. After QC passes, freeze <code>foia_data_clean.csv</code> to <code>data/v1.0/FOIA_demographics.csv</code>.</li>
</ul></li>
</ol>
</section>
<section id="helper-functions" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="helper-functions"><span class="header-section-number">2.3</span> Helper Functions</h2>
<p>The functions below perform each transformation required for harmonizing the state‑level FOIA tables.</p>
<section id="data-processing-helper-functions-reference" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="data-processing-helper-functions-reference"><span class="header-section-number">2.3.1</span> Data Processing Helper Functions Reference</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Definition</th>
<th style="text-align: left;">Parameters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong><code>load_state()</code></strong></td>
<td style="text-align: left;">Loads and preprocesses state FOIA data files, handling numeric conversion and validation</td>
<td style="text-align: left;"><code>path</code>: File path to state CSV</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>enhanced_glimpse()</code></strong></td>
<td style="text-align: left;">Provides an enhanced data overview with column types, missing values, unique counts, and unique values</td>
<td style="text-align: left;"><code>df</code>: Input dataframe</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>fill_demographic_gaps()</code></strong></td>
<td style="text-align: left;">Fills missing gender counts and adds Unknown race category when totals permit calculation</td>
<td style="text-align: left;"><code>df</code>: Input dataframe</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>add_combined()</code></strong></td>
<td style="text-align: left;">Creates Combined offender type by summing Convicted Offender and Arrestee counts when missing</td>
<td style="text-align: left;"><code>df</code>: Input dataframe</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>add_percentages()</code></strong></td>
<td style="text-align: left;">Derives percentage values from counts for all demographic categories</td>
<td style="text-align: left;"><code>df</code>: Input dataframe</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>counts_consistent()</code></strong></td>
<td style="text-align: left;">Verifies that demographic counts sum to total_profiles for each offender type</td>
<td style="text-align: left;"><code>df</code>: Input dataframe</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>percentages_consistent()</code></strong></td>
<td style="text-align: left;">Verifies that percentages sum to 100 ± 0.5% for each category</td>
<td style="text-align: left;"><code>df</code>: Input dataframe</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>report_status()</code></strong></td>
<td style="text-align: left;">Reports what data types (counts/percentages/both) are available for a category</td>
<td style="text-align: left;"><code>df</code>: Input dataframe, <code>category</code>: race or gender</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>verify_category_totals()</code></strong></td>
<td style="text-align: left;">Compares demographic sums against reported totals and shows differences</td>
<td style="text-align: left;"><code>df</code>: Input dataframe</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>verify_percentage_consistency()</code></strong></td>
<td style="text-align: left;">Compares reported vs calculated percentages for consistency</td>
<td style="text-align: left;"><code>df_combined</code>: Combined dataframe, <code>state_name</code>: State name</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>calculate_combined_totals()</code></strong></td>
<td style="text-align: left;">Calculates Combined totals by summing across offender types</td>
<td style="text-align: left;"><code>df</code>: Input dataframe, <code>state_name</code>: State name</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>calculate_percentages()</code></strong></td>
<td style="text-align: left;">Calculates percentages from counts for demographic categories</td>
<td style="text-align: left;"><code>df_combined</code>: Combined dataframe, <code>state_name</code>: State name</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>calculate_counts_from_percentages()</code></strong></td>
<td style="text-align: left;">Calculates counts from percentages for demographic categories</td>
<td style="text-align: left;"><code>df_combined</code>: Combined dataframe, <code>state_name</code>: State name</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>standardize_offender_types()</code></strong></td>
<td style="text-align: left;">Standardizes offender type names to consistent terminology</td>
<td style="text-align: left;"><code>df</code>: Input dataframe</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>prepare_state_for_combined()</code></strong></td>
<td style="text-align: left;">Prepares state data for inclusion in combined dataset with proper columns</td>
<td style="text-align: left;"><code>df</code>: Input dataframe, <code>state_name</code>: State name</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>format_compact()</code></strong></td>
<td style="text-align: left;">Formats large numbers with K/M suffixes for readability</td>
<td style="text-align: left;"><code>x</code>: Numeric value</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>create_pie_chart()</code></strong></td>
<td style="text-align: left;">Creates pie charts for specific demographic categories</td>
<td style="text-align: left;"><code>data</code>: Input data, <code>offender_type</code>, <code>category</code>, <code>value_type</code>, <code>title</code>, <code>show_values</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>create_state_visualizations()</code></strong></td>
<td style="text-align: left;">Creates comprehensive pie chart visualizations for all metrics</td>
<td style="text-align: left;"><code>df_combined</code>: Combined dataframe, <code>state_name</code>: State name</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>create_demographic_bar_charts()</code></strong></td>
<td style="text-align: left;">Creates side-by-side bar charts for gender and race distributions</td>
<td style="text-align: left;"><code>df_combined</code>: Combined dataframe, <code>state_name</code>: State name</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>add_state_metadata()</code></strong></td>
<td style="text-align: left;">Creates and appends a metadata record capturing state data characteristics including available offender types, demographic categories, data formats, and special features</td>
<td style="text-align: left;"><code>df</code>: Input dataframe, <code>state_name</code>: State name</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>update_state_metadata()</code></strong></td>
<td style="text-align: left;">Modifies existing state metadata to update QC results (count/percentage consistency) and append validation notes</td>
<td style="text-align: left;"><code>state_name</code>: State name, <code>counts_ok</code>: Count consistency flag, <code>percentages_ok</code>: Percentage consistency flag, <code>notes_text</code>: Additional notes</td>
</tr>
</tbody>
</table>
<div class="cell">
<details class="code-fold">
<summary>Show helper functions setup</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns retained from every raw table</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>COLS_NEEDED <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"state"</span>, <span class="st">"offender_type"</span>, <span class="st">"variable_category"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"variable_detailed"</span>, <span class="st">"value"</span>, <span class="st">"value_type"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Load and preprocess state files</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>load_state <span class="ot">&lt;-</span> <span class="cf">function</span>(path) {</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="st">  Read a *_foia_data.csv* file, enforce column order,</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="st">  and convert &lt;1 to 0.5 so that trace counts are retained.</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="st">  Execution halts if non-numeric values remain.</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="st">"state"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(df)) {</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">str_remove</span>(<span class="fu">basename</span>(path), <span class="st">"_foia_data</span><span class="sc">\\</span><span class="st">.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_replace_all</span>(<span class="st">"_"</span>, <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        tools<span class="sc">::</span><span class="fu">toTitleCase</span>())</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(COLS_NEEDED))</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>value_source <span class="ot">&lt;-</span> <span class="st">"reported"</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(value <span class="sc">==</span> <span class="st">"&lt;1"</span>, <span class="fl">0.5</span>, value),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">as.numeric</span>(value))</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  nonnumeric <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(value))</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(nonnumeric) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"**Non-numeric rows in"</span>, <span class="fu">basename</span>(path), <span class="st">"; please amend**</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(nonnumeric)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Numeric coercion failure"</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Enhanced glimpse</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Display data types for each column with unique values</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>enhanced_glimpse <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  glimpse_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">Column =</span> <span class="fu">names</span>(df),</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">Type =</span> <span class="fu">sapply</span>(df, <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="fu">class</span>(x), <span class="at">collapse =</span> <span class="st">", "</span>)),</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rows =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">Missing =</span> <span class="fu">sapply</span>(df, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x))),</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">Unique =</span> <span class="fu">sapply</span>(df, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x))),</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">Unique_Values =</span> <span class="fu">sapply</span>(df, <span class="cf">function</span>(x) {</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>      unique_vals <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">length</span>(unique_vals) <span class="sc">&gt;</span> <span class="dv">10</span>) {</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste</span>(<span class="fu">encodeString</span>(<span class="fu">as.character</span>(unique_vals[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])), <span class="at">collapse =</span> <span class="st">", "</span>, <span class="st">"..."</span>)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste</span>(<span class="fu">encodeString</span>(<span class="fu">as.character</span>(unique_vals)), <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>  ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(glimpse_data) <span class="sc">%&gt;%</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_zebra</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_caption</span>(<span class="fu">paste</span>(<span class="st">"Enhanced Data Glimpse:"</span>, <span class="fu">deparse</span>(<span class="fu">substitute</span>(df)))) <span class="sc">%&gt;%</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colformat_num</span>(<span class="at">j =</span> <span class="fu">c</span>(<span class="st">"Rows"</span>, <span class="st">"Missing"</span>, <span class="st">"Unique"</span>), <span class="at">big.mark =</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bg</span>(<span class="at">j =</span> <span class="st">"Missing"</span>, <span class="at">bg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"#FFF3CD"</span>, <span class="st">"transparent"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bg</span>(<span class="at">j =</span> <span class="st">"Unique"</span>, <span class="at">bg =</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"#FFF3CD"</span>, <span class="st">"transparent"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_footer_lines</span>(<span class="fu">paste</span>(<span class="st">"Data frame dimensions:"</span>, <span class="fu">nrow</span>(df), <span class="st">"rows ×"</span>, <span class="fu">ncol</span>(df), <span class="st">"columns"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ft)</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Fill missing Male counts and Unknown race counts</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>fill_demographic_gaps <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>  <span class="st">"If exactly one gender or the Unknown race category is absent and</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="st">  totals permit a residual, calculate and insert the missing count.</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>  inserts <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (ot <span class="cf">in</span> <span class="fu">unique</span>(df<span class="sc">$</span>offender_type)) {</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    tot <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(offender_type <span class="sc">==</span> ot,</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>             variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>             variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>,</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>             value_type <span class="sc">==</span> <span class="st">"count"</span>)</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(tot) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">next</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>    total <span class="ot">&lt;-</span> tot<span class="sc">$</span>value[<span class="dv">1</span>]</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>    <span class="co"># gender residual ----------------------------------------------</span></span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(offender_type <span class="sc">==</span> ot,</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>             variable_category <span class="sc">==</span> <span class="st">"gender"</span>,</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>             value_type <span class="sc">==</span> <span class="st">"count"</span>)</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>    missing_gender <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>), <span class="fu">unique</span>(g<span class="sc">$</span>variable_detailed))</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(g) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(missing_gender) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>      inserts[[<span class="fu">length</span>(inserts) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>        <span class="at">state =</span> df<span class="sc">$</span>state[<span class="dv">1</span>],</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>        <span class="at">offender_type =</span> ot,</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_category =</span> <span class="st">"gender"</span>,</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable_detailed =</span> missing_gender,</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>        <span class="at">value =</span> total <span class="sc">-</span> <span class="fu">sum</span>(g<span class="sc">$</span>value),</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">value_type =</span> <span class="st">"count"</span>,</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">value_source =</span> <span class="st">"calculated"</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># race residual -----------------------------------------------</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(offender_type <span class="sc">==</span> ot,</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>             variable_category <span class="sc">==</span> <span class="st">"race"</span>,</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>             value_type <span class="sc">==</span> <span class="st">"count"</span>)</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(r) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="st">"Unknown"</span> <span class="sc">%in%</span> r<span class="sc">$</span>variable_detailed) {</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>      gap <span class="ot">&lt;-</span> total <span class="sc">-</span> <span class="fu">sum</span>(r<span class="sc">$</span>value)</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (gap <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>        inserts[[<span class="fu">length</span>(inserts) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>          <span class="at">state =</span> df<span class="sc">$</span>state[<span class="dv">1</span>],</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>          <span class="at">offender_type =</span> ot,</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>          <span class="at">variable_category =</span> <span class="st">"race"</span>,</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>          <span class="at">variable_detailed =</span> <span class="st">"Unknown"</span>,</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>          <span class="at">value =</span> gap,</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>          <span class="at">value_type =</span> <span class="st">"count"</span>,</span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>          <span class="at">value_source =</span> <span class="st">"calculated"</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(inserts) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, <span class="fu">bind_rows</span>(inserts))</span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Construct Combined offender type if absent (add_combined)</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>add_combined <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>  <span class="st">"</span></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a><span class="st">  When a state reports Convicted Offender and Arrestee counts but</span></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a><span class="st">  omits Combined, create a Combined block by summing the two.</span></span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"Combined"</span> <span class="sc">%in%</span> df<span class="sc">$</span>offender_type) <span class="fu">return</span>(df)</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>  required <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Convicted Offender"</span>, <span class="st">"Arrestee"</span>)</span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(required <span class="sc">%in%</span> df<span class="sc">$</span>offender_type)) <span class="fu">return</span>(df)  <span class="co"># cannot construct</span></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>  summed <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(value_type <span class="sc">==</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(variable_category, variable_detailed, value_type) <span class="sc">%&gt;%</span></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">value =</span> <span class="fu">sum</span>(value), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">state =</span> df<span class="sc">$</span>state[<span class="dv">1</span>],</span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>           <span class="at">offender_type =</span> <span class="st">"Combined"</span>,</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>           <span class="at">value_source =</span> <span class="st">"calculated"</span>)</span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">bind_rows</span>(df, summed))</span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Derive percentages wherever only counts exist (add_percentages)</span></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>add_percentages <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>  <span class="st">"</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a><span class="st">  Ensure that every gender and race row has both count and percentage</span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a><span class="st">  values, derived from the offender-type total if necessary.</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>  totals <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>           variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>,</span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>           value_type <span class="sc">==</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(offender_type, value) <span class="sc">%&gt;%</span></span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>    <span class="fu">deframe</span>()</span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>  need_pct <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(value_type <span class="sc">==</span> <span class="st">"count"</span>,</span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>           variable_category <span class="sc">!=</span> <span class="st">"total"</span>)</span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>  new_pct_rows <span class="ot">&lt;-</span> need_pct <span class="sc">%&gt;%</span></span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">has_percentage =</span> <span class="fu">nrow</span>(df <span class="sc">%&gt;%</span></span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(state <span class="sc">==</span> state,</span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a>                  offender_type <span class="sc">==</span> offender_type,</span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a>                  variable_category <span class="sc">==</span> variable_category,</span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a>                  variable_detailed <span class="sc">==</span> variable_detailed,</span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a>                  value_type <span class="sc">==</span> <span class="st">"percentage"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(has_percentage <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">round</span>(value <span class="sc">/</span> totals[offender_type] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>           <span class="at">value_type =</span> <span class="st">"percentage"</span>,</span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>           <span class="at">value_source =</span> <span class="st">"calculated"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>has_percentage)</span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(new_pct_rows) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df, new_pct_rows)</span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Counts consistency checks</span></span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a>counts_consistent <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>  <span class="st">"</span></span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a><span class="st">  Verifies that demographic counts sum to total_profiles for each</span></span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a><span class="st">  offender type and category.</span></span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span></span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a>  demo_sum <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(value_type <span class="sc">==</span> <span class="st">"count"</span>,</span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>           variable_category <span class="sc">!=</span> <span class="st">"total"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(offender_type, variable_category) <span class="sc">%&gt;%</span></span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">sum_value =</span> <span class="fu">sum</span>(value), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>  totals <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a>           variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>,</span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>           value_type <span class="sc">==</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(offender_type, value)</span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a>  merged <span class="ot">&lt;-</span> demo_sum <span class="sc">%&gt;%</span></span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(totals, <span class="at">by =</span> <span class="st">"offender_type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">abs</span>(sum_value <span class="sc">-</span> value))</span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">all</span>(merged<span class="sc">$</span>diff <span class="sc">&lt;</span> <span class="fl">1e-6</span>)</span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Percentage consistency checks</span></span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>percentages_consistent <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a>  <span class="st">"</span></span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a><span class="st">  Verifies that derived or reported percentages sum to 100 ± 0.5 %.</span></span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span></span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(value_type <span class="sc">==</span> <span class="st">"percentage"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(offender_type, variable_category) <span class="sc">%&gt;%</span></span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">sum_value =</span> <span class="fu">sum</span>(value), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">consistent =</span> <span class="fu">abs</span>(sum_value <span class="sc">-</span> <span class="dv">100</span>) <span class="sc">&lt;=</span> <span class="fl">0.5</span>)</span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">all</span>(result<span class="sc">$</span>consistent)</span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Report status for each category</span></span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a><span class="co"># Define columns needed for foia_combined</span></span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a>report_status <span class="ot">&lt;-</span> <span class="cf">function</span>(df, category) {</span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>  values <span class="ot">&lt;-</span> <span class="fu">unique</span>(df<span class="sc">$</span>value_type[df<span class="sc">$</span>variable_category <span class="sc">==</span> category])</span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">all</span>(<span class="fu">c</span>(<span class="st">"count"</span>, <span class="st">"percentage"</span>) <span class="sc">%in%</span> values)) {</span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"both"</span>)</span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="st">"count"</span> <span class="sc">%in%</span> values) {</span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"counts"</span>)</span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="st">"percentage"</span> <span class="sc">%in%</span> values) {</span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"percentages"</span>)</span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"neither"</span>)</span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Verify category totals</span></span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>verify_category_totals <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1 pull total_profiles per offender_type</span></span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a>  total_map <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="st">"total"</span>, </span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a>           variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(offender_type, value) <span class="sc">%&gt;%</span></span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a>    <span class="fu">deframe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.list</span>()</span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2 sum counts by offender_type and variable_category</span></span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a>  demo_sum <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(value_type <span class="sc">==</span> <span class="st">"count"</span>,</span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a>           variable_category <span class="sc">!=</span> <span class="st">"total"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(offender_type, variable_category) <span class="sc">%&gt;%</span></span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">sum_counts =</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3 attach total_profiles and compute difference</span></span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a>  demo_sum <span class="ot">&lt;-</span> demo_sum <span class="sc">%&gt;%</span></span>
<span id="cb3-290"><a href="#cb3-290" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">total_profiles =</span> <span class="fu">map_dbl</span>(offender_type, <span class="sc">~</span>total_map[[.x]]),</span>
<span id="cb3-291"><a href="#cb3-291" aria-hidden="true" tabindex="-1"></a>           <span class="at">difference =</span> total_profiles <span class="sc">-</span> sum_counts)</span>
<span id="cb3-292"><a href="#cb3-292" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-293"><a href="#cb3-293" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tidy columns order</span></span>
<span id="cb3-294"><a href="#cb3-294" aria-hidden="true" tabindex="-1"></a>  demo_sum <span class="sc">%&gt;%</span></span>
<span id="cb3-295"><a href="#cb3-295" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(offender_type, variable_category, total_profiles, </span>
<span id="cb3-296"><a href="#cb3-296" aria-hidden="true" tabindex="-1"></a>           sum_counts, difference)</span>
<span id="cb3-297"><a href="#cb3-297" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-298"><a href="#cb3-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-299"><a href="#cb3-299" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-300"><a href="#cb3-300" aria-hidden="true" tabindex="-1"></a><span class="co"># 10. Calculate Combined totals</span></span>
<span id="cb3-301"><a href="#cb3-301" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-302"><a href="#cb3-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-303"><a href="#cb3-303" aria-hidden="true" tabindex="-1"></a>calculate_combined_totals <span class="ot">&lt;-</span> <span class="cf">function</span>(df, state_name) {</span>
<span id="cb3-304"><a href="#cb3-304" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get all counts</span></span>
<span id="cb3-305"><a href="#cb3-305" aria-hidden="true" tabindex="-1"></a>  counts_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-306"><a href="#cb3-306" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(value_type <span class="sc">==</span> <span class="st">'count'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-307"><a href="#cb3-307" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value_source =</span> <span class="st">'calculated'</span>)</span>
<span id="cb3-308"><a href="#cb3-308" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-309"><a href="#cb3-309" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group by variable_category and variable_detailed, sum values</span></span>
<span id="cb3-310"><a href="#cb3-310" aria-hidden="true" tabindex="-1"></a>  combined_sums <span class="ot">&lt;-</span> counts_df <span class="sc">%&gt;%</span></span>
<span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(variable_category, variable_detailed) <span class="sc">%&gt;%</span></span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">value =</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb3-313"><a href="#cb3-313" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-314"><a href="#cb3-314" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create Combined rows</span></span>
<span id="cb3-315"><a href="#cb3-315" aria-hidden="true" tabindex="-1"></a>  combined_rows <span class="ot">&lt;-</span> combined_sums <span class="sc">%&gt;%</span></span>
<span id="cb3-316"><a href="#cb3-316" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">state =</span> state_name,</span>
<span id="cb3-317"><a href="#cb3-317" aria-hidden="true" tabindex="-1"></a>           <span class="at">offender_type =</span> <span class="st">'Combined'</span>,</span>
<span id="cb3-318"><a href="#cb3-318" aria-hidden="true" tabindex="-1"></a>           <span class="at">value_type =</span> <span class="st">'count'</span>,</span>
<span id="cb3-319"><a href="#cb3-319" aria-hidden="true" tabindex="-1"></a>           <span class="at">value_source =</span> <span class="st">'calculated'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-320"><a href="#cb3-320" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">all_of</span>(COLS_NEEDED), value_source)</span>
<span id="cb3-321"><a href="#cb3-321" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-322"><a href="#cb3-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(combined_rows)</span>
<span id="cb3-323"><a href="#cb3-323" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-324"><a href="#cb3-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-325"><a href="#cb3-325" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a><span class="co"># 11. Calculate percentages from counts</span></span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a>calculate_percentages <span class="ot">&lt;-</span> <span class="cf">function</span>(df_combined, state_name) {</span>
<span id="cb3-330"><a href="#cb3-330" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get total profiles for each offender type</span></span>
<span id="cb3-331"><a href="#cb3-331" aria-hidden="true" tabindex="-1"></a>  totals_map <span class="ot">&lt;-</span> df_combined <span class="sc">%&gt;%</span></span>
<span id="cb3-332"><a href="#cb3-332" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(state <span class="sc">==</span> state_name,</span>
<span id="cb3-333"><a href="#cb3-333" aria-hidden="true" tabindex="-1"></a>           variable_category <span class="sc">==</span> <span class="st">'total'</span>,</span>
<span id="cb3-334"><a href="#cb3-334" aria-hidden="true" tabindex="-1"></a>           variable_detailed <span class="sc">==</span> <span class="st">'total_profiles'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-335"><a href="#cb3-335" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(offender_type, value) <span class="sc">%&gt;%</span></span>
<span id="cb3-336"><a href="#cb3-336" aria-hidden="true" tabindex="-1"></a>    <span class="fu">deframe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-337"><a href="#cb3-337" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.list</span>()</span>
<span id="cb3-338"><a href="#cb3-338" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-339"><a href="#cb3-339" aria-hidden="true" tabindex="-1"></a>  percentage_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-340"><a href="#cb3-340" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-341"><a href="#cb3-341" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (offender_type <span class="cf">in</span> <span class="fu">names</span>(totals_map)) {</span>
<span id="cb3-342"><a href="#cb3-342" aria-hidden="true" tabindex="-1"></a>    total <span class="ot">&lt;-</span> totals_map[[offender_type]]</span>
<span id="cb3-343"><a href="#cb3-343" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-344"><a href="#cb3-344" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get all demographic counts</span></span>
<span id="cb3-345"><a href="#cb3-345" aria-hidden="true" tabindex="-1"></a>    demo_data <span class="ot">&lt;-</span> df_combined <span class="sc">%&gt;%</span></span>
<span id="cb3-346"><a href="#cb3-346" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(state <span class="sc">==</span> state_name,</span>
<span id="cb3-347"><a href="#cb3-347" aria-hidden="true" tabindex="-1"></a>             offender_type <span class="sc">==</span> <span class="sc">!!</span>offender_type,</span>
<span id="cb3-348"><a href="#cb3-348" aria-hidden="true" tabindex="-1"></a>             variable_category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'gender'</span>, <span class="st">'race'</span>),</span>
<span id="cb3-349"><a href="#cb3-349" aria-hidden="true" tabindex="-1"></a>             value_type <span class="sc">==</span> <span class="st">'count'</span>)</span>
<span id="cb3-350"><a href="#cb3-350" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-351"><a href="#cb3-351" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(demo_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-352"><a href="#cb3-352" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate percentage for each</span></span>
<span id="cb3-353"><a href="#cb3-353" aria-hidden="true" tabindex="-1"></a>      demo_percentages <span class="ot">&lt;-</span> demo_data <span class="sc">%&gt;%</span></span>
<span id="cb3-354"><a href="#cb3-354" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">round</span>((value <span class="sc">/</span> total) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb3-355"><a href="#cb3-355" aria-hidden="true" tabindex="-1"></a>               <span class="at">value_type =</span> <span class="st">'percentage'</span>,</span>
<span id="cb3-356"><a href="#cb3-356" aria-hidden="true" tabindex="-1"></a>               <span class="at">value_source =</span> <span class="st">'calculated'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-357"><a href="#cb3-357" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">all_of</span>(COLS_NEEDED), value_source)</span>
<span id="cb3-358"><a href="#cb3-358" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-359"><a href="#cb3-359" aria-hidden="true" tabindex="-1"></a>      percentage_rows <span class="ot">&lt;-</span> <span class="fu">c</span>(percentage_rows, <span class="fu">list</span>(demo_percentages))</span>
<span id="cb3-360"><a href="#cb3-360" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-361"><a href="#cb3-361" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-362"><a href="#cb3-362" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-363"><a href="#cb3-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(percentage_rows)</span>
<span id="cb3-364"><a href="#cb3-364" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-365"><a href="#cb3-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-366"><a href="#cb3-366" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-367"><a href="#cb3-367" aria-hidden="true" tabindex="-1"></a><span class="co"># 12. Calculate counts from percentages</span></span>
<span id="cb3-368"><a href="#cb3-368" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-369"><a href="#cb3-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-370"><a href="#cb3-370" aria-hidden="true" tabindex="-1"></a>calculate_counts_from_percentages <span class="ot">&lt;-</span> <span class="cf">function</span>(df_combined, state_name) {</span>
<span id="cb3-371"><a href="#cb3-371" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get total profiles for each offender type</span></span>
<span id="cb3-372"><a href="#cb3-372" aria-hidden="true" tabindex="-1"></a>  totals_map <span class="ot">&lt;-</span> df_combined <span class="sc">%&gt;%</span></span>
<span id="cb3-373"><a href="#cb3-373" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(state <span class="sc">==</span> state_name,</span>
<span id="cb3-374"><a href="#cb3-374" aria-hidden="true" tabindex="-1"></a>           variable_category <span class="sc">==</span> <span class="st">'total'</span>,</span>
<span id="cb3-375"><a href="#cb3-375" aria-hidden="true" tabindex="-1"></a>           variable_detailed <span class="sc">==</span> <span class="st">'total_profiles'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-376"><a href="#cb3-376" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(offender_type, value) <span class="sc">%&gt;%</span></span>
<span id="cb3-377"><a href="#cb3-377" aria-hidden="true" tabindex="-1"></a>    <span class="fu">deframe</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-378"><a href="#cb3-378" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.list</span>()</span>
<span id="cb3-379"><a href="#cb3-379" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-380"><a href="#cb3-380" aria-hidden="true" tabindex="-1"></a>  count_rows <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-381"><a href="#cb3-381" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-382"><a href="#cb3-382" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (offender_type <span class="cf">in</span> <span class="fu">names</span>(totals_map)) {</span>
<span id="cb3-383"><a href="#cb3-383" aria-hidden="true" tabindex="-1"></a>    total <span class="ot">&lt;-</span> totals_map[[offender_type]]</span>
<span id="cb3-384"><a href="#cb3-384" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-385"><a href="#cb3-385" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get all demographic percentages</span></span>
<span id="cb3-386"><a href="#cb3-386" aria-hidden="true" tabindex="-1"></a>    demo_data <span class="ot">&lt;-</span> df_combined <span class="sc">%&gt;%</span></span>
<span id="cb3-387"><a href="#cb3-387" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(state <span class="sc">==</span> state_name,</span>
<span id="cb3-388"><a href="#cb3-388" aria-hidden="true" tabindex="-1"></a>             offender_type <span class="sc">==</span> <span class="sc">!!</span>offender_type,</span>
<span id="cb3-389"><a href="#cb3-389" aria-hidden="true" tabindex="-1"></a>             variable_category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'gender'</span>, <span class="st">'race'</span>),</span>
<span id="cb3-390"><a href="#cb3-390" aria-hidden="true" tabindex="-1"></a>             value_type <span class="sc">==</span> <span class="st">'percentage'</span>)</span>
<span id="cb3-391"><a href="#cb3-391" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-392"><a href="#cb3-392" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(demo_data) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-393"><a href="#cb3-393" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate count for each</span></span>
<span id="cb3-394"><a href="#cb3-394" aria-hidden="true" tabindex="-1"></a>      demo_counts <span class="ot">&lt;-</span> demo_data <span class="sc">%&gt;%</span></span>
<span id="cb3-395"><a href="#cb3-395" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">as.integer</span>(<span class="fu">round</span>(total <span class="sc">*</span> (value <span class="sc">/</span> <span class="dv">100</span>))),</span>
<span id="cb3-396"><a href="#cb3-396" aria-hidden="true" tabindex="-1"></a>               <span class="at">value_type =</span> <span class="st">'count'</span>,</span>
<span id="cb3-397"><a href="#cb3-397" aria-hidden="true" tabindex="-1"></a>               <span class="at">value_source =</span> <span class="st">'calculated'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-398"><a href="#cb3-398" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="fu">all_of</span>(COLS_NEEDED), value_source)</span>
<span id="cb3-399"><a href="#cb3-399" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-400"><a href="#cb3-400" aria-hidden="true" tabindex="-1"></a>      count_rows <span class="ot">&lt;-</span> <span class="fu">c</span>(count_rows, <span class="fu">list</span>(demo_counts))</span>
<span id="cb3-401"><a href="#cb3-401" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-402"><a href="#cb3-402" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-403"><a href="#cb3-403" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-404"><a href="#cb3-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(count_rows)</span>
<span id="cb3-405"><a href="#cb3-405" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-406"><a href="#cb3-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-407"><a href="#cb3-407" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-408"><a href="#cb3-408" aria-hidden="true" tabindex="-1"></a><span class="co"># 13. Standardize offender types</span></span>
<span id="cb3-409"><a href="#cb3-409" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-410"><a href="#cb3-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-411"><a href="#cb3-411" aria-hidden="true" tabindex="-1"></a>standardize_offender_types <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb3-412"><a href="#cb3-412" aria-hidden="true" tabindex="-1"></a>  replacements <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb3-413"><a href="#cb3-413" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Offenders'</span> <span class="ot">=</span> <span class="st">'Convicted Offender'</span>,</span>
<span id="cb3-414"><a href="#cb3-414" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Convicted offenders'</span> <span class="ot">=</span> <span class="st">'Convicted Offender'</span>,</span>
<span id="cb3-415"><a href="#cb3-415" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Arrested offender'</span> <span class="ot">=</span> <span class="st">'Arrestee'</span>,</span>
<span id="cb3-416"><a href="#cb3-416" aria-hidden="true" tabindex="-1"></a>    <span class="st">'All'</span> <span class="ot">=</span> <span class="st">'Combined'</span></span>
<span id="cb3-417"><a href="#cb3-417" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-418"><a href="#cb3-418" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-419"><a href="#cb3-419" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb3-420"><a href="#cb3-420" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">offender_type =</span> <span class="fu">recode</span>(offender_type, <span class="sc">!!!</span>replacements))</span>
<span id="cb3-421"><a href="#cb3-421" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-422"><a href="#cb3-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-423"><a href="#cb3-423" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-424"><a href="#cb3-424" aria-hidden="true" tabindex="-1"></a><span class="co"># 14. Prepare state data for combined dataset</span></span>
<span id="cb3-425"><a href="#cb3-425" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-426"><a href="#cb3-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-427"><a href="#cb3-427" aria-hidden="true" tabindex="-1"></a>prepare_state_for_combined <span class="ot">&lt;-</span> <span class="cf">function</span>(df, state_name) {</span>
<span id="cb3-428"><a href="#cb3-428" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-429"><a href="#cb3-429" aria-hidden="true" tabindex="-1"></a>  df_prepared <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-430"><a href="#cb3-430" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">any_of</span>(COLS_NEEDED), value_source)</span>
<span id="cb3-431"><a href="#cb3-431" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-432"><a href="#cb3-432" aria-hidden="true" tabindex="-1"></a>  df_prepared <span class="ot">&lt;-</span> df_prepared <span class="sc">%&gt;%</span></span>
<span id="cb3-433"><a href="#cb3-433" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">value_source =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-434"><a href="#cb3-434" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>(value_source) <span class="sc">~</span> <span class="st">"calculated"</span>,</span>
<span id="cb3-435"><a href="#cb3-435" aria-hidden="true" tabindex="-1"></a>        value_source <span class="sc">==</span> <span class="st">""</span> <span class="sc">~</span> <span class="st">"calculated"</span>,</span>
<span id="cb3-436"><a href="#cb3-436" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> value_source</span>
<span id="cb3-437"><a href="#cb3-437" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb3-438"><a href="#cb3-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-439"><a href="#cb3-439" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-440"><a href="#cb3-440" aria-hidden="true" tabindex="-1"></a>  df_prepared</span>
<span id="cb3-441"><a href="#cb3-441" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-442"><a href="#cb3-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-443"><a href="#cb3-443" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-444"><a href="#cb3-444" aria-hidden="true" tabindex="-1"></a><span class="co"># 15. Compare reported vs calculated percentages</span></span>
<span id="cb3-445"><a href="#cb3-445" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-446"><a href="#cb3-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-447"><a href="#cb3-447" aria-hidden="true" tabindex="-1"></a>verify_percentage_consistency <span class="ot">&lt;-</span> <span class="cf">function</span>(df_combined, state_name) {</span>
<span id="cb3-448"><a href="#cb3-448" aria-hidden="true" tabindex="-1"></a>  state_data <span class="ot">&lt;-</span> df_combined <span class="sc">%&gt;%</span></span>
<span id="cb3-449"><a href="#cb3-449" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(state <span class="sc">==</span> state_name)</span>
<span id="cb3-450"><a href="#cb3-450" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-451"><a href="#cb3-451" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get all offender types that have both counts and percentages</span></span>
<span id="cb3-452"><a href="#cb3-452" aria-hidden="true" tabindex="-1"></a>  offender_types <span class="ot">&lt;-</span> <span class="fu">unique</span>(state_data<span class="sc">$</span>offender_type)</span>
<span id="cb3-453"><a href="#cb3-453" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-454"><a href="#cb3-454" aria-hidden="true" tabindex="-1"></a>  consistency_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-455"><a href="#cb3-455" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-456"><a href="#cb3-456" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (offender_type <span class="cf">in</span> offender_types) {</span>
<span id="cb3-457"><a href="#cb3-457" aria-hidden="true" tabindex="-1"></a>    offender_data <span class="ot">&lt;-</span> state_data <span class="sc">%&gt;%</span></span>
<span id="cb3-458"><a href="#cb3-458" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(offender_type <span class="sc">==</span> <span class="sc">!!</span>offender_type)</span>
<span id="cb3-459"><a href="#cb3-459" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-460"><a href="#cb3-460" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if we have both reported and calculated percentages</span></span>
<span id="cb3-461"><a href="#cb3-461" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (category <span class="cf">in</span> <span class="fu">c</span>(<span class="st">'gender'</span>, <span class="st">'race'</span>)) {</span>
<span id="cb3-462"><a href="#cb3-462" aria-hidden="true" tabindex="-1"></a>      reported_pcts <span class="ot">&lt;-</span> offender_data <span class="sc">%&gt;%</span></span>
<span id="cb3-463"><a href="#cb3-463" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="sc">!!</span>category,</span>
<span id="cb3-464"><a href="#cb3-464" aria-hidden="true" tabindex="-1"></a>               value_type <span class="sc">==</span> <span class="st">'percentage'</span>,</span>
<span id="cb3-465"><a href="#cb3-465" aria-hidden="true" tabindex="-1"></a>               value_source <span class="sc">==</span> <span class="st">'reported'</span>)</span>
<span id="cb3-466"><a href="#cb3-466" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-467"><a href="#cb3-467" aria-hidden="true" tabindex="-1"></a>      calculated_pcts <span class="ot">&lt;-</span> offender_data <span class="sc">%&gt;%</span></span>
<span id="cb3-468"><a href="#cb3-468" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="sc">!!</span>category,</span>
<span id="cb3-469"><a href="#cb3-469" aria-hidden="true" tabindex="-1"></a>               value_type <span class="sc">==</span> <span class="st">'percentage'</span>,</span>
<span id="cb3-470"><a href="#cb3-470" aria-hidden="true" tabindex="-1"></a>               value_source <span class="sc">==</span> <span class="st">'calculated'</span>)</span>
<span id="cb3-471"><a href="#cb3-471" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-472"><a href="#cb3-472" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(reported_pcts) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(calculated_pcts) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-473"><a href="#cb3-473" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Compare each demographic value</span></span>
<span id="cb3-474"><a href="#cb3-474" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(reported_pcts)) {</span>
<span id="cb3-475"><a href="#cb3-475" aria-hidden="true" tabindex="-1"></a>          rep_row <span class="ot">&lt;-</span> reported_pcts[i, ]</span>
<span id="cb3-476"><a href="#cb3-476" aria-hidden="true" tabindex="-1"></a>          calc_match <span class="ot">&lt;-</span> calculated_pcts <span class="sc">%&gt;%</span></span>
<span id="cb3-477"><a href="#cb3-477" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(variable_detailed <span class="sc">==</span> rep_row<span class="sc">$</span>variable_detailed)</span>
<span id="cb3-478"><a href="#cb3-478" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb3-479"><a href="#cb3-479" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="fu">nrow</span>(calc_match) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-480"><a href="#cb3-480" aria-hidden="true" tabindex="-1"></a>            diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(rep_row<span class="sc">$</span>value <span class="sc">-</span> calc_match<span class="sc">$</span>value[<span class="dv">1</span>])</span>
<span id="cb3-481"><a href="#cb3-481" aria-hidden="true" tabindex="-1"></a>            consistency_results <span class="ot">&lt;-</span> <span class="fu">c</span>(consistency_results, <span class="fu">list</span>(<span class="fu">data.frame</span>(</span>
<span id="cb3-482"><a href="#cb3-482" aria-hidden="true" tabindex="-1"></a>              <span class="at">offender_type =</span> offender_type,</span>
<span id="cb3-483"><a href="#cb3-483" aria-hidden="true" tabindex="-1"></a>              <span class="at">category =</span> category,</span>
<span id="cb3-484"><a href="#cb3-484" aria-hidden="true" tabindex="-1"></a>              <span class="at">variable =</span> rep_row<span class="sc">$</span>variable_detailed,</span>
<span id="cb3-485"><a href="#cb3-485" aria-hidden="true" tabindex="-1"></a>              <span class="at">reported =</span> rep_row<span class="sc">$</span>value,</span>
<span id="cb3-486"><a href="#cb3-486" aria-hidden="true" tabindex="-1"></a>              <span class="at">calculated =</span> calc_match<span class="sc">$</span>value[<span class="dv">1</span>],</span>
<span id="cb3-487"><a href="#cb3-487" aria-hidden="true" tabindex="-1"></a>              <span class="at">difference =</span> diff,</span>
<span id="cb3-488"><a href="#cb3-488" aria-hidden="true" tabindex="-1"></a>              <span class="at">consistent =</span> diff <span class="sc">&lt;</span> <span class="fl">0.5</span></span>
<span id="cb3-489"><a href="#cb3-489" aria-hidden="true" tabindex="-1"></a>            )))</span>
<span id="cb3-490"><a href="#cb3-490" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb3-491"><a href="#cb3-491" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-492"><a href="#cb3-492" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-493"><a href="#cb3-493" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-494"><a href="#cb3-494" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-495"><a href="#cb3-495" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-496"><a href="#cb3-496" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(consistency_results) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-497"><a href="#cb3-497" aria-hidden="true" tabindex="-1"></a>    consistency_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(consistency_results)</span>
<span id="cb3-498"><a href="#cb3-498" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Percentage consistency check for "</span>, state_name, <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb3-499"><a href="#cb3-499" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"All values consistent: "</span>, <span class="fu">all</span>(consistency_df<span class="sc">$</span>consistent), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb3-500"><a href="#cb3-500" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-501"><a href="#cb3-501" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(consistency_df<span class="sc">$</span>consistent)) {</span>
<span id="cb3-502"><a href="#cb3-502" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Inconsistent values:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-503"><a href="#cb3-503" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(consistency_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>consistent))</span>
<span id="cb3-504"><a href="#cb3-504" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-505"><a href="#cb3-505" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-506"><a href="#cb3-506" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">all</span>(consistency_df<span class="sc">$</span>consistent))</span>
<span id="cb3-507"><a href="#cb3-507" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-508"><a href="#cb3-508" aria-hidden="true" tabindex="-1"></a>    <span class="co"># No comparison possible - state only has one type of data</span></span>
<span id="cb3-509"><a href="#cb3-509" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">TRUE</span>)</span>
<span id="cb3-510"><a href="#cb3-510" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-511"><a href="#cb3-511" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-512"><a href="#cb3-512" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-513"><a href="#cb3-513" aria-hidden="true" tabindex="-1"></a><span class="co"># 16. Add compact formatting for large numbers</span></span>
<span id="cb3-514"><a href="#cb3-514" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-515"><a href="#cb3-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-516"><a href="#cb3-516" aria-hidden="true" tabindex="-1"></a>format_compact <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb3-517"><a href="#cb3-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(x, <span class="cf">function</span>(single_x) {</span>
<span id="cb3-518"><a href="#cb3-518" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (single_x <span class="sc">&gt;=</span> <span class="dv">1000000</span>) {</span>
<span id="cb3-519"><a href="#cb3-519" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (single_x<span class="sc">/</span><span class="dv">1000000</span> <span class="sc">==</span> <span class="fu">as.integer</span>(single_x<span class="sc">/</span><span class="dv">1000000</span>)) {</span>
<span id="cb3-520"><a href="#cb3-520" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">paste0</span>(<span class="fu">as.integer</span>(single_x<span class="sc">/</span><span class="dv">1000000</span>), <span class="st">"M"</span>))</span>
<span id="cb3-521"><a href="#cb3-521" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb3-522"><a href="#cb3-522" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">paste0</span>(<span class="fu">round</span>(single_x<span class="sc">/</span><span class="dv">1000000</span>, <span class="dv">1</span>), <span class="st">"M"</span>))</span>
<span id="cb3-523"><a href="#cb3-523" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-524"><a href="#cb3-524" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (single_x <span class="sc">&gt;=</span> <span class="dv">1000</span>) {</span>
<span id="cb3-525"><a href="#cb3-525" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">paste0</span>(<span class="fu">as.integer</span>(single_x<span class="sc">/</span><span class="dv">1000</span>), <span class="st">"k"</span>))</span>
<span id="cb3-526"><a href="#cb3-526" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb3-527"><a href="#cb3-527" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">paste0</span>(<span class="fu">as.integer</span>(single_x)))</span>
<span id="cb3-528"><a href="#cb3-528" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-529"><a href="#cb3-529" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb3-530"><a href="#cb3-530" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-531"><a href="#cb3-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-532"><a href="#cb3-532" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-533"><a href="#cb3-533" aria-hidden="true" tabindex="-1"></a><span class="co"># 17. Pie chart creation function</span></span>
<span id="cb3-534"><a href="#cb3-534" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-535"><a href="#cb3-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-536"><a href="#cb3-536" aria-hidden="true" tabindex="-1"></a>create_pie_chart <span class="ot">&lt;-</span> <span class="cf">function</span>(data, offender_type, category, value_type, title, <span class="at">show_values =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb3-537"><a href="#cb3-537" aria-hidden="true" tabindex="-1"></a>  chart_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb3-538"><a href="#cb3-538" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(offender_type <span class="sc">==</span> <span class="sc">!!</span>offender_type,</span>
<span id="cb3-539"><a href="#cb3-539" aria-hidden="true" tabindex="-1"></a>           variable_category <span class="sc">==</span> <span class="sc">!!</span>category,</span>
<span id="cb3-540"><a href="#cb3-540" aria-hidden="true" tabindex="-1"></a>           value_type <span class="sc">==</span> <span class="sc">!!</span>value_type)</span>
<span id="cb3-541"><a href="#cb3-541" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-542"><a href="#cb3-542" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if we have data after filtering</span></span>
<span id="cb3-543"><a href="#cb3-543" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(chart_data) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb3-544"><a href="#cb3-544" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot.new</span>()</span>
<span id="cb3-545"><a href="#cb3-545" aria-hidden="true" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main =</span> title, <span class="at">cex.main =</span> <span class="fl">0.9</span>)</span>
<span id="cb3-546"><a href="#cb3-546" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">"No data"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb3-547"><a href="#cb3-547" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>()</span>
<span id="cb3-548"><a href="#cb3-548" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-549"><a href="#cb3-549" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-550"><a href="#cb3-550" aria-hidden="true" tabindex="-1"></a>  <span class="co"># AGGREGATE DATA TO REMOVE DUPLICATES - KEY FIX</span></span>
<span id="cb3-551"><a href="#cb3-551" aria-hidden="true" tabindex="-1"></a>  chart_data <span class="ot">&lt;-</span> chart_data <span class="sc">%&gt;%</span></span>
<span id="cb3-552"><a href="#cb3-552" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(variable_detailed) <span class="sc">%&gt;%</span></span>
<span id="cb3-553"><a href="#cb3-553" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">value =</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-554"><a href="#cb3-554" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb3-555"><a href="#cb3-555" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-556"><a href="#cb3-556" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure consistent categories</span></span>
<span id="cb3-557"><a href="#cb3-557" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (category <span class="sc">==</span> <span class="st">'gender'</span>) {</span>
<span id="cb3-558"><a href="#cb3-558" aria-hidden="true" tabindex="-1"></a>    all_genders <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">variable_detailed =</span> <span class="fu">c</span>(<span class="st">'Male'</span>, <span class="st">'Female'</span>, <span class="st">'Unknown'</span>))</span>
<span id="cb3-559"><a href="#cb3-559" aria-hidden="true" tabindex="-1"></a>    chart_data <span class="ot">&lt;-</span> chart_data <span class="sc">%&gt;%</span></span>
<span id="cb3-560"><a href="#cb3-560" aria-hidden="true" tabindex="-1"></a>      <span class="fu">right_join</span>(all_genders, <span class="at">by =</span> <span class="st">"variable_detailed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-561"><a href="#cb3-561" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(value), <span class="dv">0</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb3-562"><a href="#cb3-562" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(<span class="fu">factor</span>(variable_detailed, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'Male'</span>, <span class="st">'Female'</span>, <span class="st">'Unknown'</span>)))</span>
<span id="cb3-563"><a href="#cb3-563" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (category <span class="sc">==</span> <span class="st">'race'</span>) {</span>
<span id="cb3-564"><a href="#cb3-564" aria-hidden="true" tabindex="-1"></a>    all_races <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">variable_detailed =</span> <span class="fu">c</span>(<span class="st">'White'</span>, <span class="st">'Black'</span>, <span class="st">'Hispanic'</span>, </span>
<span id="cb3-565"><a href="#cb3-565" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">'Asian'</span>, <span class="st">'Native American'</span>, <span class="st">'Other'</span>, <span class="st">'Unknown'</span>))</span>
<span id="cb3-566"><a href="#cb3-566" aria-hidden="true" tabindex="-1"></a>    chart_data <span class="ot">&lt;-</span> chart_data <span class="sc">%&gt;%</span></span>
<span id="cb3-567"><a href="#cb3-567" aria-hidden="true" tabindex="-1"></a>      <span class="fu">right_join</span>(all_races, <span class="at">by =</span> <span class="st">"variable_detailed"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-568"><a href="#cb3-568" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(value), <span class="dv">0</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb3-569"><a href="#cb3-569" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(<span class="fu">factor</span>(variable_detailed, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'White'</span>, <span class="st">'Black'</span>, <span class="st">'Hispanic'</span>, </span>
<span id="cb3-570"><a href="#cb3-570" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">'Asian'</span>, <span class="st">'Native American'</span>, <span class="st">'Other'</span>, <span class="st">'Unknown'</span>)))</span>
<span id="cb3-571"><a href="#cb3-571" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-572"><a href="#cb3-572" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-573"><a href="#cb3-573" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out zero values and ensure we have data</span></span>
<span id="cb3-574"><a href="#cb3-574" aria-hidden="true" tabindex="-1"></a>  chart_data <span class="ot">&lt;-</span> chart_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(value <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb3-575"><a href="#cb3-575" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-576"><a href="#cb3-576" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(chart_data) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb3-577"><a href="#cb3-577" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot.new</span>()</span>
<span id="cb3-578"><a href="#cb3-578" aria-hidden="true" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main =</span> title, <span class="at">cex.main =</span> <span class="fl">0.9</span>)</span>
<span id="cb3-579"><a href="#cb3-579" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">"No data"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb3-580"><a href="#cb3-580" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>()</span>
<span id="cb3-581"><a href="#cb3-581" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-582"><a href="#cb3-582" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-583"><a href="#cb3-583" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define colors</span></span>
<span id="cb3-584"><a href="#cb3-584" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (category <span class="sc">==</span> <span class="st">'gender'</span>) {</span>
<span id="cb3-585"><a href="#cb3-585" aria-hidden="true" tabindex="-1"></a>    colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Male'</span> <span class="ot">=</span> <span class="st">'#4E79A7'</span>, <span class="st">'Female'</span> <span class="ot">=</span> <span class="st">'#E15759'</span>, <span class="st">'Unknown'</span> <span class="ot">=</span> <span class="st">'#BAB0AC'</span>)</span>
<span id="cb3-586"><a href="#cb3-586" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-587"><a href="#cb3-587" aria-hidden="true" tabindex="-1"></a>    colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'White'</span> <span class="ot">=</span> <span class="st">'#4E79A7'</span>, <span class="st">'Black'</span> <span class="ot">=</span> <span class="st">'#F25E2B'</span>, <span class="st">'Hispanic'</span> <span class="ot">=</span> <span class="st">'#E14759'</span>,</span>
<span id="cb3-588"><a href="#cb3-588" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Asian'</span> <span class="ot">=</span> <span class="st">'#76B7B2'</span>, <span class="st">'Native American'</span> <span class="ot">=</span> <span class="st">'#59A14F'</span>,</span>
<span id="cb3-589"><a href="#cb3-589" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Other'</span> <span class="ot">=</span> <span class="st">'#9C755F'</span>, <span class="st">'Unknown'</span> <span class="ot">=</span> <span class="st">'#BAB0AC'</span>)</span>
<span id="cb3-590"><a href="#cb3-590" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-591"><a href="#cb3-591" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-592"><a href="#cb3-592" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter colors to only include categories present in data</span></span>
<span id="cb3-593"><a href="#cb3-593" aria-hidden="true" tabindex="-1"></a>  pie_colors <span class="ot">&lt;-</span> colors[<span class="fu">names</span>(colors) <span class="sc">%in%</span> chart_data<span class="sc">$</span>variable_detailed]</span>
<span id="cb3-594"><a href="#cb3-594" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-595"><a href="#cb3-595" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate percentages</span></span>
<span id="cb3-596"><a href="#cb3-596" aria-hidden="true" tabindex="-1"></a>  total_value <span class="ot">&lt;-</span> <span class="fu">sum</span>(chart_data<span class="sc">$</span>value)</span>
<span id="cb3-597"><a href="#cb3-597" aria-hidden="true" tabindex="-1"></a>  chart_data <span class="ot">&lt;-</span> chart_data <span class="sc">%&gt;%</span></span>
<span id="cb3-598"><a href="#cb3-598" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pct =</span> value <span class="sc">/</span> total_value <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb3-599"><a href="#cb3-599" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-600"><a href="#cb3-600" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create labels based on value_type and show_values</span></span>
<span id="cb3-601"><a href="#cb3-601" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (show_values <span class="sc">&amp;&amp;</span> value_type <span class="sc">==</span> <span class="st">'count'</span>) {</span>
<span id="cb3-602"><a href="#cb3-602" aria-hidden="true" tabindex="-1"></a>    chart_data <span class="ot">&lt;-</span> chart_data <span class="sc">%&gt;%</span></span>
<span id="cb3-603"><a href="#cb3-603" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">base_label =</span> <span class="fu">paste0</span>(variable_detailed, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">format</span>(value, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">")"</span>))</span>
<span id="cb3-604"><a href="#cb3-604" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (value_type <span class="sc">==</span> <span class="st">'percentage'</span>) {</span>
<span id="cb3-605"><a href="#cb3-605" aria-hidden="true" tabindex="-1"></a>    chart_data <span class="ot">&lt;-</span> chart_data <span class="sc">%&gt;%</span></span>
<span id="cb3-606"><a href="#cb3-606" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">base_label =</span> <span class="fu">paste0</span>(variable_detailed, <span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">round</span>(value, <span class="dv">1</span>), <span class="st">"%)"</span>))</span>
<span id="cb3-607"><a href="#cb3-607" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-608"><a href="#cb3-608" aria-hidden="true" tabindex="-1"></a>    chart_data <span class="ot">&lt;-</span> chart_data <span class="sc">%&gt;%</span></span>
<span id="cb3-609"><a href="#cb3-609" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">base_label =</span> variable_detailed)</span>
<span id="cb3-610"><a href="#cb3-610" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-611"><a href="#cb3-611" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-612"><a href="#cb3-612" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only show labels for slices &gt;= 3%, otherwise empty string</span></span>
<span id="cb3-613"><a href="#cb3-613" aria-hidden="true" tabindex="-1"></a>  chart_data <span class="ot">&lt;-</span> chart_data <span class="sc">%&gt;%</span></span>
<span id="cb3-614"><a href="#cb3-614" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(pct <span class="sc">&gt;=</span> <span class="dv">3</span>, base_label, <span class="st">""</span>))</span>
<span id="cb3-615"><a href="#cb3-615" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-616"><a href="#cb3-616" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the pie chart</span></span>
<span id="cb3-617"><a href="#cb3-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pie</span>(chart_data<span class="sc">$</span>value, </span>
<span id="cb3-618"><a href="#cb3-618" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> chart_data<span class="sc">$</span>label,</span>
<span id="cb3-619"><a href="#cb3-619" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> title,</span>
<span id="cb3-620"><a href="#cb3-620" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> pie_colors,</span>
<span id="cb3-621"><a href="#cb3-621" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex.main =</span> <span class="fl">0.9</span>,</span>
<span id="cb3-622"><a href="#cb3-622" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb3-623"><a href="#cb3-623" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-624"><a href="#cb3-624" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend for small slices</span></span>
<span id="cb3-625"><a href="#cb3-625" aria-hidden="true" tabindex="-1"></a>  small_slices <span class="ot">&lt;-</span> chart_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pct <span class="sc">&lt;</span> <span class="dv">3</span>)</span>
<span id="cb3-626"><a href="#cb3-626" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(small_slices) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-627"><a href="#cb3-627" aria-hidden="true" tabindex="-1"></a>    legend_labels <span class="ot">&lt;-</span> <span class="fu">paste0</span>(small_slices<span class="sc">$</span>variable_detailed, <span class="st">" ("</span>, <span class="fu">round</span>(small_slices<span class="sc">$</span>pct, <span class="dv">1</span>), <span class="st">"%)"</span>)</span>
<span id="cb3-628"><a href="#cb3-628" aria-hidden="true" tabindex="-1"></a>    legend_colors <span class="ot">&lt;-</span> pie_colors[small_slices<span class="sc">$</span>variable_detailed]</span>
<span id="cb3-629"><a href="#cb3-629" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-630"><a href="#cb3-630" aria-hidden="true" tabindex="-1"></a>    <span class="fu">legend</span>(<span class="st">"bottomright"</span>, </span>
<span id="cb3-631"><a href="#cb3-631" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend =</span> legend_labels,</span>
<span id="cb3-632"><a href="#cb3-632" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> legend_colors,</span>
<span id="cb3-633"><a href="#cb3-633" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex =</span> <span class="fl">0.7</span>,</span>
<span id="cb3-634"><a href="#cb3-634" aria-hidden="true" tabindex="-1"></a>           <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb3-635"><a href="#cb3-635" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-636"><a href="#cb3-636" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-637"><a href="#cb3-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-638"><a href="#cb3-638" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-639"><a href="#cb3-639" aria-hidden="true" tabindex="-1"></a><span class="co"># 18. State visualizations with 2 pies per row</span></span>
<span id="cb3-640"><a href="#cb3-640" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-641"><a href="#cb3-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-642"><a href="#cb3-642" aria-hidden="true" tabindex="-1"></a>create_state_visualizations <span class="ot">&lt;-</span> <span class="cf">function</span>(df_combined, state_name) {</span>
<span id="cb3-643"><a href="#cb3-643" aria-hidden="true" tabindex="-1"></a>  state_data <span class="ot">&lt;-</span> df_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> state_name)</span>
<span id="cb3-644"><a href="#cb3-644" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-645"><a href="#cb3-645" aria-hidden="true" tabindex="-1"></a>  offender_types <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(state_data<span class="sc">$</span>offender_type))</span>
<span id="cb3-646"><a href="#cb3-646" aria-hidden="true" tabindex="-1"></a>  plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-647"><a href="#cb3-647" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-648"><a href="#cb3-648" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (offender_type <span class="cf">in</span> offender_types) {</span>
<span id="cb3-649"><a href="#cb3-649" aria-hidden="true" tabindex="-1"></a>    plots <span class="ot">&lt;-</span> <span class="fu">c</span>(plots, <span class="fu">list</span>(</span>
<span id="cb3-650"><a href="#cb3-650" aria-hidden="true" tabindex="-1"></a>      <span class="fu">create_pie_chart</span>(state_data, offender_type, <span class="st">'gender'</span>, <span class="st">'count'</span>,</span>
<span id="cb3-651"><a href="#cb3-651" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste</span>(offender_type, <span class="st">"Gender Counts"</span>), <span class="cn">TRUE</span>),</span>
<span id="cb3-652"><a href="#cb3-652" aria-hidden="true" tabindex="-1"></a>      <span class="fu">create_pie_chart</span>(state_data, offender_type, <span class="st">'gender'</span>, <span class="st">'percentage'</span>,</span>
<span id="cb3-653"><a href="#cb3-653" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste</span>(offender_type, <span class="st">"Gender Percentages"</span>)),</span>
<span id="cb3-654"><a href="#cb3-654" aria-hidden="true" tabindex="-1"></a>      <span class="fu">create_pie_chart</span>(state_data, offender_type, <span class="st">'race'</span>, <span class="st">'count'</span>,</span>
<span id="cb3-655"><a href="#cb3-655" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste</span>(offender_type, <span class="st">"Race Counts"</span>), <span class="cn">TRUE</span>),</span>
<span id="cb3-656"><a href="#cb3-656" aria-hidden="true" tabindex="-1"></a>      <span class="fu">create_pie_chart</span>(state_data, offender_type, <span class="st">'race'</span>, <span class="st">'percentage'</span>,</span>
<span id="cb3-657"><a href="#cb3-657" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">paste</span>(offender_type, <span class="st">"Race Percentages"</span>))</span>
<span id="cb3-658"><a href="#cb3-658" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb3-659"><a href="#cb3-659" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-660"><a href="#cb3-660" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-661"><a href="#cb3-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-662"><a href="#cb3-662" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-663"><a href="#cb3-663" aria-hidden="true" tabindex="-1"></a><span class="co"># 19. Demographic bar chart function</span></span>
<span id="cb3-664"><a href="#cb3-664" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-665"><a href="#cb3-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-666"><a href="#cb3-666" aria-hidden="true" tabindex="-1"></a>create_demographic_bar_charts <span class="ot">&lt;-</span> <span class="cf">function</span>(df_combined, state_name) {</span>
<span id="cb3-667"><a href="#cb3-667" aria-hidden="true" tabindex="-1"></a>  state_data <span class="ot">&lt;-</span> df_combined <span class="sc">%&gt;%</span></span>
<span id="cb3-668"><a href="#cb3-668" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(state <span class="sc">==</span> state_name)</span>
<span id="cb3-669"><a href="#cb3-669" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-670"><a href="#cb3-670" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get offender types and ensure Combined is last</span></span>
<span id="cb3-671"><a href="#cb3-671" aria-hidden="true" tabindex="-1"></a>  offender_types <span class="ot">&lt;-</span> state_data <span class="sc">%&gt;%</span></span>
<span id="cb3-672"><a href="#cb3-672" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(value_type <span class="sc">==</span> <span class="st">'count'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-673"><a href="#cb3-673" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(offender_type) <span class="sc">%&gt;%</span></span>
<span id="cb3-674"><a href="#cb3-674" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-675"><a href="#cb3-675" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sort</span>()</span>
<span id="cb3-676"><a href="#cb3-676" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-677"><a href="#cb3-677" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">'Combined'</span> <span class="sc">%in%</span> offender_types) {</span>
<span id="cb3-678"><a href="#cb3-678" aria-hidden="true" tabindex="-1"></a>    offender_types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">setdiff</span>(offender_types, <span class="st">'Combined'</span>), <span class="st">'Combined'</span>)</span>
<span id="cb3-679"><a href="#cb3-679" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-680"><a href="#cb3-680" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-681"><a href="#cb3-681" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Color palettes</span></span>
<span id="cb3-682"><a href="#cb3-682" aria-hidden="true" tabindex="-1"></a>  gender_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Male'</span> <span class="ot">=</span> <span class="st">'#4E79A7'</span>, <span class="st">'Female'</span> <span class="ot">=</span> <span class="st">'#E15759'</span>, <span class="st">'Unknown'</span> <span class="ot">=</span> <span class="st">'#BAB0AC'</span>)</span>
<span id="cb3-683"><a href="#cb3-683" aria-hidden="true" tabindex="-1"></a>  race_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb3-684"><a href="#cb3-684" aria-hidden="true" tabindex="-1"></a>    <span class="st">'White'</span> <span class="ot">=</span> <span class="st">'#4E79A7'</span>, </span>
<span id="cb3-685"><a href="#cb3-685" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Black'</span> <span class="ot">=</span> <span class="st">'#F25E2B'</span>, </span>
<span id="cb3-686"><a href="#cb3-686" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Hispanic'</span> <span class="ot">=</span> <span class="st">'#E14759'</span>,</span>
<span id="cb3-687"><a href="#cb3-687" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Asian'</span> <span class="ot">=</span> <span class="st">'#76B7B2'</span>,</span>
<span id="cb3-688"><a href="#cb3-688" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Native American'</span> <span class="ot">=</span> <span class="st">'#59A14F'</span>,</span>
<span id="cb3-689"><a href="#cb3-689" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Other'</span> <span class="ot">=</span> <span class="st">'#9C755F'</span>,</span>
<span id="cb3-690"><a href="#cb3-690" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Unknown'</span> <span class="ot">=</span> <span class="st">'#BAB0AC'</span></span>
<span id="cb3-691"><a href="#cb3-691" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-692"><a href="#cb3-692" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-693"><a href="#cb3-693" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Gender data - ensure no duplicates by summing values</span></span>
<span id="cb3-694"><a href="#cb3-694" aria-hidden="true" tabindex="-1"></a>  gender_data <span class="ot">&lt;-</span> state_data <span class="sc">%&gt;%</span></span>
<span id="cb3-695"><a href="#cb3-695" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="st">'gender'</span>,</span>
<span id="cb3-696"><a href="#cb3-696" aria-hidden="true" tabindex="-1"></a>           value_type <span class="sc">==</span> <span class="st">'count'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-697"><a href="#cb3-697" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(offender_type, variable_detailed) <span class="sc">%&gt;%</span></span>
<span id="cb3-698"><a href="#cb3-698" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-699"><a href="#cb3-699" aria-hidden="true" tabindex="-1"></a>    <span class="fu">complete</span>(offender_type, <span class="at">variable_detailed =</span> <span class="fu">c</span>(<span class="st">'Male'</span>, <span class="st">'Female'</span>, <span class="st">'Unknown'</span>), </span>
<span id="cb3-700"><a href="#cb3-700" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">value =</span> <span class="dv">0</span>))</span>
<span id="cb3-701"><a href="#cb3-701" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-702"><a href="#cb3-702" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Race data - ensure no duplicates by summing values</span></span>
<span id="cb3-703"><a href="#cb3-703" aria-hidden="true" tabindex="-1"></a>  race_data <span class="ot">&lt;-</span> state_data <span class="sc">%&gt;%</span></span>
<span id="cb3-704"><a href="#cb3-704" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="st">'race'</span>,</span>
<span id="cb3-705"><a href="#cb3-705" aria-hidden="true" tabindex="-1"></a>           value_type <span class="sc">==</span> <span class="st">'count'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-706"><a href="#cb3-706" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(offender_type, variable_detailed) <span class="sc">%&gt;%</span></span>
<span id="cb3-707"><a href="#cb3-707" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-708"><a href="#cb3-708" aria-hidden="true" tabindex="-1"></a>    <span class="fu">complete</span>(offender_type, </span>
<span id="cb3-709"><a href="#cb3-709" aria-hidden="true" tabindex="-1"></a>             <span class="at">variable_detailed =</span> <span class="fu">c</span>(<span class="st">'White'</span>, <span class="st">'Black'</span>, <span class="st">'Hispanic'</span>, </span>
<span id="cb3-710"><a href="#cb3-710" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'Asian'</span>, <span class="st">'Native American'</span>, <span class="st">'Other'</span>, <span class="st">'Unknown'</span>), </span>
<span id="cb3-711"><a href="#cb3-711" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">value =</span> <span class="dv">0</span>))</span>
<span id="cb3-712"><a href="#cb3-712" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-713"><a href="#cb3-713" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create separate plots - one per row</span></span>
<span id="cb3-714"><a href="#cb3-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">9</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>)) <span class="co"># Increased right margin for legend</span></span>
<span id="cb3-715"><a href="#cb3-715" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-716"><a href="#cb3-716" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Gender plot - ordered by total volume</span></span>
<span id="cb3-717"><a href="#cb3-717" aria-hidden="true" tabindex="-1"></a>  gender_plot_data <span class="ot">&lt;-</span> gender_data <span class="sc">%&gt;%</span></span>
<span id="cb3-718"><a href="#cb3-718" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(variable_detailed <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Male'</span>, <span class="st">'Female'</span>, <span class="st">'Unknown'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-719"><a href="#cb3-719" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">offender_type =</span> <span class="fu">factor</span>(offender_type, <span class="at">levels =</span> <span class="fu">rev</span>(offender_types)))</span>
<span id="cb3-720"><a href="#cb3-720" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-721"><a href="#cb3-721" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Order gender categories by total volume (largest at bottom)</span></span>
<span id="cb3-722"><a href="#cb3-722" aria-hidden="true" tabindex="-1"></a>  gender_order <span class="ot">&lt;-</span> gender_plot_data <span class="sc">%&gt;%</span></span>
<span id="cb3-723"><a href="#cb3-723" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(variable_detailed) <span class="sc">%&gt;%</span></span>
<span id="cb3-724"><a href="#cb3-724" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">sum</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb3-725"><a href="#cb3-725" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(total) <span class="sc">%&gt;%</span></span>
<span id="cb3-726"><a href="#cb3-726" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(variable_detailed)</span>
<span id="cb3-727"><a href="#cb3-727" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-728"><a href="#cb3-728" aria-hidden="true" tabindex="-1"></a>  gender_plot_data <span class="ot">&lt;-</span> gender_plot_data <span class="sc">%&gt;%</span></span>
<span id="cb3-729"><a href="#cb3-729" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable_detailed =</span> <span class="fu">factor</span>(variable_detailed, <span class="at">levels =</span> gender_order))</span>
<span id="cb3-730"><a href="#cb3-730" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-731"><a href="#cb3-731" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshape for barplot</span></span>
<span id="cb3-732"><a href="#cb3-732" aria-hidden="true" tabindex="-1"></a>  gender_matrix <span class="ot">&lt;-</span> gender_plot_data <span class="sc">%&gt;%</span></span>
<span id="cb3-733"><a href="#cb3-733" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable_detailed, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb3-734"><a href="#cb3-734" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-735"><a href="#cb3-735" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"offender_type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-736"><a href="#cb3-736" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb3-737"><a href="#cb3-737" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-738"><a href="#cb3-738" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure all columns exist</span></span>
<span id="cb3-739"><a href="#cb3-739" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (gender <span class="cf">in</span> gender_order) {</span>
<span id="cb3-740"><a href="#cb3-740" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>gender <span class="sc">%in%</span> <span class="fu">colnames</span>(gender_matrix)) {</span>
<span id="cb3-741"><a href="#cb3-741" aria-hidden="true" tabindex="-1"></a>      gender_matrix <span class="ot">&lt;-</span> <span class="fu">cbind</span>(gender_matrix, <span class="at">temp =</span> <span class="dv">0</span>)</span>
<span id="cb3-742"><a href="#cb3-742" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(gender_matrix)[<span class="fu">ncol</span>(gender_matrix)] <span class="ot">&lt;-</span> gender</span>
<span id="cb3-743"><a href="#cb3-743" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-744"><a href="#cb3-744" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-745"><a href="#cb3-745" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-746"><a href="#cb3-746" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reorder columns by volume</span></span>
<span id="cb3-747"><a href="#cb3-747" aria-hidden="true" tabindex="-1"></a>  gender_matrix <span class="ot">&lt;-</span> gender_matrix[, <span class="fu">as.character</span>(gender_order), drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb3-748"><a href="#cb3-748" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-749"><a href="#cb3-749" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Format x-axis labels with "k" for thousands</span></span>
<span id="cb3-750"><a href="#cb3-750" aria-hidden="true" tabindex="-1"></a>  max_x <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">rowSums</span>(gender_matrix))</span>
<span id="cb3-751"><a href="#cb3-751" aria-hidden="true" tabindex="-1"></a>  x_breaks <span class="ot">&lt;-</span> <span class="fu">pretty</span>(<span class="fu">c</span>(<span class="dv">0</span>, max_x))</span>
<span id="cb3-752"><a href="#cb3-752" aria-hidden="true" tabindex="-1"></a>  x_labels <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x_breaks <span class="sc">&gt;=</span> <span class="dv">1000</span>, </span>
<span id="cb3-753"><a href="#cb3-753" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">paste0</span>(x_breaks<span class="sc">/</span><span class="dv">1000</span>, <span class="st">"k"</span>), </span>
<span id="cb3-754"><a href="#cb3-754" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">as.character</span>(x_breaks))</span>
<span id="cb3-755"><a href="#cb3-755" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-756"><a href="#cb3-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">barplot</span>(<span class="fu">t</span>(gender_matrix), </span>
<span id="cb3-757"><a href="#cb3-757" aria-hidden="true" tabindex="-1"></a>          <span class="at">horiz =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-758"><a href="#cb3-758" aria-hidden="true" tabindex="-1"></a>          <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb3-759"><a href="#cb3-759" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> gender_colors[<span class="fu">colnames</span>(gender_matrix)],</span>
<span id="cb3-760"><a href="#cb3-760" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">'Gender Distribution'</span>,</span>
<span id="cb3-761"><a href="#cb3-761" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">'Number of Profiles'</span>,</span>
<span id="cb3-762"><a href="#cb3-762" aria-hidden="true" tabindex="-1"></a>          <span class="at">xaxt =</span> <span class="st">'n'</span>,  <span class="co"># Remove default x-axis</span></span>
<span id="cb3-763"><a href="#cb3-763" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="cn">FALSE</span>,  <span class="co"># Don't show legend in plot area</span></span>
<span id="cb3-764"><a href="#cb3-764" aria-hidden="true" tabindex="-1"></a>          <span class="at">args.legend =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">"right"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">inset =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="dv">0</span>)))</span>
<span id="cb3-765"><a href="#cb3-765" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-766"><a href="#cb3-766" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add custom x-axis with formatted labels</span></span>
<span id="cb3-767"><a href="#cb3-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> x_breaks, <span class="at">labels =</span> x_labels)</span>
<span id="cb3-768"><a href="#cb3-768" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-769"><a href="#cb3-769" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend outside the plot area</span></span>
<span id="cb3-770"><a href="#cb3-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb3-771"><a href="#cb3-771" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">colnames</span>(gender_matrix), </span>
<span id="cb3-772"><a href="#cb3-772" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> gender_colors[<span class="fu">colnames</span>(gender_matrix)],</span>
<span id="cb3-773"><a href="#cb3-773" aria-hidden="true" tabindex="-1"></a>         <span class="at">bty =</span> <span class="st">"n"</span>, </span>
<span id="cb3-774"><a href="#cb3-774" aria-hidden="true" tabindex="-1"></a>         <span class="at">xpd =</span> <span class="cn">TRUE</span>,  <span class="co"># Allow plotting outside main area</span></span>
<span id="cb3-775"><a href="#cb3-775" aria-hidden="true" tabindex="-1"></a>         <span class="at">inset =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="dv">0</span>),  <span class="co"># Move legend to the right</span></span>
<span id="cb3-776"><a href="#cb3-776" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb3-777"><a href="#cb3-777" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-778"><a href="#cb3-778" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Race plot - ordered by total volume</span></span>
<span id="cb3-779"><a href="#cb3-779" aria-hidden="true" tabindex="-1"></a>  race_plot_data <span class="ot">&lt;-</span> race_data <span class="sc">%&gt;%</span></span>
<span id="cb3-780"><a href="#cb3-780" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">offender_type =</span> <span class="fu">factor</span>(offender_type, <span class="at">levels =</span> <span class="fu">rev</span>(offender_types)))</span>
<span id="cb3-781"><a href="#cb3-781" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-782"><a href="#cb3-782" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Order race categories by total volume (largest at bottom)</span></span>
<span id="cb3-783"><a href="#cb3-783" aria-hidden="true" tabindex="-1"></a>  race_order <span class="ot">&lt;-</span> race_plot_data <span class="sc">%&gt;%</span></span>
<span id="cb3-784"><a href="#cb3-784" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(variable_detailed) <span class="sc">%&gt;%</span></span>
<span id="cb3-785"><a href="#cb3-785" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">total =</span> <span class="fu">sum</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb3-786"><a href="#cb3-786" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(total) <span class="sc">%&gt;%</span></span>
<span id="cb3-787"><a href="#cb3-787" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(variable_detailed)</span>
<span id="cb3-788"><a href="#cb3-788" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-789"><a href="#cb3-789" aria-hidden="true" tabindex="-1"></a>  race_plot_data <span class="ot">&lt;-</span> race_plot_data <span class="sc">%&gt;%</span></span>
<span id="cb3-790"><a href="#cb3-790" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable_detailed =</span> <span class="fu">factor</span>(variable_detailed, <span class="at">levels =</span> race_order))</span>
<span id="cb3-791"><a href="#cb3-791" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-792"><a href="#cb3-792" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshape for barplot</span></span>
<span id="cb3-793"><a href="#cb3-793" aria-hidden="true" tabindex="-1"></a>  race_matrix <span class="ot">&lt;-</span> race_plot_data <span class="sc">%&gt;%</span></span>
<span id="cb3-794"><a href="#cb3-794" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable_detailed, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb3-795"><a href="#cb3-795" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-796"><a href="#cb3-796" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"offender_type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-797"><a href="#cb3-797" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb3-798"><a href="#cb3-798" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-799"><a href="#cb3-799" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure all columns exist</span></span>
<span id="cb3-800"><a href="#cb3-800" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (race <span class="cf">in</span> race_order) {</span>
<span id="cb3-801"><a href="#cb3-801" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>race <span class="sc">%in%</span> <span class="fu">colnames</span>(race_matrix)) {</span>
<span id="cb3-802"><a href="#cb3-802" aria-hidden="true" tabindex="-1"></a>      race_matrix <span class="ot">&lt;-</span> <span class="fu">cbind</span>(race_matrix, <span class="at">temp =</span> <span class="dv">0</span>)</span>
<span id="cb3-803"><a href="#cb3-803" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(race_matrix)[<span class="fu">ncol</span>(race_matrix)] <span class="ot">&lt;-</span> race</span>
<span id="cb3-804"><a href="#cb3-804" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-805"><a href="#cb3-805" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-806"><a href="#cb3-806" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-807"><a href="#cb3-807" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reorder columns by volume</span></span>
<span id="cb3-808"><a href="#cb3-808" aria-hidden="true" tabindex="-1"></a>  race_matrix <span class="ot">&lt;-</span> race_matrix[, <span class="fu">as.character</span>(race_order), drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb3-809"><a href="#cb3-809" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-810"><a href="#cb3-810" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Format x-axis labels with "k" for thousands</span></span>
<span id="cb3-811"><a href="#cb3-811" aria-hidden="true" tabindex="-1"></a>  max_x_race <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">rowSums</span>(race_matrix))</span>
<span id="cb3-812"><a href="#cb3-812" aria-hidden="true" tabindex="-1"></a>  x_breaks_race <span class="ot">&lt;-</span> <span class="fu">pretty</span>(<span class="fu">c</span>(<span class="dv">0</span>, max_x_race))</span>
<span id="cb3-813"><a href="#cb3-813" aria-hidden="true" tabindex="-1"></a>  x_labels_race <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x_breaks_race <span class="sc">&gt;=</span> <span class="dv">1000</span>, </span>
<span id="cb3-814"><a href="#cb3-814" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(x_breaks_race<span class="sc">/</span><span class="dv">1000</span>, <span class="st">"k"</span>), </span>
<span id="cb3-815"><a href="#cb3-815" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">as.character</span>(x_breaks_race))</span>
<span id="cb3-816"><a href="#cb3-816" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-817"><a href="#cb3-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">barplot</span>(<span class="fu">t</span>(race_matrix), </span>
<span id="cb3-818"><a href="#cb3-818" aria-hidden="true" tabindex="-1"></a>          <span class="at">horiz =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-819"><a href="#cb3-819" aria-hidden="true" tabindex="-1"></a>          <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb3-820"><a href="#cb3-820" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> race_colors[<span class="fu">colnames</span>(race_matrix)],</span>
<span id="cb3-821"><a href="#cb3-821" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">'Race Distribution'</span>,</span>
<span id="cb3-822"><a href="#cb3-822" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">'Number of Profiles'</span>,</span>
<span id="cb3-823"><a href="#cb3-823" aria-hidden="true" tabindex="-1"></a>          <span class="at">xaxt =</span> <span class="st">'n'</span>,  <span class="co"># Remove default x-axis</span></span>
<span id="cb3-824"><a href="#cb3-824" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="cn">FALSE</span>)  <span class="co"># Don't show legend in plot area</span></span>
<span id="cb3-825"><a href="#cb3-825" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-826"><a href="#cb3-826" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add custom x-axis with formatted labels</span></span>
<span id="cb3-827"><a href="#cb3-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> x_breaks_race, <span class="at">labels =</span> x_labels_race)</span>
<span id="cb3-828"><a href="#cb3-828" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-829"><a href="#cb3-829" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add legend outside the plot area</span></span>
<span id="cb3-830"><a href="#cb3-830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb3-831"><a href="#cb3-831" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">colnames</span>(race_matrix), </span>
<span id="cb3-832"><a href="#cb3-832" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> race_colors[<span class="fu">colnames</span>(race_matrix)],</span>
<span id="cb3-833"><a href="#cb3-833" aria-hidden="true" tabindex="-1"></a>         <span class="at">bty =</span> <span class="st">"n"</span>, </span>
<span id="cb3-834"><a href="#cb3-834" aria-hidden="true" tabindex="-1"></a>         <span class="at">xpd =</span> <span class="cn">TRUE</span>,  <span class="co"># Allow plotting outside main area</span></span>
<span id="cb3-835"><a href="#cb3-835" aria-hidden="true" tabindex="-1"></a>         <span class="at">inset =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="dv">0</span>),  <span class="co"># Move legend to the right</span></span>
<span id="cb3-836"><a href="#cb3-836" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb3-837"><a href="#cb3-837" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-838"><a href="#cb3-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="fu">paste</span>(state_name, <span class="st">"Demographic Distribution"</span>), <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="at">cex.main =</span> <span class="fl">1.5</span>)</span>
<span id="cb3-839"><a href="#cb3-839" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-840"><a href="#cb3-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-841"><a href="#cb3-841" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-842"><a href="#cb3-842" aria-hidden="true" tabindex="-1"></a><span class="co"># 20. Add state's metadata</span></span>
<span id="cb3-843"><a href="#cb3-843" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-844"><a href="#cb3-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-845"><a href="#cb3-845" aria-hidden="true" tabindex="-1"></a>add_state_metadata <span class="ot">&lt;-</span> <span class="cf">function</span>(state_name, state_df) {</span>
<span id="cb3-846"><a href="#cb3-846" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-847"><a href="#cb3-847" aria-hidden="true" tabindex="-1"></a>  raw_data <span class="ot">&lt;-</span> state_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(value_source <span class="sc">==</span> <span class="st">"reported"</span>)</span>
<span id="cb3-848"><a href="#cb3-848" aria-hidden="true" tabindex="-1"></a>  offender_types_reported <span class="ot">&lt;-</span> <span class="fu">unique</span>(raw_data<span class="sc">$</span>offender_type)</span>
<span id="cb3-849"><a href="#cb3-849" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-850"><a href="#cb3-850" aria-hidden="true" tabindex="-1"></a>  has_unknown <span class="ot">&lt;-</span> <span class="fu">any</span>(raw_data<span class="sc">$</span>variable_detailed <span class="sc">==</span> <span class="st">"Unknown"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-851"><a href="#cb3-851" aria-hidden="true" tabindex="-1"></a>  has_other <span class="ot">&lt;-</span> <span class="fu">any</span>(raw_data<span class="sc">$</span>variable_detailed <span class="sc">==</span> <span class="st">"Other"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-852"><a href="#cb3-852" aria-hidden="true" tabindex="-1"></a>  has_crosstab <span class="ot">&lt;-</span> <span class="fu">any</span>(raw_data<span class="sc">$</span>variable_category <span class="sc">==</span> <span class="st">"gender_race"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-853"><a href="#cb3-853" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-854"><a href="#cb3-854" aria-hidden="true" tabindex="-1"></a>  nonstandard_terms <span class="ot">&lt;-</span> <span class="fu">any</span>(</span>
<span id="cb3-855"><a href="#cb3-855" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"All|Offenders"</span>, raw_data<span class="sc">$</span>offender_type, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-856"><a href="#cb3-856" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"Caucasian|African American| American Indian"</span>, raw_data<span class="sc">$</span>variable_detailed, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-857"><a href="#cb3-857" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"flag"</span>, raw_data<span class="sc">$</span>variable_detailed, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb3-858"><a href="#cb3-858" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-859"><a href="#cb3-859" aria-hidden="true" tabindex="-1"></a>  new_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb3-860"><a href="#cb3-860" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> state_name,</span>
<span id="cb3-861"><a href="#cb3-861" aria-hidden="true" tabindex="-1"></a>    <span class="at">race_data_provided =</span> <span class="fu">report_status</span>(raw_data, <span class="st">"race"</span>),</span>
<span id="cb3-862"><a href="#cb3-862" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender_data_provided =</span> <span class="fu">report_status</span>(raw_data, <span class="st">"gender"</span>),</span>
<span id="cb3-863"><a href="#cb3-863" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_profiles_provided =</span> <span class="fu">report_status</span>(</span>
<span id="cb3-864"><a href="#cb3-864" aria-hidden="true" tabindex="-1"></a>      raw_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="st">"total"</span>), <span class="st">"total"</span></span>
<span id="cb3-865"><a href="#cb3-865" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-866"><a href="#cb3-866" aria-hidden="true" tabindex="-1"></a>    <span class="at">convicted_offender_reported =</span> <span class="st">"Convicted Offender"</span> <span class="sc">%in%</span> offender_types_reported,</span>
<span id="cb3-867"><a href="#cb3-867" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrestee_reported =</span> <span class="st">"Arrestee"</span> <span class="sc">%in%</span> offender_types_reported,</span>
<span id="cb3-868"><a href="#cb3-868" aria-hidden="true" tabindex="-1"></a>    <span class="at">combined_reported =</span> <span class="st">"Combined"</span> <span class="sc">%in%</span> offender_types_reported,</span>
<span id="cb3-869"><a href="#cb3-869" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_unknown_category =</span> has_unknown,</span>
<span id="cb3-870"><a href="#cb3-870" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_other_category =</span> has_other,</span>
<span id="cb3-871"><a href="#cb3-871" aria-hidden="true" tabindex="-1"></a>    <span class="at">uses_nonstandard_terminology =</span> nonstandard_terms,</span>
<span id="cb3-872"><a href="#cb3-872" aria-hidden="true" tabindex="-1"></a>    <span class="at">provides_crosstabulation =</span> has_crosstab,</span>
<span id="cb3-873"><a href="#cb3-873" aria-hidden="true" tabindex="-1"></a>    <span class="at">counts_sum_to_total =</span> <span class="cn">NA</span>,</span>
<span id="cb3-874"><a href="#cb3-874" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentages_sum_to_100 =</span> <span class="cn">NA</span>,</span>
<span id="cb3-875"><a href="#cb3-875" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_calculated_combined =</span> <span class="sc">!</span>(<span class="st">"Combined"</span> <span class="sc">%in%</span> offender_types_reported),</span>
<span id="cb3-876"><a href="#cb3-876" aria-hidden="true" tabindex="-1"></a>    <span class="at">notes =</span> <span class="st">""</span></span>
<span id="cb3-877"><a href="#cb3-877" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-878"><a href="#cb3-878" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-879"><a href="#cb3-879" aria-hidden="true" tabindex="-1"></a>  foia_state_metadata <span class="ot">&lt;&lt;-</span> <span class="fu">bind_rows</span>(foia_state_metadata, new_row)</span>
<span id="cb3-880"><a href="#cb3-880" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-881"><a href="#cb3-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"✓ Metadata added for:"</span>, state_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-882"><a href="#cb3-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">invisible</span>(<span class="cn">TRUE</span>))</span>
<span id="cb3-883"><a href="#cb3-883" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-884"><a href="#cb3-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-885"><a href="#cb3-885" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-886"><a href="#cb3-886" aria-hidden="true" tabindex="-1"></a><span class="co"># 21. Function to update a state's metadata after QC checks</span></span>
<span id="cb3-887"><a href="#cb3-887" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb3-888"><a href="#cb3-888" aria-hidden="true" tabindex="-1"></a>update_state_metadata <span class="ot">&lt;-</span> <span class="cf">function</span>(state_name, </span>
<span id="cb3-889"><a href="#cb3-889" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">counts_ok =</span> <span class="cn">NA</span>, </span>
<span id="cb3-890"><a href="#cb3-890" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">percentages_ok =</span> <span class="cn">NA</span>, </span>
<span id="cb3-891"><a href="#cb3-891" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">notes_text =</span> <span class="cn">NULL</span>) {</span>
<span id="cb3-892"><a href="#cb3-892" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-893"><a href="#cb3-893" aria-hidden="true" tabindex="-1"></a>  row_index <span class="ot">&lt;-</span> <span class="fu">which</span>(foia_state_metadata<span class="sc">$</span>state <span class="sc">==</span> state_name)</span>
<span id="cb3-894"><a href="#cb3-894" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-895"><a href="#cb3-895" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(row_index) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb3-896"><a href="#cb3-896" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="st">"State not found in metadata: "</span>, state_name)</span>
<span id="cb3-897"><a href="#cb3-897" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">FALSE</span>)</span>
<span id="cb3-898"><a href="#cb3-898" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-899"><a href="#cb3-899" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-900"><a href="#cb3-900" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(counts_ok)) {</span>
<span id="cb3-901"><a href="#cb3-901" aria-hidden="true" tabindex="-1"></a>    foia_state_metadata<span class="sc">$</span>counts_sum_to_total[row_index] <span class="ot">&lt;&lt;-</span> counts_ok</span>
<span id="cb3-902"><a href="#cb3-902" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-903"><a href="#cb3-903" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(percentages_ok)) {</span>
<span id="cb3-904"><a href="#cb3-904" aria-hidden="true" tabindex="-1"></a>    foia_state_metadata<span class="sc">$</span>percentages_sum_to_100[row_index] <span class="ot">&lt;&lt;-</span> percentages_ok</span>
<span id="cb3-905"><a href="#cb3-905" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-906"><a href="#cb3-906" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(notes_text)) {</span>
<span id="cb3-907"><a href="#cb3-907" aria-hidden="true" tabindex="-1"></a>    current_notes <span class="ot">&lt;-</span> foia_state_metadata<span class="sc">$</span>notes[row_index]</span>
<span id="cb3-908"><a href="#cb3-908" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (current_notes <span class="sc">==</span> <span class="st">""</span>) {</span>
<span id="cb3-909"><a href="#cb3-909" aria-hidden="true" tabindex="-1"></a>      foia_state_metadata<span class="sc">$</span>notes[row_index] <span class="ot">&lt;&lt;-</span> notes_text</span>
<span id="cb3-910"><a href="#cb3-910" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb3-911"><a href="#cb3-911" aria-hidden="true" tabindex="-1"></a>      foia_state_metadata<span class="sc">$</span>notes[row_index] <span class="ot">&lt;&lt;-</span> <span class="fu">paste</span>(current_notes, notes_text, <span class="at">sep =</span> <span class="st">"; "</span>)</span>
<span id="cb3-912"><a href="#cb3-912" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-913"><a href="#cb3-913" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-914"><a href="#cb3-914" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-915"><a href="#cb3-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"✓ Metadata updated for:"</span>, state_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-916"><a href="#cb3-916" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="file-structure-and-contents" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="file-structure-and-contents"><span class="header-section-number">2.4</span> File Structure and Contents</h2>
<section id="state-specific-files-datafoiaintermediatestate_foia_data.csv" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="state-specific-files-datafoiaintermediatestate_foia_data.csv"><span class="header-section-number">2.4.1</span> State-Specific Files: <code>data/foia/intermediate/[state]_foia_data.csv</code></h3>
<p><strong>Purpose</strong>: Individual files for each state containing only their reported data.</p>
<p><strong>Structure</strong>: Long format with columns:</p>
<ul>
<li><code>state</code>: State name</li>
<li><code>offender_type</code>: Category of individuals (Convicted Offender, Arrestee, Combined, etc.)</li>
<li><code>variable_category</code>: Type of data (total, gender, race, gender_race)</li>
<li><code>variable_detailed</code>: Specific value (e.g., Male, Female, African American)</li>
<li><code>value</code>: The reported number or percentage</li>
<li><code>value_type</code>: Whether value is a “count” or “percentage”</li>
<li><code>date</code>: Date of data snapshot, if reported</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show per-state files loading code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ca_raw <span class="ot">&lt;-</span> <span class="fu">load_state</span>(<span class="fu">here</span>(per_state, <span class="st">"california_foia_data.csv"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>fl_raw <span class="ot">&lt;-</span> <span class="fu">load_state</span>(<span class="fu">here</span>(per_state, <span class="st">"florida_foia_data.csv"</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>in_raw <span class="ot">&lt;-</span> <span class="fu">load_state</span>(<span class="fu">here</span>(per_state, <span class="st">"indiana_foia_data.csv"</span>))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>me_raw <span class="ot">&lt;-</span> <span class="fu">load_state</span>(<span class="fu">here</span>(per_state, <span class="st">"maine_foia_data.csv"</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>nv_raw <span class="ot">&lt;-</span> <span class="fu">load_state</span>(<span class="fu">here</span>(per_state, <span class="st">"nevada_foia_data.csv"</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>sd_raw <span class="ot">&lt;-</span> <span class="fu">load_state</span>(<span class="fu">here</span>(per_state, <span class="st">"south_dakota_foia_data.csv"</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>tx_raw <span class="ot">&lt;-</span> <span class="fu">load_state</span>(<span class="fu">here</span>(per_state, <span class="st">"texas_foia_data.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="raw-data-characteristics" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="raw-data-characteristics"><span class="header-section-number">2.4.2</span> Raw Data Characteristics</h3>
<p>The following table summarizes the structure and content of the data as originally received from each state prior to any standardization, calculation, or processing.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">State</th>
<th style="text-align: left;">Offender Types</th>
<th style="text-align: left;">Value Types</th>
<th style="text-align: left;">Total Profiles</th>
<th style="text-align: left;">Action Needed</th>
<th style="text-align: left;">Key Reporting Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>California</strong></td>
<td style="text-align: left;">CO, A</td>
<td style="text-align: left;">Counts only</td>
<td style="text-align: left;">Reported per offender type</td>
<td style="text-align: left;">Add Unknown Race, Calculate % &amp; Combined, Standardize Terminology</td>
<td style="text-align: left;">Discrepancy in Race: counts &lt; total profiles; Non-standard terminology (Caucasian and African American)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Florida</strong></td>
<td style="text-align: left;">COMB</td>
<td style="text-align: left;">Counts + %</td>
<td style="text-align: left;">Reported</td>
<td style="text-align: left;">Standardize Terminology</td>
<td style="text-align: left;">Non-standard terminology (Caucasian and African American)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Indiana</strong></td>
<td style="text-align: left;">CO, A, COMB</td>
<td style="text-align: left;">Percentage (Counts for totals only)</td>
<td style="text-align: left;">Reported per offender type</td>
<td style="text-align: left;">Calculate Counts &amp; Total Profiles Combined, Fix % inconsistency, Standardize Terminology</td>
<td style="text-align: left;">Demographics only for Combined; <code>Other</code> race category as “&lt;1”; Non-standard terminology (Caucasian)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Maine</strong></td>
<td style="text-align: left;">COMB</td>
<td style="text-align: left;">Counts + %</td>
<td style="text-align: left;">Reported</td>
<td style="text-align: left;">Solve counts and Percentage inconsistency</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Nevada</strong></td>
<td style="text-align: left;">CO, A, COMB</td>
<td style="text-align: left;">Counts + %</td>
<td style="text-align: left;">Reported for all types</td>
<td style="text-align: left;">Standardize Terminology</td>
<td style="text-align: left;">Non-standard terminology (All, total_flags and American Indian)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>South Dakota</strong></td>
<td style="text-align: left;">COMB</td>
<td style="text-align: left;">Counts + %</td>
<td style="text-align: left;">Reported</td>
<td style="text-align: left;">Standardize Terminology, Solve counts and % inconsistency</td>
<td style="text-align: left;">Includes gender×race cross-tabulation; Non-standard terminology</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Texas</strong></td>
<td style="text-align: left;">CO, A</td>
<td style="text-align: left;">Counts only</td>
<td style="text-align: left;">Reported per offender type</td>
<td style="text-align: left;">Calculate Male counts, Solve counts inconsistency, Calculate % &amp; Combined, Standardize Terminology</td>
<td style="text-align: left;">Only female gender was reported; Non-standard term (Offenders, Caucasian, and African American)</td>
</tr>
</tbody>
</table>
<p><strong>Legend:</strong></p>
<ul>
<li><p><strong>CO:</strong> Convicted Offender</p></li>
<li><p><strong>AR:</strong> Arrestee</p></li>
<li><p><strong>COMB:</strong> Combined Total (all profiles)</p></li>
<li><p><strong>Counts + %:</strong> Both raw numbers and percentages were provided</p></li>
</ul>
</section>
</section>
<section id="prepare-combined-dataset" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="prepare-combined-dataset"><span class="header-section-number">2.5</span> Prepare Combined Dataset</h2>
<p>The goal of this step is to transform each state’s raw data into a standardized format before appending it to the master <code>foia_combined</code> DataFrame. This ensures consistency and enables seamless analysis across all seven states.</p>
<p>The ideal, standardized state dataset ready for combination must have the following columns:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Column Name</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Example Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong><code>state</code></strong></td>
<td style="text-align: left;">The name of the state.</td>
<td style="text-align: left;"><code>"California"</code>, <code>"Florida"</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>offender_type</code></strong></td>
<td style="text-align: left;">The category of offender profile.</td>
<td style="text-align: left;"><code>"Convicted Offender"</code>, <code>"Arrestee"</code>, <code>"Combined"</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>variable_category</code></strong></td>
<td style="text-align: left;">The broad demographic category.</td>
<td style="text-align: left;"><code>"race"</code>, <code>"gender"</code>, <code>"total"</code>, <code>"gender_race"</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>variable_detailed</code></strong></td>
<td style="text-align: left;">The specific value within the category.</td>
<td style="text-align: left;"><code>"White"</code>, <code>"Male"</code>, <code>"total_profiles"</code>, <code>"Male_White"</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>value</code></strong></td>
<td style="text-align: left;">The numerical value for the metric.</td>
<td style="text-align: left;"><code>150000</code>, <code>25.8</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong><code>value_type</code></strong></td>
<td style="text-align: left;">The type of metric the value represents.</td>
<td style="text-align: left;"><code>"count"</code>, <code>"percentage"</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong><code>value_source</code></strong></td>
<td style="text-align: left;">Whether the data was provided or derived.</td>
<td style="text-align: left;"><code>"reported"</code>, <code>"calculated"</code></td>
</tr>
</tbody>
</table>
<div class="cell">
<details class="code-fold">
<summary>Show the master foia_combined dataframe elaboration code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the master foia_combined dataframe with correct schema</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This empty structure ensures all state data is appended consistently</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>foia_combined <span class="ot">&lt;-</span> <span class="fu">tibble</span>( <span class="at">state =</span> <span class="fu">character</span>(),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="at">offender_type =</span> <span class="fu">character</span>(),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="at">variable_category =</span> <span class="fu">character</span>(),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="at">variable_detailed =</span> <span class="fu">character</span>(), </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="at">value =</span> <span class="fu">numeric</span>(),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="at">value_type =</span> <span class="fu">character</span>(),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="at">value_source =</span> <span class="fu">character</span>()</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data dictionary for foia_combined</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>schema_dict <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>Column,             <span class="sc">~</span>Type,        <span class="sc">~</span>Description, </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"state"</span>,             <span class="st">"character"</span>,  <span class="st">"'California', 'Florida'"</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"offender_type"</span>,     <span class="st">"character"</span>,  <span class="st">"'Convicted Offender', 'Arrestee', 'Combined'"</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"variable_category"</span>, <span class="st">"character"</span>,  <span class="st">"'race', 'gender', 'total', 'gender_race'"</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"variable_detailed"</span>, <span class="st">"character"</span>,  <span class="st">"'White', 'Male', 'total_profiles', 'Male_White'"</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"value"</span>,             <span class="st">"numeric"</span>,    <span class="st">"150000, 25.8"</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"value_type"</span>,        <span class="st">"character"</span>,  <span class="st">"'count', 'percentage'"</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"value_source"</span>,      <span class="st">"character"</span>,  <span class="st">"'reported', 'calculated'"</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn into a nice flextable</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(schema_dict) <span class="sc">%&gt;%</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">Column =</span> <span class="st">"Column Name"</span>,</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Type =</span> <span class="st">"Data Type"</span>,</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Description =</span> <span class="st">"Example Values to be added"</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-01c73d70{}.cl-01a476be{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-01bc85c4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-01bcb954{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb95e{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb95f{width:3.22in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb968{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb969{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb972{width:3.22in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb973{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb974{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb97c{width:3.22in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb97d{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb97e{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb986{width:3.22in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb987{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb990{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb991{width:3.22in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb99a{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb99b{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb9a4{width:3.22in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb9a5{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb9ae{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01bcb9af{width:3.22in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-01c73d70"><thead><tr style="overflow-wrap:break-word;"><th class="cl-01bcb954"><p class="cl-01bc85c4"><span class="cl-01a476be">Column Name</span></p></th><th class="cl-01bcb95e"><p class="cl-01bc85c4"><span class="cl-01a476be">Data Type</span></p></th><th class="cl-01bcb95f"><p class="cl-01bc85c4"><span class="cl-01a476be">Example Values to be added</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-01bcb968"><p class="cl-01bc85c4"><span class="cl-01a476be">state</span></p></td><td class="cl-01bcb969"><p class="cl-01bc85c4"><span class="cl-01a476be">character</span></p></td><td class="cl-01bcb972"><p class="cl-01bc85c4"><span class="cl-01a476be">'California', 'Florida'</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01bcb973"><p class="cl-01bc85c4"><span class="cl-01a476be">offender_type</span></p></td><td class="cl-01bcb974"><p class="cl-01bc85c4"><span class="cl-01a476be">character</span></p></td><td class="cl-01bcb97c"><p class="cl-01bc85c4"><span class="cl-01a476be">'Convicted Offender', 'Arrestee', 'Combined'</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01bcb97d"><p class="cl-01bc85c4"><span class="cl-01a476be">variable_category</span></p></td><td class="cl-01bcb97e"><p class="cl-01bc85c4"><span class="cl-01a476be">character</span></p></td><td class="cl-01bcb986"><p class="cl-01bc85c4"><span class="cl-01a476be">'race', 'gender', 'total', 'gender_race'</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01bcb987"><p class="cl-01bc85c4"><span class="cl-01a476be">variable_detailed</span></p></td><td class="cl-01bcb990"><p class="cl-01bc85c4"><span class="cl-01a476be">character</span></p></td><td class="cl-01bcb991"><p class="cl-01bc85c4"><span class="cl-01a476be">'White', 'Male', 'total_profiles', 'Male_White'</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01bcb99a"><p class="cl-01bc85c4"><span class="cl-01a476be">value</span></p></td><td class="cl-01bcb99b"><p class="cl-01bc85c4"><span class="cl-01a476be">numeric</span></p></td><td class="cl-01bcb9a4"><p class="cl-01bc85c4"><span class="cl-01a476be">150000, 25.8</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01bcb97d"><p class="cl-01bc85c4"><span class="cl-01a476be">value_type</span></p></td><td class="cl-01bcb97e"><p class="cl-01bc85c4"><span class="cl-01a476be">character</span></p></td><td class="cl-01bcb986"><p class="cl-01bc85c4"><span class="cl-01a476be">'count', 'percentage'</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01bcb9a5"><p class="cl-01bc85c4"><span class="cl-01a476be">value_source</span></p></td><td class="cl-01bcb9ae"><p class="cl-01bc85c4"><span class="cl-01a476be">character</span></p></td><td class="cl-01bcb9af"><p class="cl-01bc85c4"><span class="cl-01a476be">'reported', 'calculated'</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
<section id="prepare-metadata-documentation-table" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="prepare-metadata-documentation-table"><span class="header-section-number">2.6</span> Prepare Metadata Documentation Table</h2>
<p>This section creates a comprehensive metadata table (<strong><code>foia_state_metadata</code></strong>) to document the original content and structure of each state’s FOIA response <em>before</em> any processing or cleaning was applied.</p>
<p>This serves as a permanent record of data provenance, ensuring transparency and reproducibility by clearly distinguishing between what was <em>provided</em> by the states and what was <em>calculated</em> during analysis.</p>
<p><strong>Key Documentation Captured:</strong></p>
<ul>
<li><p><strong>Data Types Provided:</strong> Whether each state reported counts, percentages, or both for race, gender, and total profiles.</p></li>
<li><p><strong>Offender Categories Reported:</strong> Which offender types (Convicted Offender, Arrestee, Combined) were originally included.</p></li>
<li><p><strong>Demographic Granularity:</strong> Presence of ‘Unknown’ or ‘Other’ categories and gender-race cross-tabulations.</p></li>
<li><p><strong>Terminology &amp; Anomalies:</strong> Use of non-standard terms (e.g., “flags,” “offenders”) and other state-specific reporting notes.</p></li>
<li><p><strong>QC Results:</strong> Flags for whether cleaned data passes consistency checks (counts sum to totals, percentages sum to ~100%).</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the foia_state_metadata table elaboration code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the foia_state_metadata as a tibble (not a list of lists)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This makes it easier to add rows and ensures consistent structure.</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the full schema for our metadata table</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>foia_state_metadata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">character</span>(),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">race_data_provided =</span> <span class="fu">character</span>(),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">gender_data_provided =</span> <span class="fu">character</span>(),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_profiles_provided =</span> <span class="fu">character</span>(), </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">convicted_offender_reported =</span> <span class="fu">logical</span>(),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">arrestee_reported =</span> <span class="fu">logical</span>(),</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">combined_reported =</span> <span class="fu">logical</span>(),</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">has_unknown_category =</span> <span class="fu">logical</span>(),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">has_other_category =</span> <span class="fu">logical</span>(),</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">uses_nonstandard_terminology =</span> <span class="fu">logical</span>(),</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">provides_crosstabulation =</span> <span class="fu">logical</span>(),</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">counts_sum_to_total =</span> <span class="fu">logical</span>(),</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">percentages_sum_to_100 =</span> <span class="fu">logical</span>(),</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_calculated_combined =</span> <span class="fu">logical</span>(),</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">notes =</span> <span class="fu">character</span>()</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Build data dictionary for foia_state_metadata</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>schema_dict_meta <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>Column,                        <span class="sc">~</span>Type,       <span class="sc">~</span>Description,</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"state"</span>,                        <span class="st">"character"</span>, <span class="st">"State name (e.g., 'California', 'Florida')"</span>,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"race_data_provided"</span>,           <span class="st">"character"</span>, <span class="st">"Race data availability: 'counts', 'percentages', 'both', 'none'"</span>,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"gender_data_provided"</span>,         <span class="st">"character"</span>, <span class="st">"Gender data availability: 'counts', 'percentages', 'both', 'none'"</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"total_profiles_provided"</span>,      <span class="st">"character"</span>, <span class="st">"Total profiles availability: 'counts', 'percentages', 'both', 'none'"</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"convicted_offender_reported"</span>,  <span class="st">"logical"</span>,   <span class="st">"Was convicted offender data reported?"</span>,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"arrestee_reported"</span>,            <span class="st">"logical"</span>,   <span class="st">"Was arrestee data reported?"</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"combined_reported"</span>,            <span class="st">"logical"</span>,   <span class="st">"Was combined category reported?"</span>,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"has_unknown_category"</span>,         <span class="st">"logical"</span>,   <span class="st">"Does the state include 'Unknown' category?"</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"has_other_category"</span>,           <span class="st">"logical"</span>,   <span class="st">"Does the state include 'Other' category?"</span>,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"uses_nonstandard_terminology"</span>, <span class="st">"logical"</span>,   <span class="st">"Does the state use non-standard terms?"</span>,</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"provides_crosstabulation"</span>,     <span class="st">"logical"</span>,   <span class="st">"Does the state provide crosstabs (e.g., gender x race)?"</span>,</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"counts_sum_to_total"</span>,          <span class="st">"logical"</span>,   <span class="st">"Do reported counts sum to the total?"</span>,</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"percentages_sum_to_100"</span>,       <span class="st">"logical"</span>,   <span class="st">"Do reported percentages sum to ~100%?"</span>,</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="st">"total_calculated_combined"</span>,    <span class="st">"logical"</span>,   <span class="st">"Did we calculate combined total manually?"</span>,</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="st">"notes"</span>,                        <span class="st">"character"</span>, <span class="st">"Free-text notes for state-specific caveats"</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Render with flextable</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(schema_dict_meta) <span class="sc">%&gt;%</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">Column =</span> <span class="st">"Column Name"</span>,</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Type =</span> <span class="st">"Data Type"</span>,</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">Description =</span> <span class="st">"Meaning"</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-020511fe{}.cl-01f23a34{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-01f9b76e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-01f9ecca{width:2.417in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ecde{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ecdf{width:4.408in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ece8{width:2.417in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ecf2{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ecf3{width:4.408in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ecfc{width:2.417in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ecfd{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ed06{width:4.408in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ed10{width:2.417in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ed11{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ed12{width:4.408in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ed1a{width:2.417in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ed1b{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ed24{width:4.408in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ed25{width:2.417in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ed2e{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-01f9ed2f{width:4.408in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-020511fe"><thead><tr style="overflow-wrap:break-word;"><th class="cl-01f9ecca"><p class="cl-01f9b76e"><span class="cl-01f23a34">Column Name</span></p></th><th class="cl-01f9ecde"><p class="cl-01f9b76e"><span class="cl-01f23a34">Data Type</span></p></th><th class="cl-01f9ecdf"><p class="cl-01f9b76e"><span class="cl-01f23a34">Meaning</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-01f9ece8"><p class="cl-01f9b76e"><span class="cl-01f23a34">state</span></p></td><td class="cl-01f9ecf2"><p class="cl-01f9b76e"><span class="cl-01f23a34">character</span></p></td><td class="cl-01f9ecf3"><p class="cl-01f9b76e"><span class="cl-01f23a34">State name (e.g., 'California', 'Florida')</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ecfc"><p class="cl-01f9b76e"><span class="cl-01f23a34">race_data_provided</span></p></td><td class="cl-01f9ecfd"><p class="cl-01f9b76e"><span class="cl-01f23a34">character</span></p></td><td class="cl-01f9ed06"><p class="cl-01f9b76e"><span class="cl-01f23a34">Race data availability: 'counts', 'percentages', 'both', 'none'</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ece8"><p class="cl-01f9b76e"><span class="cl-01f23a34">gender_data_provided</span></p></td><td class="cl-01f9ecf2"><p class="cl-01f9b76e"><span class="cl-01f23a34">character</span></p></td><td class="cl-01f9ecf3"><p class="cl-01f9b76e"><span class="cl-01f23a34">Gender data availability: 'counts', 'percentages', 'both', 'none'</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ece8"><p class="cl-01f9b76e"><span class="cl-01f23a34">total_profiles_provided</span></p></td><td class="cl-01f9ecf2"><p class="cl-01f9b76e"><span class="cl-01f23a34">character</span></p></td><td class="cl-01f9ecf3"><p class="cl-01f9b76e"><span class="cl-01f23a34">Total profiles availability: 'counts', 'percentages', 'both', 'none'</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ed10"><p class="cl-01f9b76e"><span class="cl-01f23a34">convicted_offender_reported</span></p></td><td class="cl-01f9ed11"><p class="cl-01f9b76e"><span class="cl-01f23a34">logical</span></p></td><td class="cl-01f9ed12"><p class="cl-01f9b76e"><span class="cl-01f23a34">Was convicted offender data reported?</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ed10"><p class="cl-01f9b76e"><span class="cl-01f23a34">arrestee_reported</span></p></td><td class="cl-01f9ed11"><p class="cl-01f9b76e"><span class="cl-01f23a34">logical</span></p></td><td class="cl-01f9ed12"><p class="cl-01f9b76e"><span class="cl-01f23a34">Was arrestee data reported?</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ece8"><p class="cl-01f9b76e"><span class="cl-01f23a34">combined_reported</span></p></td><td class="cl-01f9ecf2"><p class="cl-01f9b76e"><span class="cl-01f23a34">logical</span></p></td><td class="cl-01f9ecf3"><p class="cl-01f9b76e"><span class="cl-01f23a34">Was combined category reported?</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ece8"><p class="cl-01f9b76e"><span class="cl-01f23a34">has_unknown_category</span></p></td><td class="cl-01f9ecf2"><p class="cl-01f9b76e"><span class="cl-01f23a34">logical</span></p></td><td class="cl-01f9ecf3"><p class="cl-01f9b76e"><span class="cl-01f23a34">Does the state include 'Unknown' category?</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ed1a"><p class="cl-01f9b76e"><span class="cl-01f23a34">has_other_category</span></p></td><td class="cl-01f9ed1b"><p class="cl-01f9b76e"><span class="cl-01f23a34">logical</span></p></td><td class="cl-01f9ed24"><p class="cl-01f9b76e"><span class="cl-01f23a34">Does the state include 'Other' category?</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ecfc"><p class="cl-01f9b76e"><span class="cl-01f23a34">uses_nonstandard_terminology</span></p></td><td class="cl-01f9ecfd"><p class="cl-01f9b76e"><span class="cl-01f23a34">logical</span></p></td><td class="cl-01f9ed06"><p class="cl-01f9b76e"><span class="cl-01f23a34">Does the state use non-standard terms?</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ece8"><p class="cl-01f9b76e"><span class="cl-01f23a34">provides_crosstabulation</span></p></td><td class="cl-01f9ecf2"><p class="cl-01f9b76e"><span class="cl-01f23a34">logical</span></p></td><td class="cl-01f9ecf3"><p class="cl-01f9b76e"><span class="cl-01f23a34">Does the state provide crosstabs (e.g., gender x race)?</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ed10"><p class="cl-01f9b76e"><span class="cl-01f23a34">counts_sum_to_total</span></p></td><td class="cl-01f9ed11"><p class="cl-01f9b76e"><span class="cl-01f23a34">logical</span></p></td><td class="cl-01f9ed12"><p class="cl-01f9b76e"><span class="cl-01f23a34">Do reported counts sum to the total?</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ece8"><p class="cl-01f9b76e"><span class="cl-01f23a34">percentages_sum_to_100</span></p></td><td class="cl-01f9ecf2"><p class="cl-01f9b76e"><span class="cl-01f23a34">logical</span></p></td><td class="cl-01f9ecf3"><p class="cl-01f9b76e"><span class="cl-01f23a34">Do reported percentages sum to ~100%?</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ece8"><p class="cl-01f9b76e"><span class="cl-01f23a34">total_calculated_combined</span></p></td><td class="cl-01f9ecf2"><p class="cl-01f9b76e"><span class="cl-01f23a34">logical</span></p></td><td class="cl-01f9ecf3"><p class="cl-01f9b76e"><span class="cl-01f23a34">Did we calculate combined total manually?</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-01f9ed25"><p class="cl-01f9b76e"><span class="cl-01f23a34">notes</span></p></td><td class="cl-01f9ed2e"><p class="cl-01f9b76e"><span class="cl-01f23a34">character</span></p></td><td class="cl-01f9ed2f"><p class="cl-01f9b76e"><span class="cl-01f23a34">Free-text notes for state-specific caveats</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>
</section>
<section id="state-by-state-standardization" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> State-by-state Standardization</h1>
<p>Each state is processed individually to standardize terminology, fill gaps, and calculate Combined totals where necessary.</p>
<section id="california-ca" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="california-ca"><span class="header-section-number">3.1</span> California (CA)</h2>
<p><strong>Overview</strong>: California supplies <strong>counts only</strong> for gender and race plus a separate total for each offender type; no percentages are reported.</p>
<section id="examine-raw-data" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="examine-raw-data"><span class="header-section-number">3.1.1</span> Examine Raw Data</h3>
<p>Establish a baseline understanding of the data exactly as it was received.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-02b5894e{table-layout:auto;width:100%;}.cl-028a402c{font-family:'Arial';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-028a4040{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-029fd4d2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-02a0b26c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b276{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b280{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b28a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b28b{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b294{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b295{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b29e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b29f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2a8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2a9{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2b2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2b3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2bc{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2bd{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2be{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2c6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2c7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2d0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2d1{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2da{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2e4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2e5{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2ee{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2ef{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2f0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b2f8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b302{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b303{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b30c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b316{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b317{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b320{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b32a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b32b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b334{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b335{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b33e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b33f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b348{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b349{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b352{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b353{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b35c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b35d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b366{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b370{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b371{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b37a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b37b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b384{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b385{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-02a0b38e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-02b5894e"><thead><tr style="overflow-wrap:break-word;"><th class="cl-02a0b26c"><p class="cl-029fd4d2"><span class="cl-028a402c">Column</span></p></th><th class="cl-02a0b276"><p class="cl-029fd4d2"><span class="cl-028a402c">Type</span></p></th><th class="cl-02a0b280"><p class="cl-029fd4d2"><span class="cl-028a402c">Rows</span></p></th><th class="cl-02a0b28a"><p class="cl-029fd4d2"><span class="cl-028a402c">Missing</span></p></th><th class="cl-02a0b28b"><p class="cl-029fd4d2"><span class="cl-028a402c">Unique</span></p></th><th class="cl-02a0b294"><p class="cl-029fd4d2"><span class="cl-028a402c">Unique_Values</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-02a0b295"><p class="cl-029fd4d2"><span class="cl-028a4040">state</span></p></td><td class="cl-02a0b29e"><p class="cl-029fd4d2"><span class="cl-028a4040">character</span></p></td><td class="cl-02a0b29f"><p class="cl-029fd4d2"><span class="cl-028a4040">16</span></p></td><td class="cl-02a0b2a8"><p class="cl-029fd4d2"><span class="cl-028a4040">0</span></p></td><td class="cl-02a0b2a9"><p class="cl-029fd4d2"><span class="cl-028a4040">1</span></p></td><td class="cl-02a0b2b2"><p class="cl-029fd4d2"><span class="cl-028a4040">California</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-02a0b2b3"><p class="cl-029fd4d2"><span class="cl-028a4040">offender_type</span></p></td><td class="cl-02a0b2bc"><p class="cl-029fd4d2"><span class="cl-028a4040">character</span></p></td><td class="cl-02a0b2bd"><p class="cl-029fd4d2"><span class="cl-028a4040">16</span></p></td><td class="cl-02a0b2be"><p class="cl-029fd4d2"><span class="cl-028a4040">0</span></p></td><td class="cl-02a0b2c6"><p class="cl-029fd4d2"><span class="cl-028a4040">2</span></p></td><td class="cl-02a0b2c7"><p class="cl-029fd4d2"><span class="cl-028a4040">Convicted Offender, Arrestee</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-02a0b2d0"><p class="cl-029fd4d2"><span class="cl-028a4040">variable_category</span></p></td><td class="cl-02a0b2d1"><p class="cl-029fd4d2"><span class="cl-028a4040">character</span></p></td><td class="cl-02a0b2da"><p class="cl-029fd4d2"><span class="cl-028a4040">16</span></p></td><td class="cl-02a0b2e4"><p class="cl-029fd4d2"><span class="cl-028a4040">0</span></p></td><td class="cl-02a0b2e5"><p class="cl-029fd4d2"><span class="cl-028a4040">3</span></p></td><td class="cl-02a0b2ee"><p class="cl-029fd4d2"><span class="cl-028a4040">total, gender, race</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-02a0b2ef"><p class="cl-029fd4d2"><span class="cl-028a4040">variable_detailed</span></p></td><td class="cl-02a0b2f0"><p class="cl-029fd4d2"><span class="cl-028a4040">character</span></p></td><td class="cl-02a0b2f8"><p class="cl-029fd4d2"><span class="cl-028a4040">16</span></p></td><td class="cl-02a0b302"><p class="cl-029fd4d2"><span class="cl-028a4040">0</span></p></td><td class="cl-02a0b303"><p class="cl-029fd4d2"><span class="cl-028a4040">8</span></p></td><td class="cl-02a0b30c"><p class="cl-029fd4d2"><span class="cl-028a4040">total_profiles, Female, Male, Unknown, African American, Caucasian, Hispanic, Asian</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-02a0b316"><p class="cl-029fd4d2"><span class="cl-028a4040">value</span></p></td><td class="cl-02a0b317"><p class="cl-029fd4d2"><span class="cl-028a4040">numeric</span></p></td><td class="cl-02a0b320"><p class="cl-029fd4d2"><span class="cl-028a4040">16</span></p></td><td class="cl-02a0b32a"><p class="cl-029fd4d2"><span class="cl-028a4040">0</span></p></td><td class="cl-02a0b32b"><p class="cl-029fd4d2"><span class="cl-028a4040">16</span></p></td><td class="cl-02a0b334"><p class="cl-029fd4d2"><span class="cl-028a4040">2019899 ..., 751822 ..., 309827 ..., 1603222 ..., 106850 ..., 208225 ..., 524231 ..., 19366 ..., 368952 ..., 588555 ...</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-02a0b335"><p class="cl-029fd4d2"><span class="cl-028a4040">value_type</span></p></td><td class="cl-02a0b33e"><p class="cl-029fd4d2"><span class="cl-028a4040">character</span></p></td><td class="cl-02a0b33f"><p class="cl-029fd4d2"><span class="cl-028a4040">16</span></p></td><td class="cl-02a0b2e4"><p class="cl-029fd4d2"><span class="cl-028a4040">0</span></p></td><td class="cl-02a0b348"><p class="cl-029fd4d2"><span class="cl-028a4040">1</span></p></td><td class="cl-02a0b349"><p class="cl-029fd4d2"><span class="cl-028a4040">count</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-02a0b352"><p class="cl-029fd4d2"><span class="cl-028a4040">value_source</span></p></td><td class="cl-02a0b353"><p class="cl-029fd4d2"><span class="cl-028a4040">character</span></p></td><td class="cl-02a0b35c"><p class="cl-029fd4d2"><span class="cl-028a4040">16</span></p></td><td class="cl-02a0b35d"><p class="cl-029fd4d2"><span class="cl-028a4040">0</span></p></td><td class="cl-02a0b366"><p class="cl-029fd4d2"><span class="cl-028a4040">1</span></p></td><td class="cl-02a0b370"><p class="cl-029fd4d2"><span class="cl-028a4040">reported</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-02a0b371"><p class="cl-029fd4d2"><span class="cl-028a4040">Data frame dimensions: 16 rows × 7 columns</span></p></td></tr></tfoot></table></div>
</div>
</div>
</section>
<section id="verify-data-consistency" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="verify-data-consistency"><span class="header-section-number">3.1.2</span> Verify Data Consistency</h3>
<p>Runs the first quality check using the <strong><code>verify_category_totals()</code></strong> and <strong><code>counts_consistent()</code></strong> functions.</p>
<p>This identifies any immediate discrepancies, such as the sum of demographic counts not matching the reported total profiles, which flags data issues that need to be resolved.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Verifying that demographic counts match reported totals:</code></pre>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">offender_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_profiles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Arrestee</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">751822</td>
<td style="text-align: right;">751822</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arrestee</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">751822</td>
<td style="text-align: right;">655695</td>
<td style="text-align: right;">96127</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Convicted Offender</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">2019899</td>
<td style="text-align: right;">2019899</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Convicted Offender</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">2019899</td>
<td style="text-align: right;">1626012</td>
<td style="text-align: right;">393887</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Counts consistency check on raw data:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>All counts consistent: FALSE </code></pre>
</div>
</div>
</section>
<section id="address-data-gaps" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="address-data-gaps"><span class="header-section-number">3.1.3</span> Address Data Gaps</h3>
<section id="create-unknown-category" class="level4" data-number="3.1.3.1">
<h4 data-number="3.1.3.1" class="anchored" data-anchor-id="create-unknown-category"><span class="header-section-number">3.1.3.1</span> Create Unknown Category</h4>
<blockquote class="blockquote">
<p><em>“Racial classification is not considered a required field on the collection card; thus, an unknown number of offenders may have <strong>no racial classification listed</strong>.”</em> — California DOJ FOIA letter, July 10 2018 (<strong><code>raw/foia_pdfs/FOIA_RacialComp_California.pdf</code></strong>)</p>
</blockquote>
<p>The 393,887 Convicted Offender profiles and 96,127 Arrestee profiles that do <strong>not</strong> appear in any of the four reported race categories must belong to an unreported “Unknown” category.</p>
<p>The calculated values are added with a <strong><code>value_source = "calculated"</code></strong> tag to maintain transparency about what was provided versus what was derived.</p>
<div class="cell">
<details class="code-fold">
<summary>Show unknown addition code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start with the raw data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ca_clean <span class="ot">&lt;-</span> ca_raw</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Unknown race category to reconcile totals</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>ca_clean <span class="ot">&lt;-</span> <span class="fu">fill_demographic_gaps</span>(ca_clean)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the fix</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Category totals after adding Unknown race category:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">verify_category_totals</span>(ca_clean) <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>()</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Counts consistency after adding Unknown:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"All counts consistent:"</span>, <span class="fu">counts_consistent</span>(ca_clean), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Category totals after adding Unknown race category:</code></pre>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">offender_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_profiles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Arrestee</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">751822</td>
<td style="text-align: right;">751822</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arrestee</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">751822</td>
<td style="text-align: right;">751822</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Convicted Offender</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">2019899</td>
<td style="text-align: right;">2019899</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Convicted Offender</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">2019899</td>
<td style="text-align: right;">2019899</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Counts consistency after adding Unknown:
All counts consistent: TRUE </code></pre>
</div>
</div>
</section>
<section id="create-combined-totals" class="level4" data-number="3.1.3.2">
<h4 data-number="3.1.3.2" class="anchored" data-anchor-id="create-combined-totals"><span class="header-section-number">3.1.3.2</span> Create Combined Totals</h4>
<p>Since California only reported data for “Convicted Offender” and “Arrestee” separately.</p>
<p>This step uses the <strong><code>add_combined()</code></strong> helper function to calculate a new “Combined” offender type by summing the counts from the other two categories.</p>
<div class="cell">
<details class="code-fold">
<summary>Show combined addition code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Combined totals using helper function</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ca_clean <span class="ot">&lt;-</span> <span class="fu">add_combined</span>(ca_clean)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Created Combined totals for California</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the Combined total</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>combined_total <span class="ot">&lt;-</span> ca_clean <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(offender_type <span class="sc">==</span> <span class="st">"Combined"</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>         variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>         variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(value)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Combined total profiles:"</span>, <span class="fu">format</span>(combined_total, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Created Combined totals for California
Combined total profiles: 2,771,721 </code></pre>
</div>
</div>
</section>
<section id="calculate-percentages" class="level4" data-number="3.1.3.3">
<h4 data-number="3.1.3.3" class="anchored" data-anchor-id="calculate-percentages"><span class="header-section-number">3.1.3.3</span> Calculate Percentages</h4>
<p>Transforms the data from counts into percentages for comparative analysis.</p>
<p>The <strong><code>add_percentages()</code></strong> helper function calculates each demographic group’s proportion relative to its offender type’s total.</p>
<p>A final consistency check ensures all percentages logically sum to approximately 100%.</p>
<div class="cell">
<details class="code-fold">
<summary>Show percentage calculation code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive percentages from counts</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>ca_clean <span class="ot">&lt;-</span> <span class="fu">add_percentages</span>(ca_clean)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Added percentages for all demographic categories</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Check percentage consistency</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Percentage consistency check:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"All percentages sum to ~100%:"</span>, <span class="fu">percentages_consistent</span>(ca_clean), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>))</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Show current data availability</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Final data availability:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Race data:"</span>, <span class="fu">report_status</span>(ca_clean, <span class="st">"race"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Gender data:"</span>, <span class="fu">report_status</span>(ca_clean, <span class="st">"gender"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Added percentages for all demographic categories
Percentage consistency check:
All percentages sum to ~100%: TRUE 

Final data availability:
Race data: both 
Gender data: both </code></pre>
</div>
</div>
</section>
<section id="standardize-terminology" class="level4" data-number="3.1.3.4">
<h4 data-number="3.1.3.4" class="anchored" data-anchor-id="standardize-terminology"><span class="header-section-number">3.1.3.4</span> Standardize Terminology</h4>
<p>California uses “African American” instead of “Black” and “Caucasian” instead of “White”.</p>
<div class="cell">
<details class="code-fold">
<summary>Show terminology standardization code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize racial terminology</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ca_clean <span class="ot">&lt;-</span> ca_clean <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable_detailed =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    variable_detailed <span class="sc">==</span> <span class="st">"African American"</span> <span class="sc">~</span> <span class="st">"Black"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> variable_detailed</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Standardized terminology: 'African American' → 'Black'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>ca_clean <span class="ot">&lt;-</span> ca_clean <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable_detailed =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    variable_detailed <span class="sc">==</span> <span class="st">"Caucasian"</span> <span class="sc">~</span> <span class="st">"White"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> variable_detailed</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Standardized terminology: 'Caucasian' → 'White'</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Standardized terminology: 'African American' → 'Black'
✓ Standardized terminology: 'Caucasian' → 'White'</code></pre>
</div>
</div>
</section>
</section>
<section id="prepare-for-combined-dataset" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="prepare-for-combined-dataset"><span class="header-section-number">3.1.4</span> Prepare for Combined Dataset</h3>
<p>The cleaned data is formatted to match the master schema and appended to the <code>foia_combined</code> dataframe.</p>
<div class="cell">
<details class="code-fold">
<summary>Show California data preparation to combined dataset</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the cleaned data for the combined dataset</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ca_prepared <span class="ot">&lt;-</span> <span class="fu">prepare_state_for_combined</span>(ca_clean, <span class="st">"California"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Append to the master combined dataframe</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>foia_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(foia_combined, ca_prepared)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Appended "</span>, <span class="fu">nrow</span>(ca_prepared), <span class="st">" California rows to foia_combined</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Total rows in foia_combined: "</span>, <span class="fu">nrow</span>(foia_combined), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Appended 51 California rows to foia_combined
✓ Total rows in foia_combined: 51</code></pre>
</div>
</div>
</section>
<section id="document-metadata" class="level3" data-number="3.1.5">
<h3 data-number="3.1.5" class="anchored" data-anchor-id="document-metadata"><span class="header-section-number">3.1.5</span> Document Metadata</h3>
<p>The metadata is added with the raw information and updated with the results of the quality checks and a note on the processing steps taken.</p>
<div class="cell">
<details class="code-fold">
<summary>Show California data preparation and addition to metadata table</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add California to the metadata table using the helper function</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add_state_metadata</span>(<span class="st">"California"</span>, ca_raw)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Update metadata with QC results</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">update_state_metadata</span>(<span class="st">"California"</span>, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">counts_ok =</span> <span class="fu">counts_consistent</span>(ca_clean),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">percentages_ok =</span> <span class="fu">percentages_consistent</span>(ca_clean),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">notes_text =</span> <span class="st">"Added Unknown race category to reconcile totals; calculated Combined totals and all percentages"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Metadata added for: California 
✓ Metadata updated for: California </code></pre>
</div>
</div>
</section>
<section id="visualizations" class="level3" data-number="3.1.6">
<h3 data-number="3.1.6" class="anchored" data-anchor-id="visualizations"><span class="header-section-number">3.1.6</span> Visualizations</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/ca-visualizations-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>California DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/ca-visualizations-2.png" class="img-fluid figure-img" width="768"></p>
<figcaption>California DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/ca-visualizations-3.png" class="img-fluid figure-img" width="768"></p>
<figcaption>California DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/ca-visualizations-4.png" class="img-fluid figure-img" width="768"></p>
<figcaption>California DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/ca-visualizations-5.png" class="img-fluid figure-img" width="768"></p>
<figcaption>California DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/ca-visualizations-6.png" class="img-fluid figure-img" width="768"></p>
<figcaption>California DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/ca-visualizations-7.png" class="img-fluid figure-img" width="768"></p>
<figcaption>California DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/ca-visualizations-8.png" class="img-fluid figure-img" width="768"></p>
<figcaption>California DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/ca-visualizations-9.png" class="img-fluid figure-img" width="768"></p>
<figcaption>California DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/ca-visualizations-10.png" class="img-fluid figure-img" width="768"></p>
<figcaption>California DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/ca-visualizations-11.png" class="img-fluid figure-img" width="768"></p>
<figcaption>California DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/ca-visualizations-12.png" class="img-fluid figure-img" width="768"></p>
<figcaption>California DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/ca-bar-charts-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>California Demographic Distributions by Offender Type</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-statistics" class="level3" data-number="3.1.7">
<h3 data-number="3.1.7" class="anchored" data-anchor-id="summary-statistics"><span class="header-section-number">3.1.7</span> Summary Statistics</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the summary statistics code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"California DNA Database Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"="</span>, <span class="fu">strrep</span>(<span class="st">"="</span>, <span class="dv">40</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total profiles by offender type</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"California"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>         variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>         variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>         value_type <span class="sc">==</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(offender_type, value) <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_formatted =</span> <span class="fu">format</span>(value, <span class="at">big.mark =</span> <span class="st">","</span>))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(totals)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Data completeness</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Data completeness:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>completeness <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"California"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(offender_type, value_source) <span class="sc">%&gt;%</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_values =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(completeness)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Final verification</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Final verification:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Counts consistent:"</span>, <span class="fu">counts_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"California"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Percentages consistent:"</span>, <span class="fu">percentages_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"California"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>California DNA Database Summary:
= ======================================== 
# A tibble: 3 × 3
  offender_type        value value_formatted
  &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;          
1 Convicted Offender 2019899 "2,019,899"    
2 Arrestee            751822 "  751,822"    
3 Combined           2771721 "2,771,721"    

Data completeness:
# A tibble: 5 × 3
  offender_type      value_source n_values
  &lt;chr&gt;              &lt;chr&gt;           &lt;int&gt;
1 Arrestee           calculated          9
2 Arrestee           reported            8
3 Combined           calculated         17
4 Convicted Offender calculated          9
5 Convicted Offender reported            8

Final verification:
Counts consistent: TRUE 
Percentages consistent: TRUE </code></pre>
</div>
</div>
</section>
<section id="summary-of-california-processing" class="level3" data-number="3.1.8">
<h3 data-number="3.1.8" class="anchored" data-anchor-id="summary-of-california-processing"><span class="header-section-number">3.1.8</span> Summary of California Processing</h3>
<p>California data processing complete. The dataset now includes:</p>
<ul>
<li><p>✅ <strong>Reported data</strong>: Counts for Convicted Offender and Arrestee</p></li>
<li><p>✅ <strong>Calculated additions</strong>:</p>
<ul>
<li><p>Unknown race category to reconcile reported totals</p></li>
<li><p>Combined totals across all offender types</p></li>
<li><p>Percentage values for all demographic categories</p></li>
<li><p>“Caucasian” and “African American” converted to “White” and “Black”.</p></li>
</ul></li>
<li><p>✅ <strong>Quality checks</strong>: All counts and percentages pass consistency validation</p></li>
<li><p>✅ <strong>Provenance tracking</strong>: All values include appropriate <strong><code>value_source</code></strong> indicators</p></li>
</ul>
<p>The California data is now standardized and ready for cross-state analysis.</p>
</section>
</section>
<section id="florida-fl" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="florida-fl"><span class="header-section-number">3.2</span> Florida (FL)</h2>
<p><strong>Overview</strong>: Florida provides <strong>both counts and percentages</strong> for gender and race categories and already includes a “Combined” total for all offender types, making it one of the most complete and straightforward datasets.</p>
<p>Only requires to standardize terminology for gender and race categories to match the common data model.</p>
<section id="examine-raw-data-1" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="examine-raw-data-1"><span class="header-section-number">3.2.1</span> Examine Raw Data</h3>
<p>Establish a baseline understanding of the data exactly as it was received.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-05b64caa{table-layout:auto;width:100%;}.cl-05a4cb6a{font-family:'Arial';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-05a4cb74{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-05aba4d0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-05abeb02{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb16{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb20{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb34{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb35{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb3e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb48{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb52{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb5c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb5d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb66{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb70{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb71{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb7a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb7b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb84{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb8e{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeb98{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeba2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abebac{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abebad{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abebb6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abebc0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abebc1{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abebca{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abebd4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abebde{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abebdf{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abebe8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abebf2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abebfc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec06{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec07{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec10{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec1a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec24{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec2e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec38{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec42{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec4c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec56{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec60{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec61{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec6a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec74{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec7e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec88{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec89{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec92{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec9c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abec9d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-05abeca6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-05b64caa"><thead><tr style="overflow-wrap:break-word;"><th class="cl-05abeb02"><p class="cl-05aba4d0"><span class="cl-05a4cb6a">Column</span></p></th><th class="cl-05abeb16"><p class="cl-05aba4d0"><span class="cl-05a4cb6a">Type</span></p></th><th class="cl-05abeb20"><p class="cl-05aba4d0"><span class="cl-05a4cb6a">Rows</span></p></th><th class="cl-05abeb34"><p class="cl-05aba4d0"><span class="cl-05a4cb6a">Missing</span></p></th><th class="cl-05abeb35"><p class="cl-05aba4d0"><span class="cl-05a4cb6a">Unique</span></p></th><th class="cl-05abeb3e"><p class="cl-05aba4d0"><span class="cl-05a4cb6a">Unique_Values</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-05abeb48"><p class="cl-05aba4d0"><span class="cl-05a4cb74">state</span></p></td><td class="cl-05abeb52"><p class="cl-05aba4d0"><span class="cl-05a4cb74">character</span></p></td><td class="cl-05abeb5c"><p class="cl-05aba4d0"><span class="cl-05a4cb74">22</span></p></td><td class="cl-05abeb5d"><p class="cl-05aba4d0"><span class="cl-05a4cb74">0</span></p></td><td class="cl-05abeb66"><p class="cl-05aba4d0"><span class="cl-05a4cb74">1</span></p></td><td class="cl-05abeb70"><p class="cl-05aba4d0"><span class="cl-05a4cb74">Florida</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-05abeb71"><p class="cl-05aba4d0"><span class="cl-05a4cb74">offender_type</span></p></td><td class="cl-05abeb7a"><p class="cl-05aba4d0"><span class="cl-05a4cb74">character</span></p></td><td class="cl-05abeb7b"><p class="cl-05aba4d0"><span class="cl-05a4cb74">22</span></p></td><td class="cl-05abeb84"><p class="cl-05aba4d0"><span class="cl-05a4cb74">0</span></p></td><td class="cl-05abeb8e"><p class="cl-05aba4d0"><span class="cl-05a4cb74">1</span></p></td><td class="cl-05abeb98"><p class="cl-05aba4d0"><span class="cl-05a4cb74">Combined</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-05abeba2"><p class="cl-05aba4d0"><span class="cl-05a4cb74">variable_category</span></p></td><td class="cl-05abebac"><p class="cl-05aba4d0"><span class="cl-05a4cb74">character</span></p></td><td class="cl-05abebad"><p class="cl-05aba4d0"><span class="cl-05a4cb74">22</span></p></td><td class="cl-05abebb6"><p class="cl-05aba4d0"><span class="cl-05a4cb74">0</span></p></td><td class="cl-05abebc0"><p class="cl-05aba4d0"><span class="cl-05a4cb74">3</span></p></td><td class="cl-05abebc1"><p class="cl-05aba4d0"><span class="cl-05a4cb74">total, gender, race</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-05abebca"><p class="cl-05aba4d0"><span class="cl-05a4cb74">variable_detailed</span></p></td><td class="cl-05abebd4"><p class="cl-05aba4d0"><span class="cl-05a4cb74">character</span></p></td><td class="cl-05abebde"><p class="cl-05aba4d0"><span class="cl-05a4cb74">22</span></p></td><td class="cl-05abebdf"><p class="cl-05aba4d0"><span class="cl-05a4cb74">0</span></p></td><td class="cl-05abebe8"><p class="cl-05aba4d0"><span class="cl-05a4cb74">10</span></p></td><td class="cl-05abebf2"><p class="cl-05aba4d0"><span class="cl-05a4cb74">total_profiles, Female, Male, Unknown, African American, Asian, Caucasian, Hispanic, Native American, Other</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-05abebfc"><p class="cl-05aba4d0"><span class="cl-05a4cb74">value</span></p></td><td class="cl-05abec06"><p class="cl-05aba4d0"><span class="cl-05a4cb74">numeric</span></p></td><td class="cl-05abec07"><p class="cl-05aba4d0"><span class="cl-05a4cb74">22</span></p></td><td class="cl-05abec10"><p class="cl-05aba4d0"><span class="cl-05a4cb74">0</span></p></td><td class="cl-05abec1a"><p class="cl-05aba4d0"><span class="cl-05a4cb74">22</span></p></td><td class="cl-05abec24"><p class="cl-05aba4d0"><span class="cl-05a4cb74">1175391 ..., 100 ..., 260885 ..., 22.2 ..., 901126 ..., 76.67 ..., 13380 ..., 1.14 ..., 413733 ..., 35.2 ...</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-05abec2e"><p class="cl-05aba4d0"><span class="cl-05a4cb74">value_type</span></p></td><td class="cl-05abec38"><p class="cl-05aba4d0"><span class="cl-05a4cb74">character</span></p></td><td class="cl-05abec42"><p class="cl-05aba4d0"><span class="cl-05a4cb74">22</span></p></td><td class="cl-05abebb6"><p class="cl-05aba4d0"><span class="cl-05a4cb74">0</span></p></td><td class="cl-05abebc0"><p class="cl-05aba4d0"><span class="cl-05a4cb74">2</span></p></td><td class="cl-05abec4c"><p class="cl-05aba4d0"><span class="cl-05a4cb74">count, percentage</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-05abec56"><p class="cl-05aba4d0"><span class="cl-05a4cb74">value_source</span></p></td><td class="cl-05abec60"><p class="cl-05aba4d0"><span class="cl-05a4cb74">character</span></p></td><td class="cl-05abec61"><p class="cl-05aba4d0"><span class="cl-05a4cb74">22</span></p></td><td class="cl-05abec6a"><p class="cl-05aba4d0"><span class="cl-05a4cb74">0</span></p></td><td class="cl-05abec74"><p class="cl-05aba4d0"><span class="cl-05a4cb74">1</span></p></td><td class="cl-05abec7e"><p class="cl-05aba4d0"><span class="cl-05a4cb74">reported</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-05abec88"><p class="cl-05aba4d0"><span class="cl-05a4cb74">Data frame dimensions: 22 rows × 7 columns</span></p></td></tr></tfoot></table></div>
</div>
</div>
</section>
<section id="verify-data-consistency-1" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="verify-data-consistency-1"><span class="header-section-number">3.2.2</span> Verify Data Consistency</h3>
<p>Runs the first quality check using the <strong><code>Verify_category_totals()</code></strong> and <strong><code>counts_consistent()</code></strong> functions.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Verifying that demographic counts match reported totals:</code></pre>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">offender_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_profiles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">1175391</td>
<td style="text-align: right;">1175391</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">1175391</td>
<td style="text-align: right;">1175391</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Counts consistency check on raw data:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>All counts consistent: TRUE </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentage consistency check on raw data:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>All percentages sum to ~100%: TRUE </code></pre>
</div>
</div>
</section>
<section id="address-data-gaps-1" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="address-data-gaps-1"><span class="header-section-number">3.2.3</span> Address Data Gaps</h3>
<section id="standardize-terminology-1" class="level4" data-number="3.2.3.1">
<h4 data-number="3.2.3.1" class="anchored" data-anchor-id="standardize-terminology-1"><span class="header-section-number">3.2.3.1</span> Standardize Terminology</h4>
<p>Florida uses “African American” instead of “Black” and “Caucasian” instead of “White”.</p>
<div class="cell">
<details class="code-fold">
<summary>Show terminology standardization code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fl_clean <span class="ot">&lt;-</span> fl_raw</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize racial terminology</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>fl_clean <span class="ot">&lt;-</span> fl_clean <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable_detailed =</span> <span class="fu">case_when</span>(</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    variable_detailed <span class="sc">==</span> <span class="st">"African American"</span> <span class="sc">~</span> <span class="st">"Black"</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> variable_detailed</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Standardized terminology: 'African American' → 'Black'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>fl_clean <span class="ot">&lt;-</span> fl_clean <span class="sc">%&gt;%</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable_detailed =</span> <span class="fu">case_when</span>(</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    variable_detailed <span class="sc">==</span> <span class="st">"Caucasian"</span> <span class="sc">~</span> <span class="st">"White"</span>,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> variable_detailed</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Standardized terminology: 'Caucasian' → 'White'</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Standardized terminology: 'African American' → 'Black'
✓ Standardized terminology: 'Caucasian' → 'White'</code></pre>
</div>
</div>
</section>
</section>
<section id="prepare-for-combined-dataset-1" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="prepare-for-combined-dataset-1"><span class="header-section-number">3.2.4</span> Prepare for Combined Dataset</h3>
<p>The Florida data is already complete and consistent. It is formatted to match the master schema and appended to the <code>foia_combined</code> dataframe.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Florida data preparation to combined dataset</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data for the combined dataset</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>fl_prepared <span class="ot">&lt;-</span> <span class="fu">prepare_state_for_combined</span>(fl_clean, <span class="st">"Florida"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Append to the master combined dataframe</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>foia_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(foia_combined, fl_prepared)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Appended "</span>, <span class="fu">nrow</span>(fl_prepared), <span class="st">" Florida rows to foia_combined</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Total rows in foia_combined: "</span>, <span class="fu">nrow</span>(foia_combined), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Appended 22 Florida rows to foia_combined
✓ Total rows in foia_combined: 73</code></pre>
</div>
</div>
</section>
<section id="document-metadata-1" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="document-metadata-1"><span class="header-section-number">3.2.5</span> Document Metadata</h3>
<p>The metadata is added with a note that the data was complete and required no processing.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Florida data preparation and addition to metadata table</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Florida to the metadata table using the helper function</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add_state_metadata</span>(<span class="st">"Florida"</span>, fl_raw)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Update metadata with QC results</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">update_state_metadata</span>(<span class="st">"Florida"</span>, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">counts_ok =</span> <span class="fu">counts_consistent</span>(fl_clean),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">percentages_ok =</span> <span class="fu">percentages_consistent</span>(fl_clean),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">notes_text =</span> <span class="st">"Complete dataset provided. No processing or calculations required. All values are reported."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Metadata added for: Florida 
✓ Metadata updated for: Florida </code></pre>
</div>
</div>
</section>
<section id="visualizations-1" class="level3" data-number="3.2.6">
<h3 data-number="3.2.6" class="anchored" data-anchor-id="visualizations-1"><span class="header-section-number">3.2.6</span> Visualizations</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/fl-visualizations-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Florida DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/fl-visualizations-2.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Florida DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/fl-visualizations-3.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Florida DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/fl-visualizations-4.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Florida DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-statistics-1" class="level3" data-number="3.2.7">
<h3 data-number="3.2.7" class="anchored" data-anchor-id="summary-statistics-1"><span class="header-section-number">3.2.7</span> Summary Statistics</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the summary statistics code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Florida DNA Database Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"="</span>, <span class="fu">strrep</span>(<span class="st">"="</span>, <span class="dv">40</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total profiles by offender type</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Florida"</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>         variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>         variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>         value_type <span class="sc">==</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(offender_type, value) <span class="sc">%&gt;%</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_formatted =</span> <span class="fu">format</span>(value, <span class="at">big.mark =</span> <span class="st">","</span>))</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(totals)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Data completeness</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Data completeness:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>completeness <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Florida"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(offender_type, value_source) <span class="sc">%&gt;%</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_values =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(completeness)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Final verification</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Final verification:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Counts consistent:"</span>, <span class="fu">counts_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Florida"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Percentages consistent:"</span>, <span class="fu">percentages_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Florida"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Florida DNA Database Summary:
= ======================================== 
# A tibble: 1 × 3
  offender_type   value value_formatted
  &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;          
1 Combined      1175391 1,175,391      

Data completeness:
# A tibble: 1 × 3
  offender_type value_source n_values
  &lt;chr&gt;         &lt;chr&gt;           &lt;int&gt;
1 Combined      reported           22

Final verification:
Counts consistent: TRUE 
Percentages consistent: TRUE </code></pre>
</div>
</div>
</section>
<section id="summary-of-florida-processing" class="level3" data-number="3.2.8">
<h3 data-number="3.2.8" class="anchored" data-anchor-id="summary-of-florida-processing"><span class="header-section-number">3.2.8</span> Summary of Florida Processing</h3>
<p>Florida data processing complete. The dataset is exemplary and required no adjustments:</p>
<ul>
<li><p>✅ <strong>Reported data</strong>: Both <strong>counts and percentages</strong> for all Convicted Offender, Arrestee, and Combined categories.</p></li>
<li><p>✅ <strong>Terminology standardization</strong>: “Caucasian” and “African American” converted to “White” and “Black”.</p></li>
<li><p>✅ <strong>No calculated additions needed</strong>: All values are sourced directly from the state report (<strong><code>value_source = "reported"</code></strong>).</p></li>
<li><p>✅ <strong>Quality checks</strong>: All counts and percentages pass consistency validation.</p></li>
<li><p>✅ <strong>Provenance tracking</strong>: All values maintain their original <strong><code>value_source</code></strong> as “reported”.</p></li>
</ul>
<p>The Florida data is now standardized and ready for cross-state analysis.</p>
</section>
</section>
<section id="indiana-in" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="indiana-in"><span class="header-section-number">3.3</span> Indiana (IN)</h2>
<p><strong>Overview</strong>: Indiana presents a unique reporting pattern where total counts are provided by offender type, but demographic breakdowns are given only as percentages for the Combined total.</p>
<p>Values were provided as strings, including a “&lt;1” notation, requiring conversion.</p>
<section id="examine-raw-data-2" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="examine-raw-data-2"><span class="header-section-number">3.3.1</span> Examine Raw Data</h3>
<p>Establish a baseline understanding of the data exactly as it was received.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-06cf40ba{table-layout:auto;width:100%;}.cl-06be5d36{font-family:'Arial';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-06be5d40{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-06c51018{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-06c544e8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c544f2{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c544fc{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54506{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54507{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54510{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54511{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54512{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5451a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5451b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5451c{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54524{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54525{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5452e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5452f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54538{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54539{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5453a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54542{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54543{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54544{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5454c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5454d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54556{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54557{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54558{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54560{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5456a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5456b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5456c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54574{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54575{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5457e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5457f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54588{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54589{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54592{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c54593{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5459c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c5459d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c545a6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c545a7{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c545b0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c545b1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c545b2{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c545ba{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c545bb{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c545bc{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c545c4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c545c5{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c545ce{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-06c545cf{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-06cf40ba"><thead><tr style="overflow-wrap:break-word;"><th class="cl-06c544e8"><p class="cl-06c51018"><span class="cl-06be5d36">Column</span></p></th><th class="cl-06c544f2"><p class="cl-06c51018"><span class="cl-06be5d36">Type</span></p></th><th class="cl-06c544fc"><p class="cl-06c51018"><span class="cl-06be5d36">Rows</span></p></th><th class="cl-06c54506"><p class="cl-06c51018"><span class="cl-06be5d36">Missing</span></p></th><th class="cl-06c54507"><p class="cl-06c51018"><span class="cl-06be5d36">Unique</span></p></th><th class="cl-06c54510"><p class="cl-06c51018"><span class="cl-06be5d36">Unique_Values</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-06c54511"><p class="cl-06c51018"><span class="cl-06be5d40">state</span></p></td><td class="cl-06c54512"><p class="cl-06c51018"><span class="cl-06be5d40">character</span></p></td><td class="cl-06c5451a"><p class="cl-06c51018"><span class="cl-06be5d40">8</span></p></td><td class="cl-06c5451b"><p class="cl-06c51018"><span class="cl-06be5d40">0</span></p></td><td class="cl-06c5451c"><p class="cl-06c51018"><span class="cl-06be5d40">1</span></p></td><td class="cl-06c54524"><p class="cl-06c51018"><span class="cl-06be5d40">Indiana</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-06c54525"><p class="cl-06c51018"><span class="cl-06be5d40">offender_type</span></p></td><td class="cl-06c5452e"><p class="cl-06c51018"><span class="cl-06be5d40">character</span></p></td><td class="cl-06c5452f"><p class="cl-06c51018"><span class="cl-06be5d40">8</span></p></td><td class="cl-06c54538"><p class="cl-06c51018"><span class="cl-06be5d40">0</span></p></td><td class="cl-06c54539"><p class="cl-06c51018"><span class="cl-06be5d40">3</span></p></td><td class="cl-06c5453a"><p class="cl-06c51018"><span class="cl-06be5d40">Convicted Offender, Arrestee, Combined</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-06c54542"><p class="cl-06c51018"><span class="cl-06be5d40">variable_category</span></p></td><td class="cl-06c54543"><p class="cl-06c51018"><span class="cl-06be5d40">character</span></p></td><td class="cl-06c54544"><p class="cl-06c51018"><span class="cl-06be5d40">8</span></p></td><td class="cl-06c5454c"><p class="cl-06c51018"><span class="cl-06be5d40">0</span></p></td><td class="cl-06c5454d"><p class="cl-06c51018"><span class="cl-06be5d40">3</span></p></td><td class="cl-06c54556"><p class="cl-06c51018"><span class="cl-06be5d40">total, gender, race</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-06c54557"><p class="cl-06c51018"><span class="cl-06be5d40">variable_detailed</span></p></td><td class="cl-06c54558"><p class="cl-06c51018"><span class="cl-06be5d40">character</span></p></td><td class="cl-06c54560"><p class="cl-06c51018"><span class="cl-06be5d40">8</span></p></td><td class="cl-06c5456a"><p class="cl-06c51018"><span class="cl-06be5d40">0</span></p></td><td class="cl-06c5456b"><p class="cl-06c51018"><span class="cl-06be5d40">7</span></p></td><td class="cl-06c5456c"><p class="cl-06c51018"><span class="cl-06be5d40">total_profiles, Female, Male, Caucasian, Black, Hispanic, Other</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-06c54574"><p class="cl-06c51018"><span class="cl-06be5d40">value</span></p></td><td class="cl-06c54575"><p class="cl-06c51018"><span class="cl-06be5d40">numeric</span></p></td><td class="cl-06c5457e"><p class="cl-06c51018"><span class="cl-06be5d40">8</span></p></td><td class="cl-06c5457f"><p class="cl-06c51018"><span class="cl-06be5d40">0</span></p></td><td class="cl-06c54588"><p class="cl-06c51018"><span class="cl-06be5d40">8</span></p></td><td class="cl-06c54589"><p class="cl-06c51018"><span class="cl-06be5d40">279654, 21087, 20, 80, 70, 26, 4, 0.5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-06c54592"><p class="cl-06c51018"><span class="cl-06be5d40">value_type</span></p></td><td class="cl-06c54593"><p class="cl-06c51018"><span class="cl-06be5d40">character</span></p></td><td class="cl-06c5459c"><p class="cl-06c51018"><span class="cl-06be5d40">8</span></p></td><td class="cl-06c5454c"><p class="cl-06c51018"><span class="cl-06be5d40">0</span></p></td><td class="cl-06c5454d"><p class="cl-06c51018"><span class="cl-06be5d40">2</span></p></td><td class="cl-06c5459d"><p class="cl-06c51018"><span class="cl-06be5d40">count, percentage</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-06c545a6"><p class="cl-06c51018"><span class="cl-06be5d40">value_source</span></p></td><td class="cl-06c545a7"><p class="cl-06c51018"><span class="cl-06be5d40">character</span></p></td><td class="cl-06c545b0"><p class="cl-06c51018"><span class="cl-06be5d40">8</span></p></td><td class="cl-06c545b1"><p class="cl-06c51018"><span class="cl-06be5d40">0</span></p></td><td class="cl-06c545b2"><p class="cl-06c51018"><span class="cl-06be5d40">1</span></p></td><td class="cl-06c545ba"><p class="cl-06c51018"><span class="cl-06be5d40">reported</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-06c545bb"><p class="cl-06c51018"><span class="cl-06be5d40">Data frame dimensions: 8 rows × 7 columns</span></p></td></tr></tfoot></table></div>
</div>
</div>
</section>
<section id="verify-data-consistency-2" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="verify-data-consistency-2"><span class="header-section-number">3.3.2</span> Verify Data Consistency</h3>
<p>Initial checks reveal Indiana’s unique structure: counts for totals, percentages only for Combined demographics.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Initial data availability:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Race data: percentages </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Gender data: percentages </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Value types in raw data:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>count, percentage</code></pre>
</div>
</div>
</section>
<section id="address-data-gaps-2" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="address-data-gaps-2"><span class="header-section-number">3.3.3</span> Address Data Gaps</h3>
<section id="convert-string-values-to-numeric" class="level4" data-number="3.3.3.1">
<h4 data-number="3.3.3.1" class="anchored" data-anchor-id="convert-string-values-to-numeric"><span class="header-section-number">3.3.3.1</span> Convert String Values to Numeric</h4>
<p>The raw data contains string values including “&lt;1” which we convert to 0.5.</p>
<div class="cell">
<details class="code-fold">
<summary>Show value conversion code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start with raw data</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>in_clean <span class="ot">&lt;-</span> in_raw</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert string values to numeric, handling "&lt;1" as 1</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>in_clean<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">sapply</span>(in_clean<span class="sc">$</span>value, <span class="cf">function</span>(x) {</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"&lt;1"</span>) {</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.5</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(x)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Update value_type for converted percentages</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>in_clean <span class="ot">&lt;-</span> in_clean <span class="sc">%&gt;%</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_type =</span> <span class="fu">ifelse</span>(value_type <span class="sc">==</span> <span class="st">"percentage"</span>, <span class="st">"percentage"</span>, value_type))</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Converted Indiana values from String to numeric</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Unique values after conversion:"</span>, <span class="fu">paste</span>(<span class="fu">unique</span>(in_clean<span class="sc">$</span>value), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Converted Indiana values from String to numeric
Unique values after conversion: 279654, 21087, 20, 80, 70, 26, 4, 0.5 </code></pre>
</div>
</div>
</section>
<section id="solve-percentages-inconsistency" class="level4" data-number="3.3.3.2">
<h4 data-number="3.3.3.2" class="anchored" data-anchor-id="solve-percentages-inconsistency"><span class="header-section-number">3.3.3.2</span> Solve Percentages Inconsistency</h4>
<p>Racial percentages summed to 100.5% instead of 100%</p>
<p>Proportional scaling was applied and <code>value_source</code> was updated to “calculated” for all adjusted values.</p>
<div class="cell">
<details class="code-fold">
<summary>Show percentage recalculation code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust percentages to ensure they sum to 100% and mark as calculated</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>in_clean <span class="ot">&lt;-</span> in_clean <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(value_type, variable_category) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">ifelse</span>(</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>      value_type <span class="sc">==</span> <span class="st">"percentage"</span> <span class="sc">&amp;</span> variable_category <span class="sc">==</span> <span class="st">"race"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>      value <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">/</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>      value</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_source =</span> <span class="fu">ifelse</span>(</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>      value_type <span class="sc">==</span> <span class="st">"percentage"</span> <span class="sc">&amp;</span> variable_category <span class="sc">==</span> <span class="st">"race"</span>,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"calculated"</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>      value_source</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the new sum</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>percentage_sum <span class="ot">&lt;-</span> in_clean <span class="sc">%&gt;%</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(value_type <span class="sc">==</span> <span class="st">"percentage"</span> <span class="sc">&amp;</span> variable_category <span class="sc">==</span> <span class="st">"race"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Recalculated percentages for Indiana - New sum:"</span>, percentage_sum<span class="sc">$</span>total, <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Recalculated percentages for Indiana - New sum: 100 %</code></pre>
</div>
</div>
</section>
<section id="standardize-terminology-2" class="level4" data-number="3.3.3.3">
<h4 data-number="3.3.3.3" class="anchored" data-anchor-id="standardize-terminology-2"><span class="header-section-number">3.3.3.3</span> Standardize Terminology</h4>
<p>Indiana uses “Caucasian” instead of “White”.</p>
<div class="cell">
<details class="code-fold">
<summary>Show terminology standardization code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize racial terminology</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>in_clean <span class="ot">&lt;-</span> in_clean <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable_detailed =</span> <span class="fu">case_when</span>(</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    variable_detailed <span class="sc">==</span> <span class="st">"Caucasian"</span> <span class="sc">~</span> <span class="st">"White"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> variable_detailed</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Standardized terminology: 'Caucasian' → 'White'</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Standardized terminology: 'Caucasian' → 'White'</code></pre>
</div>
</div>
</section>
<section id="create-combined-total-profiles" class="level4" data-number="3.3.3.4">
<h4 data-number="3.3.3.4" class="anchored" data-anchor-id="create-combined-total-profiles"><span class="header-section-number">3.3.3.4</span> Create Combined Total Profiles</h4>
<p>Indiana provides separate totals for Convicted Offenders and Arrestees, but we need a Combined total to match the demographic percentages.</p>
<div class="cell">
<details class="code-fold">
<summary>Show combined total calculation code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Combined total from separate offender type totals</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>convicted_total <span class="ot">&lt;-</span> in_clean <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(offender_type <span class="sc">==</span> <span class="st">"Convicted Offender"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>         variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>         variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(value)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>arrestee_total <span class="ot">&lt;-</span> in_clean <span class="sc">%&gt;%</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(offender_type <span class="sc">==</span> <span class="st">"Arrestee"</span>,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>         variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>         variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(value)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>combined_total <span class="ot">&lt;-</span> convicted_total <span class="sc">+</span> arrestee_total</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Combined total to the data</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>combined_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"Indiana"</span>,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">offender_type =</span> <span class="st">"Combined"</span>,</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable_category =</span> <span class="st">"total"</span>,</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable_detailed =</span> <span class="st">"total_profiles"</span>,</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> combined_total,</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">value_type =</span> <span class="st">"count"</span>,</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">value_source =</span> <span class="st">"calculated"</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>in_clean <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(in_clean, combined_row)</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Combined total profiles:"</span>, <span class="fu">format</span>(combined_total, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Added Combined total profiles</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Combined total profiles: 300,741 
✓ Added Combined total profiles</code></pre>
</div>
</div>
</section>
<section id="calculate-counts-from-percentages" class="level4" data-number="3.3.3.5">
<h4 data-number="3.3.3.5" class="anchored" data-anchor-id="calculate-counts-from-percentages"><span class="header-section-number">3.3.3.5</span> Calculate Counts from Percentages</h4>
<p>Indiana only provides percentages for demographic categories. We calculate the actual counts using the Combined total.</p>
<div class="cell">
<details class="code-fold">
<summary>Show count calculation code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts from percentages for Combined offender type</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>in_clean <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(in_clean, <span class="fu">calculate_counts_from_percentages</span>(in_clean, <span class="st">"Indiana"</span>))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Calculated demographic counts from percentages</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the calculations</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Category totals after calculating counts:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">verify_category_totals</span>(in_clean) <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Calculated demographic counts from percentages
Category totals after calculating counts:</code></pre>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">offender_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_profiles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">300741</td>
<td style="text-align: right;">300741</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">300741</td>
<td style="text-align: right;">300741</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="verify-data-consistency-3" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="verify-data-consistency-3"><span class="header-section-number">3.3.4</span> Verify Data Consistency</h3>
<p>Final checks to ensure all data is now consistent and complete.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Final data consistency checks:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Counts consistent: TRUE </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentages consistent: TRUE </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Final data availability:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Race data: both </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Gender data: both </code></pre>
</div>
</div>
</section>
<section id="prepare-for-combined-dataset-2" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="prepare-for-combined-dataset-2"><span class="header-section-number">3.3.5</span> Prepare for Combined Dataset</h3>
<p>The cleaned data is formatted to match the master schema and appended to the <code>foia_combined</code> dataframe.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Indiana data preparation to combined dataset</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the cleaned data for the combined dataset</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>in_prepared <span class="ot">&lt;-</span> <span class="fu">prepare_state_for_combined</span>(in_clean, <span class="st">"Indiana"</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Append to the master combined dataframe</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>foia_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(foia_combined, in_prepared)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Appended "</span>, <span class="fu">nrow</span>(in_prepared), <span class="st">" Indiana rows to foia_combined</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Total rows in foia_combined: "</span>, <span class="fu">nrow</span>(foia_combined), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Appended 15 Indiana rows to foia_combined
✓ Total rows in foia_combined: 88</code></pre>
</div>
</div>
</section>
<section id="document-metadata-2" class="level3" data-number="3.3.6">
<h3 data-number="3.3.6" class="anchored" data-anchor-id="document-metadata-2"><span class="header-section-number">3.3.6</span> Document Metadata</h3>
<p>The metadata is added with details on all processing steps performed.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Indiana data preparation and addition to metadata table</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Indiana to the metadata table using the helper function</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add_state_metadata</span>(<span class="st">"Indiana"</span>, in_raw)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Update metadata with QC results and processing notes</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">update_state_metadata</span>(<span class="st">"Indiana"</span>, </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">counts_ok =</span> <span class="fu">counts_consistent</span>(in_clean),</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">percentages_ok =</span> <span class="fu">percentages_consistent</span>(in_clean),</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">notes_text =</span> <span class="st">"Converted string values to numeric; standardized 'Black' to 'African American'; calculated Combined total profiles; derived all demographic counts from reported percentages"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Metadata added for: Indiana 
✓ Metadata updated for: Indiana </code></pre>
</div>
</div>
</section>
<section id="visualizations-2" class="level3" data-number="3.3.7">
<h3 data-number="3.3.7" class="anchored" data-anchor-id="visualizations-2"><span class="header-section-number">3.3.7</span> Visualizations</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/in-visualizations-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Indiana DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/in-visualizations-2.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Indiana DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/in-visualizations-3.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Indiana DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/in-visualizations-4.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Indiana DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-statistics-2" class="level3" data-number="3.3.8">
<h3 data-number="3.3.8" class="anchored" data-anchor-id="summary-statistics-2"><span class="header-section-number">3.3.8</span> Summary Statistics</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the summary statistics code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Indiana DNA Database Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"="</span>, <span class="fu">strrep</span>(<span class="st">"="</span>, <span class="dv">40</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total profiles by offender type</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Indiana"</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>         variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>         variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>         value_type <span class="sc">==</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(offender_type, value, value_source) <span class="sc">%&gt;%</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_formatted =</span> <span class="fu">format</span>(value, <span class="at">big.mark =</span> <span class="st">","</span>))</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(totals)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Data completeness by value source</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Data completeness by source:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>completeness <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Indiana"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(value_source) <span class="sc">%&gt;%</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_values =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(completeness)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Final verification</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Final verification:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Counts consistent:"</span>, <span class="fu">counts_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Indiana"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Percentages consistent:"</span>, <span class="fu">percentages_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Indiana"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Indiana DNA Database Summary:
= ======================================== 
# A tibble: 3 × 4
  offender_type       value value_source value_formatted
  &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;          
1 Convicted Offender 279654 reported     "279,654"      
2 Arrestee            21087 reported     " 21,087"      
3 Combined           300741 calculated   "300,741"      

Data completeness by source:
# A tibble: 2 × 2
  value_source n_values
  &lt;chr&gt;           &lt;int&gt;
1 calculated         11
2 reported            4

Final verification:
Counts consistent: TRUE 
Percentages consistent: TRUE </code></pre>
</div>
</div>
</section>
<section id="summary-of-indiana-processing" class="level3" data-number="3.3.9">
<h3 data-number="3.3.9" class="anchored" data-anchor-id="summary-of-indiana-processing"><span class="header-section-number">3.3.9</span> Summary of Indiana Processing</h3>
<p>Indiana data processing complete. The unique dataset required:</p>
<ul>
<li><p>✅ <strong>Data conversion</strong>: String values converted to numeric, handling “&lt;1” as 0.5</p></li>
<li><p>✅ <strong>Terminology standardization</strong>: “Caucasian” converted to “White”</p></li>
<li><p>✅ <strong>Calculated additions</strong>:</p>
<ul>
<li><p>Combined total profiles across offender types</p></li>
<li><p>All demographic counts derived from reported percentages</p></li>
</ul></li>
<li><p>✅ <strong>Quality checks</strong>: All counts and percentages pass consistency validation</p></li>
<li><p>✅ <strong>Provenance tracking</strong>: Clear distinction between reported and calculated values</p></li>
</ul>
<p>The Indiana data is now standardized and ready for cross-state analysis.</p>
</section>
</section>
<section id="maine-me" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="maine-me"><span class="header-section-number">3.4</span> Maine (ME)</h2>
<p><strong>Overview</strong>: Maine provides comprehensive reporting with <strong>both counts and percentages</strong> for all gender and race categories across all offender types, including pre-calculated Combined totals. The data is complete and requires no processing.</p>
<section id="examine-raw-data-3" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="examine-raw-data-3"><span class="header-section-number">3.4.1</span> Examine Raw Data</h3>
<p>Establish a baseline understanding of the data exactly as it was received.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-07ff5902{table-layout:auto;width:100%;}.cl-07edb30a{font-family:'Arial';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-07edb31e{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-07f459ee{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-07f48ef0{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48efa{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48efb{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f04{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f05{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f0e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f0f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f18{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f19{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f22{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f23{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f2c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f2d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f2e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f36{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f37{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f38{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f40{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f4a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f4b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f54{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f55{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f56{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f5e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f5f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f68{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f72{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f73{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f74{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f7c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f86{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f87{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f88{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f90{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f91{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f92{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48f9a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fa4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fa5{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fae{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48faf{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fb8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fb9{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fc2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fc3{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fcc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fcd{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fce{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fd6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fd7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fe0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-07f48fe1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-07ff5902"><thead><tr style="overflow-wrap:break-word;"><th class="cl-07f48ef0"><p class="cl-07f459ee"><span class="cl-07edb30a">Column</span></p></th><th class="cl-07f48efa"><p class="cl-07f459ee"><span class="cl-07edb30a">Type</span></p></th><th class="cl-07f48efb"><p class="cl-07f459ee"><span class="cl-07edb30a">Rows</span></p></th><th class="cl-07f48f04"><p class="cl-07f459ee"><span class="cl-07edb30a">Missing</span></p></th><th class="cl-07f48f05"><p class="cl-07f459ee"><span class="cl-07edb30a">Unique</span></p></th><th class="cl-07f48f0e"><p class="cl-07f459ee"><span class="cl-07edb30a">Unique_Values</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-07f48f0f"><p class="cl-07f459ee"><span class="cl-07edb31e">state</span></p></td><td class="cl-07f48f18"><p class="cl-07f459ee"><span class="cl-07edb31e">character</span></p></td><td class="cl-07f48f19"><p class="cl-07f459ee"><span class="cl-07edb31e">19</span></p></td><td class="cl-07f48f22"><p class="cl-07f459ee"><span class="cl-07edb31e">0</span></p></td><td class="cl-07f48f23"><p class="cl-07f459ee"><span class="cl-07edb31e">1</span></p></td><td class="cl-07f48f2c"><p class="cl-07f459ee"><span class="cl-07edb31e">Maine</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-07f48f2d"><p class="cl-07f459ee"><span class="cl-07edb31e">offender_type</span></p></td><td class="cl-07f48f2e"><p class="cl-07f459ee"><span class="cl-07edb31e">character</span></p></td><td class="cl-07f48f36"><p class="cl-07f459ee"><span class="cl-07edb31e">19</span></p></td><td class="cl-07f48f37"><p class="cl-07f459ee"><span class="cl-07edb31e">0</span></p></td><td class="cl-07f48f38"><p class="cl-07f459ee"><span class="cl-07edb31e">1</span></p></td><td class="cl-07f48f40"><p class="cl-07f459ee"><span class="cl-07edb31e">Combined</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-07f48f4a"><p class="cl-07f459ee"><span class="cl-07edb31e">variable_category</span></p></td><td class="cl-07f48f4b"><p class="cl-07f459ee"><span class="cl-07edb31e">character</span></p></td><td class="cl-07f48f54"><p class="cl-07f459ee"><span class="cl-07edb31e">19</span></p></td><td class="cl-07f48f55"><p class="cl-07f459ee"><span class="cl-07edb31e">0</span></p></td><td class="cl-07f48f56"><p class="cl-07f459ee"><span class="cl-07edb31e">3</span></p></td><td class="cl-07f48f5e"><p class="cl-07f459ee"><span class="cl-07edb31e">total, gender, race</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-07f48f5f"><p class="cl-07f459ee"><span class="cl-07edb31e">variable_detailed</span></p></td><td class="cl-07f48f68"><p class="cl-07f459ee"><span class="cl-07edb31e">character</span></p></td><td class="cl-07f48f72"><p class="cl-07f459ee"><span class="cl-07edb31e">19</span></p></td><td class="cl-07f48f73"><p class="cl-07f459ee"><span class="cl-07edb31e">0</span></p></td><td class="cl-07f48f74"><p class="cl-07f459ee"><span class="cl-07edb31e">9</span></p></td><td class="cl-07f48f7c"><p class="cl-07f459ee"><span class="cl-07edb31e">total_profiles, Male, Female, Unknown, White, Black, Native American, Hispanic, Asian</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-07f48f86"><p class="cl-07f459ee"><span class="cl-07edb31e">value</span></p></td><td class="cl-07f48f87"><p class="cl-07f459ee"><span class="cl-07edb31e">numeric</span></p></td><td class="cl-07f48f88"><p class="cl-07f459ee"><span class="cl-07edb31e">19</span></p></td><td class="cl-07f48f90"><p class="cl-07f459ee"><span class="cl-07edb31e">0</span></p></td><td class="cl-07f48f91"><p class="cl-07f459ee"><span class="cl-07edb31e">19</span></p></td><td class="cl-07f48f92"><p class="cl-07f459ee"><span class="cl-07edb31e">33711 ..., 27694 ..., 82.7 ..., 5734 ..., 17 ..., 83 ..., 0.2 ..., 31298 ..., 92.8 ..., 1299 ...</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-07f48f9a"><p class="cl-07f459ee"><span class="cl-07edb31e">value_type</span></p></td><td class="cl-07f48fa4"><p class="cl-07f459ee"><span class="cl-07edb31e">character</span></p></td><td class="cl-07f48fa5"><p class="cl-07f459ee"><span class="cl-07edb31e">19</span></p></td><td class="cl-07f48f55"><p class="cl-07f459ee"><span class="cl-07edb31e">0</span></p></td><td class="cl-07f48f56"><p class="cl-07f459ee"><span class="cl-07edb31e">2</span></p></td><td class="cl-07f48fae"><p class="cl-07f459ee"><span class="cl-07edb31e">count, percentage</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-07f48faf"><p class="cl-07f459ee"><span class="cl-07edb31e">value_source</span></p></td><td class="cl-07f48fb8"><p class="cl-07f459ee"><span class="cl-07edb31e">character</span></p></td><td class="cl-07f48fb9"><p class="cl-07f459ee"><span class="cl-07edb31e">19</span></p></td><td class="cl-07f48fc2"><p class="cl-07f459ee"><span class="cl-07edb31e">0</span></p></td><td class="cl-07f48fc3"><p class="cl-07f459ee"><span class="cl-07edb31e">1</span></p></td><td class="cl-07f48fcc"><p class="cl-07f459ee"><span class="cl-07edb31e">reported</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-07f48fcd"><p class="cl-07f459ee"><span class="cl-07edb31e">Data frame dimensions: 19 rows × 7 columns</span></p></td></tr></tfoot></table></div>
</div>
</div>
</section>
<section id="verify-data-consistency-4" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="verify-data-consistency-4"><span class="header-section-number">3.4.2</span> Verify Data Consistency</h3>
<p>Runs quality checks using the <code>verify_category_totals()</code>, <code>counts_consistent()</code>, and <code>percentages_consistent()</code> functions.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Verifying that demographic counts match reported totals:</code></pre>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">offender_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_profiles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">33711</td>
<td style="text-align: right;">33511</td>
<td style="text-align: right;">200</td>
</tr>
<tr class="even">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">33711</td>
<td style="text-align: right;">33711</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Counts consistency check on raw data:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>All counts consistent: FALSE </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentage consistency check on raw data:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>All percentages sum to ~100%: TRUE </code></pre>
</div>
</div>
</section>
<section id="address-data-gaps-3" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="address-data-gaps-3"><span class="header-section-number">3.4.3</span> Address Data Gaps</h3>
<section id="solve-percentages-inconsistency-1" class="level4" data-number="3.4.3.1">
<h4 data-number="3.4.3.1" class="anchored" data-anchor-id="solve-percentages-inconsistency-1"><span class="header-section-number">3.4.3.1</span> Solve Percentages Inconsistency</h4>
<p>Racial percentages summed to 99.9% instead of 100%</p>
<p>Proportional scaling was applied and <code>value_source</code> was updated to “calculated” for all adjusted values.</p>
<div class="cell">
<details class="code-fold">
<summary>Show percentage recalculation code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start with the raw data</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>me_clean <span class="ot">&lt;-</span> me_raw</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust percentages to ensure they sum to 100% and mark as calculated</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>me_clean <span class="ot">&lt;-</span> me_clean <span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(value_type, variable_category) <span class="sc">%&gt;%</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">ifelse</span>(</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>      value_type <span class="sc">==</span> <span class="st">"percentage"</span> <span class="sc">&amp;</span> variable_category <span class="sc">==</span> <span class="st">"gender"</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>      value <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">/</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>      value</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_source =</span> <span class="fu">ifelse</span>(</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>      value_type <span class="sc">==</span> <span class="st">"percentage"</span> <span class="sc">&amp;</span> variable_category <span class="sc">==</span> <span class="st">"gender"</span>,</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">"calculated"</span>,</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>      value_source</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the new sum</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>percentage_sum <span class="ot">&lt;-</span> me_clean <span class="sc">%&gt;%</span></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(value_type <span class="sc">==</span> <span class="st">"percentage"</span> <span class="sc">&amp;</span> variable_category <span class="sc">==</span> <span class="st">"gender"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Recalculated percentages for Maine - New sum:"</span>, <span class="fu">round</span>(percentage_sum<span class="sc">$</span>total, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Recalculated percentages for Maine - New sum: 100 %</code></pre>
</div>
</div>
</section>
<section id="recalculate-counts-from-percentages" class="level4" data-number="3.4.3.2">
<h4 data-number="3.4.3.2" class="anchored" data-anchor-id="recalculate-counts-from-percentages"><span class="header-section-number">3.4.3.2</span> Recalculate Counts from Percentages</h4>
<p>Maine’s reported gender counts sum were inconsistent with the <code>total_profiles</code>.</p>
<p>We removed existing gender count data and recalculated counts using percentage values and combined totals.</p>
<p>All recalculated values flagged with <code>value_source = "calculated"</code></p>
<div class="cell">
<details class="code-fold">
<summary>Show count recalculation code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove existing gender count rows to avoid duplication</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>me_clean <span class="ot">&lt;-</span> me_clean <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(variable_category <span class="sc">==</span> <span class="st">"gender"</span> <span class="sc">&amp;</span> value_type <span class="sc">==</span> <span class="st">"count"</span>))</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Removed existing gender count data</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>me_gender <span class="ot">&lt;-</span> me_clean <span class="sc">%&gt;%</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="st">"gender"</span> <span class="sc">|</span> variable_category <span class="sc">==</span> <span class="st">"total"</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts from percentages for Combined offender type</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>me_gender <span class="ot">&lt;-</span> <span class="fu">calculate_counts_from_percentages</span>(me_gender, <span class="st">"Maine"</span>)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Append recalculated gender counts to the main dataset</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>me_clean <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(me_clean, me_gender)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Calculated demographic counts from percentages</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the calculations</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Category totals after calculating counts:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a><span class="fu">verify_category_totals</span>(me_clean) <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Removed existing gender count data
✓ Calculated demographic counts from percentages
Category totals after calculating counts:</code></pre>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">offender_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_profiles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">33711</td>
<td style="text-align: right;">33711</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">33711</td>
<td style="text-align: right;">33711</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="verify-data-consistency-5" class="level3" data-number="3.4.4">
<h3 data-number="3.4.4" class="anchored" data-anchor-id="verify-data-consistency-5"><span class="header-section-number">3.4.4</span> Verify Data Consistency</h3>
<p>Final checks to ensure all data is now consistent and complete.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Final data consistency checks:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Counts consistent: TRUE </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Percentages consistent: TRUE </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Final data availability:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Race data: both </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Gender data: both </code></pre>
</div>
</div>
</section>
<section id="prepare-for-combined-dataset-3" class="level3" data-number="3.4.5">
<h3 data-number="3.4.5" class="anchored" data-anchor-id="prepare-for-combined-dataset-3"><span class="header-section-number">3.4.5</span> Prepare for Combined Dataset</h3>
<p>The Maine data is already complete and consistent. It is formatted to match the master schema and appended to the <code>foia_combined</code> dataframe.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Maine data preparation to combined dataset</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data for the combined dataset</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>me_prepared <span class="ot">&lt;-</span> <span class="fu">prepare_state_for_combined</span>(me_clean, <span class="st">"Maine"</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Append to the master combined dataframe</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>foia_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(foia_combined, me_prepared)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Appended "</span>, <span class="fu">nrow</span>(me_prepared), <span class="st">" Maine rows to foia_combined</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Total rows in foia_combined: "</span>, <span class="fu">nrow</span>(foia_combined), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Appended 19 Maine rows to foia_combined
✓ Total rows in foia_combined: 107</code></pre>
</div>
</div>
</section>
<section id="document-metadata-3" class="level3" data-number="3.4.6">
<h3 data-number="3.4.6" class="anchored" data-anchor-id="document-metadata-3"><span class="header-section-number">3.4.6</span> Document Metadata</h3>
<p>The metadata is added with a note that the data was complete and required no processing.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Maine data preparation and addition to metadata table</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Maine to the metadata table using the helper function</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add_state_metadata</span>(<span class="st">"Maine"</span>, me_raw)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Update metadata with QC results</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">update_state_metadata</span>(<span class="st">"Maine"</span>, </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">counts_ok =</span> <span class="fu">counts_consistent</span>(me_clean),</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">percentages_ok =</span> <span class="fu">percentages_consistent</span>(me_clean),</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">notes_text =</span> <span class="st">"Complete dataset provided with both counts and percentages. No processing or calculations required. All values are reported."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Metadata added for: Maine 
✓ Metadata updated for: Maine </code></pre>
</div>
</div>
</section>
<section id="visualizations-3" class="level3" data-number="3.4.7">
<h3 data-number="3.4.7" class="anchored" data-anchor-id="visualizations-3"><span class="header-section-number">3.4.7</span> Visualizations</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/me-visualizations-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Maine DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/me-visualizations-2.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Maine DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/me-visualizations-3.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Maine DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/me-visualizations-4.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Maine DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-statistics-3" class="level3" data-number="3.4.8">
<h3 data-number="3.4.8" class="anchored" data-anchor-id="summary-statistics-3"><span class="header-section-number">3.4.8</span> Summary Statistics</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the summary statistics code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Maine DNA Database Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"="</span>, <span class="fu">strrep</span>(<span class="st">"="</span>, <span class="dv">40</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total profiles by offender type</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Maine"</span>,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>         variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>         variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>,</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>         value_type <span class="sc">==</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(offender_type, value) <span class="sc">%&gt;%</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_formatted =</span> <span class="fu">format</span>(value, <span class="at">big.mark =</span> <span class="st">","</span>))</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(totals)</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Data completeness</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Data completeness:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>completeness <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Maine"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(offender_type, value_source) <span class="sc">%&gt;%</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_values =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(completeness)</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Final verification</span></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Final verification:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Counts consistent:"</span>, <span class="fu">counts_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Maine"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Percentages consistent:"</span>, <span class="fu">percentages_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Maine"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Maine DNA Database Summary:
= ======================================== 
# A tibble: 1 × 3
  offender_type value value_formatted
  &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;          
1 Combined      33711 33,711         

Data completeness:
# A tibble: 2 × 3
  offender_type value_source n_values
  &lt;chr&gt;         &lt;chr&gt;           &lt;int&gt;
1 Combined      calculated          6
2 Combined      reported           13

Final verification:
Counts consistent: TRUE 
Percentages consistent: TRUE </code></pre>
</div>
</div>
</section>
<section id="summary-of-maine-processing" class="level3" data-number="3.4.9">
<h3 data-number="3.4.9" class="anchored" data-anchor-id="summary-of-maine-processing"><span class="header-section-number">3.4.9</span> Summary of Maine Processing</h3>
<p>Maine data processing complete. The dataset is exemplary and required no adjustments:</p>
<ul>
<li><p>✅ <strong>Reported data</strong>: Both <strong>counts and percentages</strong> for all Convicted Offender, Arrestee, and Combined categories</p></li>
<li><p>✅ <strong>No calculated additions needed</strong>: All values are sourced directly from the state report (<strong><code>value_source = "reported"</code></strong>)</p></li>
<li><p>✅ <strong>Quality checks</strong>: All counts and percentages pass consistency validation</p></li>
<li><p>✅ <strong>Provenance tracking</strong>: All values maintain their original <strong><code>value_source</code></strong> as “reported”</p></li>
</ul>
<p>The Maine data is now standardized and ready for cross-state analysis.</p>
</section>
</section>
<section id="nevada-nv" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="nevada-nv"><span class="header-section-number">3.5</span> Nevada (NV)</h2>
<p><strong>Overview</strong>: Nevada provides <strong>both counts and percentages</strong> for gender and race categories but uses non-standard terminology that requires conversion for consistency with our schema.</p>
<section id="examine-raw-data-4" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="examine-raw-data-4"><span class="header-section-number">3.5.1</span> Examine Raw Data</h3>
<p>Establish a baseline understanding of the data exactly as it was received.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-0914f66c{table-layout:auto;width:100%;}.cl-0903ab1e{font-family:'Arial';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-0903ab32{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-090a8394{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-090ab666{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab670{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab67a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab67b{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab684{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab685{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab686{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab68e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab68f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab698{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab699{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6a2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6a3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6ac{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6ad{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6ae{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6b6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6b7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6c0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6c1{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6ca{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6cb{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6d4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6d5{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6de{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6e8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6f2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6f3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6f4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6fc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab6fd{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab706{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab707{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab710{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab711{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab71a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab71b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab724{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab725{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab726{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab72e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab72f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab738{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab739{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab73a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-090ab742{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-0914f66c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-090ab666"><p class="cl-090a8394"><span class="cl-0903ab1e">Column</span></p></th><th class="cl-090ab670"><p class="cl-090a8394"><span class="cl-0903ab1e">Type</span></p></th><th class="cl-090ab67a"><p class="cl-090a8394"><span class="cl-0903ab1e">Rows</span></p></th><th class="cl-090ab67b"><p class="cl-090a8394"><span class="cl-0903ab1e">Missing</span></p></th><th class="cl-090ab684"><p class="cl-090a8394"><span class="cl-0903ab1e">Unique</span></p></th><th class="cl-090ab685"><p class="cl-090a8394"><span class="cl-0903ab1e">Unique_Values</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-090ab686"><p class="cl-090a8394"><span class="cl-0903ab32">state</span></p></td><td class="cl-090ab68e"><p class="cl-090a8394"><span class="cl-0903ab32">character</span></p></td><td class="cl-090ab68f"><p class="cl-090a8394"><span class="cl-0903ab32">21</span></p></td><td class="cl-090ab698"><p class="cl-090a8394"><span class="cl-0903ab32">0</span></p></td><td class="cl-090ab699"><p class="cl-090a8394"><span class="cl-0903ab32">1</span></p></td><td class="cl-090ab6a2"><p class="cl-090a8394"><span class="cl-0903ab32">Nevada</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-090ab6a3"><p class="cl-090a8394"><span class="cl-0903ab32">offender_type</span></p></td><td class="cl-090ab6ac"><p class="cl-090a8394"><span class="cl-0903ab32">character</span></p></td><td class="cl-090ab6ad"><p class="cl-090a8394"><span class="cl-0903ab32">21</span></p></td><td class="cl-090ab6ae"><p class="cl-090a8394"><span class="cl-0903ab32">0</span></p></td><td class="cl-090ab6b6"><p class="cl-090a8394"><span class="cl-0903ab32">4</span></p></td><td class="cl-090ab6b7"><p class="cl-090a8394"><span class="cl-0903ab32">All, Arrestee, Convicted Offender, Combined</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-090ab6c0"><p class="cl-090a8394"><span class="cl-0903ab32">variable_category</span></p></td><td class="cl-090ab6c1"><p class="cl-090a8394"><span class="cl-0903ab32">character</span></p></td><td class="cl-090ab6ca"><p class="cl-090a8394"><span class="cl-0903ab32">21</span></p></td><td class="cl-090ab6cb"><p class="cl-090a8394"><span class="cl-0903ab32">0</span></p></td><td class="cl-090ab6d4"><p class="cl-090a8394"><span class="cl-0903ab32">3</span></p></td><td class="cl-090ab6d5"><p class="cl-090a8394"><span class="cl-0903ab32">total, gender, race</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-090ab6a3"><p class="cl-090a8394"><span class="cl-0903ab32">variable_detailed</span></p></td><td class="cl-090ab6ac"><p class="cl-090a8394"><span class="cl-0903ab32">character</span></p></td><td class="cl-090ab6ad"><p class="cl-090a8394"><span class="cl-0903ab32">21</span></p></td><td class="cl-090ab6ae"><p class="cl-090a8394"><span class="cl-0903ab32">0</span></p></td><td class="cl-090ab6b6"><p class="cl-090a8394"><span class="cl-0903ab32">9</span></p></td><td class="cl-090ab6b7"><p class="cl-090a8394"><span class="cl-0903ab32">total_flags, total_profiles, Female, Male, Unknown, White, American Indian, Black, Asian</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-090ab6de"><p class="cl-090a8394"><span class="cl-0903ab32">value</span></p></td><td class="cl-090ab6e8"><p class="cl-090a8394"><span class="cl-0903ab32">numeric</span></p></td><td class="cl-090ab6f2"><p class="cl-090a8394"><span class="cl-0903ab32">21</span></p></td><td class="cl-090ab6f3"><p class="cl-090a8394"><span class="cl-0903ab32">0</span></p></td><td class="cl-090ab6f4"><p class="cl-090a8394"><span class="cl-0903ab32">21</span></p></td><td class="cl-090ab6fc"><p class="cl-090a8394"><span class="cl-0903ab32">344097 ..., 185074 ..., 53.785 ..., 159023 ..., 46.215 ..., 63287 ..., 18.392 ..., 280738 ..., 81.587 ..., 72 ...</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-090ab6fd"><p class="cl-090a8394"><span class="cl-0903ab32">value_type</span></p></td><td class="cl-090ab706"><p class="cl-090a8394"><span class="cl-0903ab32">character</span></p></td><td class="cl-090ab707"><p class="cl-090a8394"><span class="cl-0903ab32">21</span></p></td><td class="cl-090ab6cb"><p class="cl-090a8394"><span class="cl-0903ab32">0</span></p></td><td class="cl-090ab6d4"><p class="cl-090a8394"><span class="cl-0903ab32">2</span></p></td><td class="cl-090ab710"><p class="cl-090a8394"><span class="cl-0903ab32">count, percentage</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-090ab711"><p class="cl-090a8394"><span class="cl-0903ab32">value_source</span></p></td><td class="cl-090ab71a"><p class="cl-090a8394"><span class="cl-0903ab32">character</span></p></td><td class="cl-090ab71b"><p class="cl-090a8394"><span class="cl-0903ab32">21</span></p></td><td class="cl-090ab724"><p class="cl-090a8394"><span class="cl-0903ab32">0</span></p></td><td class="cl-090ab725"><p class="cl-090a8394"><span class="cl-0903ab32">1</span></p></td><td class="cl-090ab726"><p class="cl-090a8394"><span class="cl-0903ab32">reported</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-090ab72e"><p class="cl-090a8394"><span class="cl-0903ab32">Data frame dimensions: 21 rows × 7 columns</span></p></td></tr></tfoot></table></div>
</div>
</div>
</section>
<section id="verify-data-consistency-6" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="verify-data-consistency-6"><span class="header-section-number">3.5.2</span> Verify Data Consistency</h3>
<p>Initial check reveals Nevada’s non-standard terminology.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Initial data availability:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Race data: both </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Gender data: both </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Non-standard terminology found:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Offender types: All, Arrestee, Convicted Offender, Combined </code></pre>
</div>
</div>
</section>
<section id="address-data-gaps-4" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="address-data-gaps-4"><span class="header-section-number">3.5.3</span> Address Data Gaps</h3>
<section id="standardize-terminology-3" class="level4" data-number="3.5.3.1">
<h4 data-number="3.5.3.1" class="anchored" data-anchor-id="standardize-terminology-3"><span class="header-section-number">3.5.3.1</span> Standardize Terminology</h4>
<p>Nevada uses “All” instead of “Combined”, “total_flags” instead of “total_profiles” and “American Indian” instead of “Native American”.</p>
<div class="cell">
<details class="code-fold">
<summary>Show terminology standardization code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start with raw data</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>nv_clean <span class="ot">&lt;-</span> nv_raw</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize offender types and racial terminology</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>nv_clean <span class="ot">&lt;-</span> nv_clean <span class="sc">%&gt;%</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">offender_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>      offender_type <span class="sc">==</span> <span class="st">"All"</span> <span class="sc">~</span> <span class="st">"Combined"</span>,</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> offender_type</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable_detailed =</span> <span class="fu">case_when</span>(</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>      variable_detailed <span class="sc">==</span> <span class="st">"total_flags"</span> <span class="sc">~</span> <span class="st">"total_profiles"</span>,</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> variable_detailed</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable_detailed =</span> <span class="fu">case_when</span>(</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>      variable_detailed <span class="sc">==</span> <span class="st">"American Indian"</span> <span class="sc">~</span> <span class="st">"Native American"</span>,</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> variable_detailed</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Standardized terminology:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - 'All' → 'Combined'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - 'total_flags' → 'total_profiles'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - 'American Indian' → 'Native American'</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Standardized terminology:
  - 'All' → 'Combined'
  - 'total_flags' → 'total_profiles'
  - 'American Indian' → 'Native American'</code></pre>
</div>
</div>
</section>
<section id="verify-consistency" class="level4" data-number="3.5.3.2">
<h4 data-number="3.5.3.2" class="anchored" data-anchor-id="verify-consistency"><span class="header-section-number">3.5.3.2</span> Verify Consistency</h4>
<p>Now that the offender types are standardized, we can verify the counts and percentages.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Verifying that demographic counts match reported totals:</code></pre>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">offender_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_profiles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">344097</td>
<td style="text-align: right;">344097</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">344097</td>
<td style="text-align: right;">344097</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Counts consistency check on raw data:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>All counts consistent: TRUE </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentage consistency check on raw data:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>All percentages sum to ~100%: TRUE </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum of 'race' percentages: 100 %</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum of 'gender' percentages: 100 %</code></pre>
</div>
</div>
</section>
</section>
<section id="prepare-for-combined-dataset-4" class="level3" data-number="3.5.4">
<h3 data-number="3.5.4" class="anchored" data-anchor-id="prepare-for-combined-dataset-4"><span class="header-section-number">3.5.4</span> Prepare for Combined Dataset</h3>
<p>The cleaned data is formatted to match the master schema and appended to the <code>foia_combined</code> dataframe.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Nevada data preparation to combined dataset</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the cleaned data for the combined dataset</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>nv_prepared <span class="ot">&lt;-</span> <span class="fu">prepare_state_for_combined</span>(nv_clean, <span class="st">"Nevada"</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Append to the master combined dataframe</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>foia_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(foia_combined, nv_prepared)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Appended "</span>, <span class="fu">nrow</span>(nv_prepared), <span class="st">" Nevada rows to foia_combined</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Total rows in foia_combined: "</span>, <span class="fu">nrow</span>(foia_combined), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Appended 21 Nevada rows to foia_combined
✓ Total rows in foia_combined: 128</code></pre>
</div>
</div>
</section>
<section id="document-metadata-4" class="level3" data-number="3.5.5">
<h3 data-number="3.5.5" class="anchored" data-anchor-id="document-metadata-4"><span class="header-section-number">3.5.5</span> Document Metadata</h3>
<p>The metadata is added with details on the terminology standardization performed.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Nevada data preparation and addition to metadata table</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Nevada to the metadata table using the helper function</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add_state_metadata</span>(<span class="st">"Nevada"</span>, nv_raw)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Update metadata with QC results and processing notes</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">update_state_metadata</span>(<span class="st">"Nevada"</span>, </span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">counts_ok =</span> <span class="fu">counts_consistent</span>(nv_clean),</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">percentages_ok =</span> <span class="fu">percentages_consistent</span>(nv_clean),</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">notes_text =</span> <span class="st">"Standardized terminology: 'All' to 'Combined' and 'American Indian' to 'Native American'. All values remain reported."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Metadata added for: Nevada 
✓ Metadata updated for: Nevada </code></pre>
</div>
</div>
</section>
<section id="visualizations-4" class="level3" data-number="3.5.6">
<h3 data-number="3.5.6" class="anchored" data-anchor-id="visualizations-4"><span class="header-section-number">3.5.6</span> Visualizations</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/nv-visualizations-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Nevada DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/nv-visualizations-2.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Nevada DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/nv-visualizations-3.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Nevada DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/nv-visualizations-4.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Nevada DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-statistics-4" class="level3" data-number="3.5.7">
<h3 data-number="3.5.7" class="anchored" data-anchor-id="summary-statistics-4"><span class="header-section-number">3.5.7</span> Summary Statistics</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the summary statistics code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nevada DNA Database Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"="</span>, <span class="fu">strrep</span>(<span class="st">"="</span>, <span class="dv">40</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total profiles by offender type</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Nevada"</span>,</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>         variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>         variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>,</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>         value_type <span class="sc">==</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(offender_type, value) <span class="sc">%&gt;%</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_formatted =</span> <span class="fu">format</span>(value, <span class="at">big.mark =</span> <span class="st">","</span>))</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(totals)</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Data completeness</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Data completeness:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>completeness <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Nevada"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(offender_type, value_source) <span class="sc">%&gt;%</span></span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_values =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(completeness)</span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Final verification</span></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Final verification:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Counts consistent:"</span>, <span class="fu">counts_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Nevada"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Percentages consistent:"</span>, <span class="fu">percentages_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Nevada"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Nevada DNA Database Summary:
= ======================================== 
# A tibble: 3 × 3
  offender_type       value value_formatted
  &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;          
1 Combined           344097 344,097        
2 Arrestee           185074 185,074        
3 Convicted Offender 159023 159,023        

Data completeness:
# A tibble: 3 × 3
  offender_type      value_source n_values
  &lt;chr&gt;              &lt;chr&gt;           &lt;int&gt;
1 Arrestee           reported            2
2 Combined           reported           17
3 Convicted Offender reported            2

Final verification:
Counts consistent: TRUE 
Percentages consistent: FALSE </code></pre>
</div>
</div>
</section>
<section id="summary-of-nevada-processing" class="level3" data-number="3.5.8">
<h3 data-number="3.5.8" class="anchored" data-anchor-id="summary-of-nevada-processing"><span class="header-section-number">3.5.8</span> Summary of Nevada Processing</h3>
<p>Nevada data processing complete. The dataset required minimal adjustments:</p>
<ul>
<li><p>✅ <strong>Terminology standardization</strong>:</p>
<ul>
<li><p>“All” → “Combined” (offender type)</p></li>
<li><p>“American Indian” → “Native American” (race category)</p></li>
</ul></li>
<li><p>✅ <strong>Reported data</strong>: Both counts and percentages for all categories</p></li>
<li><p>✅ <strong>Quality checks</strong>: All counts and percentages pass consistency validation</p></li>
<li><p>✅ <strong>Provenance tracking</strong>: All values maintain <strong><code>value_source = "reported"</code></strong> as only terminology changes were made</p></li>
</ul>
<p>The Nevada data is now standardized and ready for cross-state analysis.</p>
</section>
</section>
<section id="south-dakota-sd" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="south-dakota-sd"><span class="header-section-number">3.6</span> South Dakota (SD)</h2>
<p><strong>Overview</strong>: South Dakota provides the most comprehensive reporting with <strong>both counts and percentages</strong> for all standard categories plus unique intersectional gender×race data. Minor terminology standardization is required for consistency.</p>
<section id="examine-raw-data-5" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="examine-raw-data-5"><span class="header-section-number">3.6.1</span> Examine Raw Data</h3>
<p>Establish a baseline understanding of the data exactly as it was received.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-0a1f4ada{table-layout:auto;width:100%;}.cl-0a0d6496{font-family:'Arial';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-0a0d64a0{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-0a148276{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-0a14b674{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b67e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b688{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b692{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b693{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b69c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b69d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6a6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6a7{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6b0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6b1{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6b2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6ba{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6bb{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6c4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6c5{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6ce{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6d8{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6d9{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6da{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6e2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6e3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6ec{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6ed{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6ee{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b6f6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b700{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b701{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b702{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b70a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b70b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b70c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b714{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b715{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b71e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b71f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b728{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b729{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b732{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b733{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b73c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b73d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b746{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b747{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b750{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b75a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b75b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b764{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b765{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b766{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b76e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0a14b76f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-0a1f4ada"><thead><tr style="overflow-wrap:break-word;"><th class="cl-0a14b674"><p class="cl-0a148276"><span class="cl-0a0d6496">Column</span></p></th><th class="cl-0a14b67e"><p class="cl-0a148276"><span class="cl-0a0d6496">Type</span></p></th><th class="cl-0a14b688"><p class="cl-0a148276"><span class="cl-0a0d6496">Rows</span></p></th><th class="cl-0a14b692"><p class="cl-0a148276"><span class="cl-0a0d6496">Missing</span></p></th><th class="cl-0a14b693"><p class="cl-0a148276"><span class="cl-0a0d6496">Unique</span></p></th><th class="cl-0a14b69c"><p class="cl-0a148276"><span class="cl-0a0d6496">Unique_Values</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-0a14b69d"><p class="cl-0a148276"><span class="cl-0a0d64a0">state</span></p></td><td class="cl-0a14b6a6"><p class="cl-0a148276"><span class="cl-0a0d64a0">character</span></p></td><td class="cl-0a14b6a7"><p class="cl-0a148276"><span class="cl-0a0d64a0">41</span></p></td><td class="cl-0a14b6b0"><p class="cl-0a148276"><span class="cl-0a0d64a0">0</span></p></td><td class="cl-0a14b6b1"><p class="cl-0a148276"><span class="cl-0a0d64a0">1</span></p></td><td class="cl-0a14b6b2"><p class="cl-0a148276"><span class="cl-0a0d64a0">South Dakota</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0a14b6ba"><p class="cl-0a148276"><span class="cl-0a0d64a0">offender_type</span></p></td><td class="cl-0a14b6bb"><p class="cl-0a148276"><span class="cl-0a0d64a0">character</span></p></td><td class="cl-0a14b6c4"><p class="cl-0a148276"><span class="cl-0a0d64a0">41</span></p></td><td class="cl-0a14b6c5"><p class="cl-0a148276"><span class="cl-0a0d64a0">0</span></p></td><td class="cl-0a14b6ce"><p class="cl-0a148276"><span class="cl-0a0d64a0">1</span></p></td><td class="cl-0a14b6d8"><p class="cl-0a148276"><span class="cl-0a0d64a0">Combined</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0a14b6d9"><p class="cl-0a148276"><span class="cl-0a0d64a0">variable_category</span></p></td><td class="cl-0a14b6da"><p class="cl-0a148276"><span class="cl-0a0d64a0">character</span></p></td><td class="cl-0a14b6e2"><p class="cl-0a148276"><span class="cl-0a0d64a0">41</span></p></td><td class="cl-0a14b6e3"><p class="cl-0a148276"><span class="cl-0a0d64a0">0</span></p></td><td class="cl-0a14b6ec"><p class="cl-0a148276"><span class="cl-0a0d64a0">4</span></p></td><td class="cl-0a14b6ed"><p class="cl-0a148276"><span class="cl-0a0d64a0">total, gender, race, gender_race</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0a14b6ee"><p class="cl-0a148276"><span class="cl-0a0d64a0">variable_detailed</span></p></td><td class="cl-0a14b6f6"><p class="cl-0a148276"><span class="cl-0a0d64a0">character</span></p></td><td class="cl-0a14b700"><p class="cl-0a148276"><span class="cl-0a0d64a0">41</span></p></td><td class="cl-0a14b701"><p class="cl-0a148276"><span class="cl-0a0d64a0">0</span></p></td><td class="cl-0a14b702"><p class="cl-0a148276"><span class="cl-0a0d64a0">21</span></p></td><td class="cl-0a14b70a"><p class="cl-0a148276"><span class="cl-0a0d64a0">total_profiles ..., Male ..., Female ..., Asian ..., Black ..., Hispanic ..., Native American ..., Other/Unknown ..., White/Caucasian ..., Male_Asian ...</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0a14b70b"><p class="cl-0a148276"><span class="cl-0a0d64a0">value</span></p></td><td class="cl-0a14b70c"><p class="cl-0a148276"><span class="cl-0a0d64a0">numeric</span></p></td><td class="cl-0a14b714"><p class="cl-0a148276"><span class="cl-0a0d64a0">41</span></p></td><td class="cl-0a14b715"><p class="cl-0a148276"><span class="cl-0a0d64a0">0</span></p></td><td class="cl-0a14b71e"><p class="cl-0a148276"><span class="cl-0a0d64a0">38</span></p></td><td class="cl-0a14b71f"><p class="cl-0a148276"><span class="cl-0a0d64a0">67753 ..., 51197 ..., 75.56 ..., 16556 ..., 24.44 ..., 5 ..., 0.08 ..., 4041 ..., 5.96 ..., 2949 ...</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0a14b728"><p class="cl-0a148276"><span class="cl-0a0d64a0">value_type</span></p></td><td class="cl-0a14b729"><p class="cl-0a148276"><span class="cl-0a0d64a0">character</span></p></td><td class="cl-0a14b732"><p class="cl-0a148276"><span class="cl-0a0d64a0">41</span></p></td><td class="cl-0a14b6e3"><p class="cl-0a148276"><span class="cl-0a0d64a0">0</span></p></td><td class="cl-0a14b6ec"><p class="cl-0a148276"><span class="cl-0a0d64a0">2</span></p></td><td class="cl-0a14b733"><p class="cl-0a148276"><span class="cl-0a0d64a0">count, percentage</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0a14b73c"><p class="cl-0a148276"><span class="cl-0a0d64a0">value_source</span></p></td><td class="cl-0a14b73d"><p class="cl-0a148276"><span class="cl-0a0d64a0">character</span></p></td><td class="cl-0a14b746"><p class="cl-0a148276"><span class="cl-0a0d64a0">41</span></p></td><td class="cl-0a14b747"><p class="cl-0a148276"><span class="cl-0a0d64a0">0</span></p></td><td class="cl-0a14b750"><p class="cl-0a148276"><span class="cl-0a0d64a0">1</span></p></td><td class="cl-0a14b75a"><p class="cl-0a148276"><span class="cl-0a0d64a0">reported</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-0a14b75b"><p class="cl-0a148276"><span class="cl-0a0d64a0">Data frame dimensions: 41 rows × 7 columns</span></p></td></tr></tfoot></table></div>
</div>
</div>
</section>
<section id="gender-race-intersection-analysis" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="gender-race-intersection-analysis"><span class="header-section-number">3.6.2</span> Gender-race intersection analysis</h3>
<p>Since South Dakota is the only state that reported gender-race intersection data, we can analyze it in detail.</p>
<div class="cell quarto-layout-panel" data-layout-ncol="1" data-fig-fontsize="16">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/sd-intersectional-visuals-1.png" class="img-fluid figure-img" width="1728"></p>
<figcaption>South Dakota Intersectional Gender × Race Analysis</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="verify-data-consistency-7" class="level3" data-number="3.6.3">
<h3 data-number="3.6.3" class="anchored" data-anchor-id="verify-data-consistency-7"><span class="header-section-number">3.6.3</span> Verify Data Consistency</h3>
<p>Initial check reveals South Dakota’s comprehensive data structure with some non-standard terminology.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Initial data availability:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Race data: both </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Gender data: both </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Non-standard terminology found:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Race terms: Asian, Black, Hispanic, Native American, Other/Unknown, White/Caucasian </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Verifying that demographic counts match reported totals:</code></pre>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">offender_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_profiles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">67753</td>
<td style="text-align: right;">67753</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">67753</td>
<td style="text-align: right;">67702</td>
<td style="text-align: right;">51</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Counts consistency check on raw data:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>All counts consistent: FALSE </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentage consistency check on raw data:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>All percentages sum to ~100%: TRUE </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum of 'race' percentages: 100 %</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum of 'gender' percentages: 100 %</code></pre>
</div>
</div>
</section>
<section id="address-data-gaps-5" class="level3" data-number="3.6.4">
<h3 data-number="3.6.4" class="anchored" data-anchor-id="address-data-gaps-5"><span class="header-section-number">3.6.4</span> Address Data Gaps</h3>
<section id="standardize-terminology-4" class="level4" data-number="3.6.4.1">
<h4 data-number="3.6.4.1" class="anchored" data-anchor-id="standardize-terminology-4"><span class="header-section-number">3.6.4.1</span> Standardize Terminology</h4>
<p>South Dakota uses “White/Caucasian” and “Other/Unknown” which need standardization.</p>
<div class="cell">
<details class="code-fold">
<summary>Show terminology standardization code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize racial terminology</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>sd_clean <span class="ot">&lt;-</span> sd_clean <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable_detailed =</span> <span class="fu">case_when</span>(</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>      variable_detailed <span class="sc">==</span> <span class="st">"White/Caucasian"</span> <span class="sc">~</span> <span class="st">"White"</span>,</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>      variable_detailed <span class="sc">==</span> <span class="st">"Other/Unknown"</span> <span class="sc">~</span> <span class="st">"Unknown"</span>,</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> variable_detailed</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Standardized terminology:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - 'White/Caucasian' → 'White'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - 'Other/Unknown' → 'Unknown'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the changes</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Race categories after standardization:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>sd_clean <span class="sc">%&gt;%</span></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="st">"race"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(variable_detailed) <span class="sc">%&gt;%</span></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() <span class="sc">%&gt;%</span></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="at">collapse =</span> <span class="st">", "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Standardized terminology:
  - 'White/Caucasian' → 'White'
  - 'Other/Unknown' → 'Unknown'

Race categories after standardization:
Asian, Black, Hispanic, Native American, Unknown, White</code></pre>
</div>
</div>
</section>
<section id="recalculate-counts-from-percentages-1" class="level4" data-number="3.6.4.2">
<h4 data-number="3.6.4.2" class="anchored" data-anchor-id="recalculate-counts-from-percentages-1"><span class="header-section-number">3.6.4.2</span> Recalculate Counts from Percentages</h4>
<p>South Dakota’s reported race counts sum were inconsistent with the <code>total_profiles</code>.</p>
<p>We removed existing gender count data and recalculated counts using percentage values and combined totals.</p>
<p>All recalculated values flagged with <code>value_source = "calculated"</code></p>
<div class="cell">
<details class="code-fold">
<summary>Show count recalculation code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove existing gender count rows to avoid duplication</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>sd_clean <span class="ot">&lt;-</span> sd_clean <span class="sc">%&gt;%</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(variable_category <span class="sc">==</span> <span class="st">"race"</span> <span class="sc">&amp;</span> value_type <span class="sc">==</span> <span class="st">"count"</span>))</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Removed existing race count data</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>sd_race <span class="ot">&lt;-</span> sd_clean <span class="sc">%&gt;%</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="st">"race"</span> <span class="sc">|</span> variable_category <span class="sc">==</span> <span class="st">"total"</span>)</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate counts from percentages for Combined offender type</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>sd_race <span class="ot">&lt;-</span> <span class="fu">calculate_counts_from_percentages</span>(sd_race, <span class="st">"South Dakota"</span>)</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Append recalculated race counts to the main dataset</span></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>sd_clean <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(sd_clean, sd_race)</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Calculated demographic counts from percentages</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the calculations</span></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Category totals after calculating counts:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a><span class="fu">verify_category_totals</span>(sd_clean) <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Removed existing race count data
✓ Calculated demographic counts from percentages
Category totals after calculating counts:</code></pre>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">offender_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_profiles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">67753</td>
<td style="text-align: right;">67753</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">67753</td>
<td style="text-align: right;">67752</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We handled this diffence of 1 by adding it to the most representative race (White).</p>
<div class="cell">
<details class="code-fold">
<summary>Show difference handle code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle the difference of 1 by adding it to the most representative race</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>sd_clean <span class="ot">&lt;-</span> sd_clean <span class="sc">%&gt;%</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(variable_detailed <span class="sc">==</span> <span class="st">"White"</span> <span class="sc">&amp;</span> value_type <span class="sc">==</span> <span class="st">"count"</span>, value <span class="sc">+</span> <span class="dv">1</span>, value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="verify-data-consistency-8" class="level3" data-number="3.6.5">
<h3 data-number="3.6.5" class="anchored" data-anchor-id="verify-data-consistency-8"><span class="header-section-number">3.6.5</span> Verify Data Consistency</h3>
<p>Final checks to ensure standardization didn’t affect data integrity.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Final data consistency checks after standardization:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Verifying that demographic counts match reported totals:</code></pre>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">offender_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_profiles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">67753</td>
<td style="text-align: right;">67753</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">67753</td>
<td style="text-align: right;">67753</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Counts consistency check:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>All counts consistent: TRUE </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentage consistency check:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>All percentages sum to ~100%: TRUE </code></pre>
</div>
</div>
</section>
<section id="prepare-for-combined-dataset-5" class="level3" data-number="3.6.6">
<h3 data-number="3.6.6" class="anchored" data-anchor-id="prepare-for-combined-dataset-5"><span class="header-section-number">3.6.6</span> Prepare for Combined Dataset</h3>
<p>The cleaned data is formatted to match the master schema and appended to the <code>foia_combined</code> dataframe.</p>
<div class="cell">
<details class="code-fold">
<summary>Show South Dakota data preparation to combined dataset</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the cleaned data for the combined dataset</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>sd_prepared <span class="ot">&lt;-</span> <span class="fu">prepare_state_for_combined</span>(sd_clean, <span class="st">"South Dakota"</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Append to the master combined dataframe</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>foia_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(foia_combined, sd_prepared)</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Appended "</span>, <span class="fu">nrow</span>(sd_prepared), <span class="st">" South Dakota rows to foia_combined</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Total rows in foia_combined: "</span>, <span class="fu">nrow</span>(foia_combined), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the comprehensive nature of South Dakota's data</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">South Dakota's comprehensive data structure:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>sd_prepared <span class="sc">%&gt;%</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable_category) <span class="sc">%&gt;%</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_rows =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Appended 17 South Dakota rows to foia_combined
✓ Total rows in foia_combined: 145

South Dakota's comprehensive data structure:</code></pre>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n_rows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">gender</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">race</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">total</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="document-metadata-5" class="level3" data-number="3.6.7">
<h3 data-number="3.6.7" class="anchored" data-anchor-id="document-metadata-5"><span class="header-section-number">3.6.7</span> Document Metadata</h3>
<p>The metadata is added with details on South Dakota’s comprehensive reporting and the terminology standardization performed.</p>
<div class="cell">
<details class="code-fold">
<summary>Show South Dakota data preparation and addition to metadata table</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add South Dakota to the metadata table using the helper function</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add_state_metadata</span>(<span class="st">"South Dakota"</span>, sd_raw)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Update metadata with QC results and processing notes</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">update_state_metadata</span>(<span class="st">"South Dakota"</span>, </span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">counts_ok =</span> <span class="fu">counts_consistent</span>(sd_clean),</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">percentages_ok =</span> <span class="fu">percentages_consistent</span>(sd_clean),</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">notes_text =</span> <span class="st">"Standardized terminology: 'White/Caucasian' to 'White' and 'Other/Unknown' to 'Unknown'. Includes comprehensive gender_race intersectional data. All values remain reported."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Metadata added for: South Dakota 
✓ Metadata updated for: South Dakota </code></pre>
</div>
</div>
</section>
<section id="visualizations-5" class="level3" data-number="3.6.8">
<h3 data-number="3.6.8" class="anchored" data-anchor-id="visualizations-5"><span class="header-section-number">3.6.8</span> Visualizations</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/sd-visualizations-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>South Dakota DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/sd-visualizations-2.png" class="img-fluid figure-img" width="768"></p>
<figcaption>South Dakota DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/sd-visualizations-3.png" class="img-fluid figure-img" width="768"></p>
<figcaption>South Dakota DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/sd-visualizations-4.png" class="img-fluid figure-img" width="768"></p>
<figcaption>South Dakota DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-statistics-5" class="level3" data-number="3.6.9">
<h3 data-number="3.6.9" class="anchored" data-anchor-id="summary-statistics-5"><span class="header-section-number">3.6.9</span> Summary Statistics</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the summary statistics code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"South Dakota DNA Database Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"="</span>, <span class="fu">strrep</span>(<span class="st">"="</span>, <span class="dv">40</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total profiles by offender type</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"South Dakota"</span>,</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>         variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>         variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>,</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>         value_type <span class="sc">==</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(offender_type, value) <span class="sc">%&gt;%</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_formatted =</span> <span class="fu">format</span>(value, <span class="at">big.mark =</span> <span class="st">","</span>))</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(totals)</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Data completeness by category</span></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Data completeness by category:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>completeness <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"South Dakota"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable_category) <span class="sc">%&gt;%</span></span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_values =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(completeness)</span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Final verification</span></span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Final verification:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Counts consistent:"</span>, <span class="fu">counts_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"South Dakota"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Percentages consistent:"</span>, <span class="fu">percentages_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"South Dakota"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>South Dakota DNA Database Summary:
= ======================================== 
# A tibble: 1 × 3
  offender_type value value_formatted
  &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;          
1 Combined      67753 67,753         

Data completeness by category:
# A tibble: 3 × 2
  variable_category n_values
  &lt;chr&gt;                &lt;int&gt;
1 gender                   4
2 race                    12
3 total                    1

Final verification:
Counts consistent: TRUE 
Percentages consistent: TRUE </code></pre>
</div>
</div>
</section>
<section id="summary-of-south-dakota-processing" class="level3" data-number="3.6.10">
<h3 data-number="3.6.10" class="anchored" data-anchor-id="summary-of-south-dakota-processing"><span class="header-section-number">3.6.10</span> Summary of South Dakota Processing</h3>
<p>South Dakota data processing complete. The state provided exemplary data with minimal adjustments needed:</p>
<ul>
<li><p>✅ <strong>Terminology standardization</strong>:</p>
<ul>
<li><p>“White/Caucasian” → “White”</p></li>
<li><p>“Other/Unknown” → “Unknown”</p></li>
</ul></li>
<li><p>✅ <strong>Comprehensive reporting</strong>: Standard demographics plus unique gender×race intersectional data</p></li>
<li><p>✅ <strong>Reported data</strong>: Both counts and percentages for all categories</p></li>
<li><p>✅ <strong>Quality checks</strong>: All counts and percentages pass consistency validation</p></li>
<li><p>✅ <strong>Provenance tracking</strong>: All values maintain <strong><code>value_source = "reported"</code></strong> as only terminology changes were made</p></li>
</ul>
<p>South Dakota’s data is now standardized and ready for cross-state analysis.</p>
</section>
</section>
<section id="texas-tx" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="texas-tx"><span class="header-section-number">3.7</span> Texas (TX)</h2>
<p><strong>Overview</strong>: Texas provides <strong>counts only</strong> for gender and race categories. The Male gender is missing in the dataset. The state uses non-standard terminology that requires conversion and needs Combined totals and percentages calculated.</p>
<section id="examine-raw-data-6" class="level3" data-number="3.7.1">
<h3 data-number="3.7.1" class="anchored" data-anchor-id="examine-raw-data-6"><span class="header-section-number">3.7.1</span> Examine Raw Data</h3>
<p>Establish a baseline understanding of the data exactly as it was received.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-0c102490{table-layout:auto;width:100%;}.cl-0bff523c{font-family:'Arial';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-0bff5250{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-0c05efca{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-0c062206{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062210{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c06221a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c06221b{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c06221c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062224{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062225{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c06222e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062238{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062239{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062242{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062243{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062244{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c06224c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c06224d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062256{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062257{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062260{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062261{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c06226a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c06226b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062274{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062275{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c06227e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c06227f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062288{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062289{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062292{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c06229c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c06229d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622a6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622a7{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622a8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622b0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622ba{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622bb{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622bc{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622c4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622c5{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622ce{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622cf{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622d8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622d9{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622e2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622e3{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622ec{background-color:rgba(255, 243, 205, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622ed{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622ee{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622f6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c0622f7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062300{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c062301{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0c06230a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-0c102490"><thead><tr style="overflow-wrap:break-word;"><th class="cl-0c062206"><p class="cl-0c05efca"><span class="cl-0bff523c">Column</span></p></th><th class="cl-0c062210"><p class="cl-0c05efca"><span class="cl-0bff523c">Type</span></p></th><th class="cl-0c06221a"><p class="cl-0c05efca"><span class="cl-0bff523c">Rows</span></p></th><th class="cl-0c06221b"><p class="cl-0c05efca"><span class="cl-0bff523c">Missing</span></p></th><th class="cl-0c06221c"><p class="cl-0c05efca"><span class="cl-0bff523c">Unique</span></p></th><th class="cl-0c062224"><p class="cl-0c05efca"><span class="cl-0bff523c">Unique_Values</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-0c062225"><p class="cl-0c05efca"><span class="cl-0bff5250">state</span></p></td><td class="cl-0c06222e"><p class="cl-0c05efca"><span class="cl-0bff5250">character</span></p></td><td class="cl-0c062238"><p class="cl-0c05efca"><span class="cl-0bff5250">16</span></p></td><td class="cl-0c062239"><p class="cl-0c05efca"><span class="cl-0bff5250">0</span></p></td><td class="cl-0c062242"><p class="cl-0c05efca"><span class="cl-0bff5250">1</span></p></td><td class="cl-0c062243"><p class="cl-0c05efca"><span class="cl-0bff5250">Texas</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0c062244"><p class="cl-0c05efca"><span class="cl-0bff5250">offender_type</span></p></td><td class="cl-0c06224c"><p class="cl-0c05efca"><span class="cl-0bff5250">character</span></p></td><td class="cl-0c06224d"><p class="cl-0c05efca"><span class="cl-0bff5250">16</span></p></td><td class="cl-0c062256"><p class="cl-0c05efca"><span class="cl-0bff5250">0</span></p></td><td class="cl-0c062257"><p class="cl-0c05efca"><span class="cl-0bff5250">2</span></p></td><td class="cl-0c062260"><p class="cl-0c05efca"><span class="cl-0bff5250">Offenders, Arrestee</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0c062261"><p class="cl-0c05efca"><span class="cl-0bff5250">variable_category</span></p></td><td class="cl-0c06226a"><p class="cl-0c05efca"><span class="cl-0bff5250">character</span></p></td><td class="cl-0c06226b"><p class="cl-0c05efca"><span class="cl-0bff5250">16</span></p></td><td class="cl-0c062274"><p class="cl-0c05efca"><span class="cl-0bff5250">0</span></p></td><td class="cl-0c062275"><p class="cl-0c05efca"><span class="cl-0bff5250">3</span></p></td><td class="cl-0c06227e"><p class="cl-0c05efca"><span class="cl-0bff5250">total, gender, race</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0c06227f"><p class="cl-0c05efca"><span class="cl-0bff5250">variable_detailed</span></p></td><td class="cl-0c062288"><p class="cl-0c05efca"><span class="cl-0bff5250">character</span></p></td><td class="cl-0c062289"><p class="cl-0c05efca"><span class="cl-0bff5250">16</span></p></td><td class="cl-0c062292"><p class="cl-0c05efca"><span class="cl-0bff5250">0</span></p></td><td class="cl-0c06229c"><p class="cl-0c05efca"><span class="cl-0bff5250">8</span></p></td><td class="cl-0c06229d"><p class="cl-0c05efca"><span class="cl-0bff5250">total_profiles, Female, Asian, African American, Caucasian, Hispanic, Native American, Other</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0c0622a6"><p class="cl-0c05efca"><span class="cl-0bff5250">value</span></p></td><td class="cl-0c0622a7"><p class="cl-0c05efca"><span class="cl-0bff5250">numeric</span></p></td><td class="cl-0c0622a8"><p class="cl-0c05efca"><span class="cl-0bff5250">16</span></p></td><td class="cl-0c0622b0"><p class="cl-0c05efca"><span class="cl-0bff5250">0</span></p></td><td class="cl-0c0622ba"><p class="cl-0c05efca"><span class="cl-0bff5250">16</span></p></td><td class="cl-0c0622bb"><p class="cl-0c05efca"><span class="cl-0bff5250">845322 ..., 73631 ..., 121434 ..., 18721 ..., 3361 ..., 254366 ..., 309010 ..., 276245 ..., 138 ..., 2173 ...</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0c0622bc"><p class="cl-0c05efca"><span class="cl-0bff5250">value_type</span></p></td><td class="cl-0c0622c4"><p class="cl-0c05efca"><span class="cl-0bff5250">character</span></p></td><td class="cl-0c0622c5"><p class="cl-0c05efca"><span class="cl-0bff5250">16</span></p></td><td class="cl-0c062274"><p class="cl-0c05efca"><span class="cl-0bff5250">0</span></p></td><td class="cl-0c0622ce"><p class="cl-0c05efca"><span class="cl-0bff5250">1</span></p></td><td class="cl-0c0622cf"><p class="cl-0c05efca"><span class="cl-0bff5250">count</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0c0622d8"><p class="cl-0c05efca"><span class="cl-0bff5250">value_source</span></p></td><td class="cl-0c0622d9"><p class="cl-0c05efca"><span class="cl-0bff5250">character</span></p></td><td class="cl-0c0622e2"><p class="cl-0c05efca"><span class="cl-0bff5250">16</span></p></td><td class="cl-0c0622e3"><p class="cl-0c05efca"><span class="cl-0bff5250">0</span></p></td><td class="cl-0c0622ec"><p class="cl-0c05efca"><span class="cl-0bff5250">1</span></p></td><td class="cl-0c0622ed"><p class="cl-0c05efca"><span class="cl-0bff5250">reported</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="6" class="cl-0c0622ee"><p class="cl-0c05efca"><span class="cl-0bff5250">Data frame dimensions: 16 rows × 7 columns</span></p></td></tr></tfoot></table></div>
</div>
</div>
</section>
<section id="verify-data-consistency-9" class="level3" data-number="3.7.2">
<h3 data-number="3.7.2" class="anchored" data-anchor-id="verify-data-consistency-9"><span class="header-section-number">3.7.2</span> Verify Data Consistency</h3>
<p>Initial checks reveal Texas’s reporting structure and terminology differences.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Initial data availability:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Race data: counts </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Gender data: counts </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Non-standard terminology found:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Offender types: Offenders, Arrestee </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Race terms: Asian, African American, Caucasian, Hispanic, Native American, Other </code></pre>
</div>
</div>
</section>
<section id="address-data-gaps-6" class="level3" data-number="3.7.3">
<h3 data-number="3.7.3" class="anchored" data-anchor-id="address-data-gaps-6"><span class="header-section-number">3.7.3</span> Address Data Gaps</h3>
<section id="add-missing-male-category" class="level4" data-number="3.7.3.1">
<h4 data-number="3.7.3.1" class="anchored" data-anchor-id="add-missing-male-category"><span class="header-section-number">3.7.3.1</span> Add Missing Male category</h4>
<p>Texas data reports only Female counts explicitly. We calculated Male counts by subtracting Female counts from total profiles, assuming binary gender classification in the dataset.</p>
<div class="cell">
<details class="code-fold">
<summary>Show male addition code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, let's examine the current structure of gender data</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>gender_data <span class="ot">&lt;-</span> tx_raw <span class="sc">%&gt;%</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="st">"gender"</span>)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Current gender structure:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(gender_data<span class="sc">$</span>variable_detailed))</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get total profiles for each offender type</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>total_profiles <span class="ot">&lt;-</span> tx_raw <span class="sc">%&gt;%</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="st">"total"</span> <span class="sc">&amp;</span> variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(offender_type, <span class="at">total_value =</span> value)</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Join total profiles with gender data</span></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>gender_with_totals <span class="ot">&lt;-</span> gender_data <span class="sc">%&gt;%</span></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(total_profiles, <span class="at">by =</span> <span class="st">"offender_type"</span>)</span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Male entries for each offender type</span></span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a>male_entries <span class="ot">&lt;-</span> gender_with_totals <span class="sc">%&gt;%</span></span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable_detailed <span class="sc">==</span> <span class="st">"Female"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable_detailed =</span> <span class="st">"Male"</span>,</span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> total_value <span class="sc">-</span> value, </span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_source =</span> <span class="st">"calculated"</span>,</span>
<span id="cb141-24"><a href="#cb141-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_value =</span> <span class="cn">NULL</span> </span>
<span id="cb141-25"><a href="#cb141-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb141-26"><a href="#cb141-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-27"><a href="#cb141-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Add these entries to the original dataset</span></span>
<span id="cb141-28"><a href="#cb141-28" aria-hidden="true" tabindex="-1"></a>tx_raw_with_male <span class="ot">&lt;-</span> tx_raw <span class="sc">%&gt;%</span></span>
<span id="cb141-29"><a href="#cb141-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(male_entries)</span>
<span id="cb141-30"><a href="#cb141-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-31"><a href="#cb141-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Update the tx_raw object</span></span>
<span id="cb141-32"><a href="#cb141-32" aria-hidden="true" tabindex="-1"></a>tx_clean <span class="ot">&lt;-</span> tx_raw_with_male</span>
<span id="cb141-33"><a href="#cb141-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-34"><a href="#cb141-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the addition</span></span>
<span id="cb141-35"><a href="#cb141-35" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">After adding Male entries - gender categories:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb141-36"><a href="#cb141-36" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(tx_clean <span class="sc">%&gt;%</span> </span>
<span id="cb141-37"><a href="#cb141-37" aria-hidden="true" tabindex="-1"></a>       <span class="fu">filter</span>(variable_category <span class="sc">==</span> <span class="st">"gender"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb141-38"><a href="#cb141-38" aria-hidden="true" tabindex="-1"></a>       <span class="fu">pull</span>(variable_detailed)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Current gender structure:
[1] "Female"

After adding Male entries - gender categories:
[1] "Female" "Male"  </code></pre>
</div>
</div>
</section>
<section id="standardize-terminology-5" class="level4" data-number="3.7.3.2">
<h4 data-number="3.7.3.2" class="anchored" data-anchor-id="standardize-terminology-5"><span class="header-section-number">3.7.3.2</span> Standardize Terminology</h4>
<p>Texas uses “Offenders” instead of “Convicted Offender” and “Caucasian” instead of “White”.</p>
<div class="cell">
<details class="code-fold">
<summary>Show terminology standardization code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize offender types and racial terminology</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>tx_clean <span class="ot">&lt;-</span> tx_clean <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">offender_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>      offender_type <span class="sc">==</span> <span class="st">"Offenders"</span> <span class="sc">~</span> <span class="st">"Convicted Offender"</span>,</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> offender_type</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable_detailed =</span> <span class="fu">case_when</span>(</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>      variable_detailed <span class="sc">==</span> <span class="st">"Caucasian"</span> <span class="sc">~</span> <span class="st">"White"</span>,</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>      variable_detailed <span class="sc">==</span> <span class="st">"African American"</span> <span class="sc">~</span> <span class="st">"Black"</span>,</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> variable_detailed</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Standardized terminology:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - 'Offenders' → 'Convicted Offender'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - 'Caucasian' → 'White'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  - 'African American' → 'Black'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Offender types after standardization:"</span>, <span class="fu">paste</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(tx_clean<span class="sc">$</span>offender_type)), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Standardized terminology:
  - 'Offenders' → 'Convicted Offender'
  - 'Caucasian' → 'White'
  - 'African American' → 'Black'
Offender types after standardization: Arrestee, Convicted Offender </code></pre>
</div>
</div>
</section>
<section id="create-unknown-category-1" class="level4" data-number="3.7.3.3">
<h4 data-number="3.7.3.3" class="anchored" data-anchor-id="create-unknown-category-1"><span class="header-section-number">3.7.3.3</span> Create Unknown Category</h4>
<p>Texas race count is inconsistent, with a significant number of profiles not reported in any racial category.</p>
<p>Unknown category was created to account for these missing profiles.</p>
<p>The calculated values are added with a <strong><code>value_source = "calculated"</code></strong> tag to maintain transparency about what was provided versus what was derived.</p>
<div class="cell">
<details class="code-fold">
<summary>Show unknown addition code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Unknown race category to reconcile totals</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>tx_clean <span class="ot">&lt;-</span> <span class="fu">fill_demographic_gaps</span>(tx_clean)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify the fix</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Category totals after adding Unknown race category:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="fu">verify_category_totals</span>(tx_clean) <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>()</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Counts consistency after adding Unknown:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"All counts consistent:"</span>, <span class="fu">counts_consistent</span>(tx_clean), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Category totals after adding Unknown race category:</code></pre>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">offender_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_profiles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Arrestee</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">73631</td>
<td style="text-align: right;">73631</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arrestee</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">73631</td>
<td style="text-align: right;">73631</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Convicted Offender</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">845322</td>
<td style="text-align: right;">845322</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Convicted Offender</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">845322</td>
<td style="text-align: right;">845322</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Counts consistency after adding Unknown:
All counts consistent: TRUE </code></pre>
</div>
</div>
</section>
<section id="create-combined-totals-1" class="level4" data-number="3.7.3.4">
<h4 data-number="3.7.3.4" class="anchored" data-anchor-id="create-combined-totals-1"><span class="header-section-number">3.7.3.4</span> Create Combined Totals</h4>
<p>Texas only reported data for “Convicted Offender” and “Arrestee” separately. We calculate Combined totals.</p>
<div class="cell">
<details class="code-fold">
<summary>Show combined addition code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Combined totals using helper function</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>tx_clean <span class="ot">&lt;-</span> <span class="fu">add_combined</span>(tx_clean)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Created Combined totals for Texas</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the Combined total</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>combined_total <span class="ot">&lt;-</span> tx_clean <span class="sc">%&gt;%</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(offender_type <span class="sc">==</span> <span class="st">"Combined"</span>,</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>         variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>         variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(value)</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Combined total profiles:"</span>, <span class="fu">format</span>(combined_total, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Created Combined totals for Texas
Combined total profiles: 918,953 </code></pre>
</div>
</div>
</section>
<section id="calculate-percentages-1" class="level4" data-number="3.7.3.5">
<h4 data-number="3.7.3.5" class="anchored" data-anchor-id="calculate-percentages-1"><span class="header-section-number">3.7.3.5</span> Calculate Percentages</h4>
<p>Transforms the data from counts into percentages for comparative analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Show percentage calculation code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Derive percentages from counts</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>tx_clean <span class="ot">&lt;-</span> <span class="fu">add_percentages</span>(tx_clean)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"✓ Added percentages for all demographic categories</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Check percentage consistency</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Percentage consistency check:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"All percentages sum to ~100%:"</span>, <span class="fu">percentages_consistent</span>(tx_clean), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>))</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Show current data availability</span></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Final data availability:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Race data:"</span>, <span class="fu">report_status</span>(tx_clean, <span class="st">"race"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Gender data:"</span>, <span class="fu">report_status</span>(tx_clean, <span class="st">"gender"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Added percentages for all demographic categories
Percentage consistency check:
All percentages sum to ~100%: TRUE 

Final data availability:
Race data: both 
Gender data: both </code></pre>
</div>
</div>
</section>
</section>
<section id="verify-data-consistency-10" class="level3" data-number="3.7.4">
<h3 data-number="3.7.4" class="anchored" data-anchor-id="verify-data-consistency-10"><span class="header-section-number">3.7.4</span> Verify Data Consistency</h3>
<p>Final checks to ensure all processing maintained data integrity.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Final data consistency checks:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Verifying that demographic counts match reported totals:</code></pre>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">offender_type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">total_profiles</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sum_counts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Arrestee</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">73631</td>
<td style="text-align: right;">73631</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arrestee</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">73631</td>
<td style="text-align: right;">73631</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">918953</td>
<td style="text-align: right;">918953</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Combined</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">918953</td>
<td style="text-align: right;">918953</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Convicted Offender</td>
<td style="text-align: left;">gender</td>
<td style="text-align: right;">845322</td>
<td style="text-align: right;">845322</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Convicted Offender</td>
<td style="text-align: left;">race</td>
<td style="text-align: right;">845322</td>
<td style="text-align: right;">845322</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Counts consistency check:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>All counts consistent: TRUE </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentage consistency check:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>All percentages sum to ~100%: TRUE </code></pre>
</div>
</div>
</section>
<section id="prepare-for-combined-dataset-6" class="level3" data-number="3.7.5">
<h3 data-number="3.7.5" class="anchored" data-anchor-id="prepare-for-combined-dataset-6"><span class="header-section-number">3.7.5</span> Prepare for Combined Dataset</h3>
<p>The cleaned data is formatted to match the master schema and appended to the <code>foia_combined</code> dataframe.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Texas data preparation to combined dataset</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the cleaned data for the combined dataset</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>tx_prepared <span class="ot">&lt;-</span> <span class="fu">prepare_state_for_combined</span>(tx_clean, <span class="st">"Texas"</span>)</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Append to the master combined dataframe</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>foia_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(foia_combined, tx_prepared)</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Appended "</span>, <span class="fu">nrow</span>(tx_prepared), <span class="st">" Texas rows to foia_combined</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"✓ Total rows in foia_combined: "</span>, <span class="fu">nrow</span>(foia_combined), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Appended 57 Texas rows to foia_combined
✓ Total rows in foia_combined: 202</code></pre>
</div>
</div>
</section>
<section id="document-metadata-6" class="level3" data-number="3.7.6">
<h3 data-number="3.7.6" class="anchored" data-anchor-id="document-metadata-6"><span class="header-section-number">3.7.6</span> Document Metadata</h3>
<p>The metadata is added with details on all processing steps performed.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Texas data preparation and addition to metadata table</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Texas to the metadata table using the helper function</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add_state_metadata</span>(<span class="st">"Texas"</span>, tx_raw)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Update metadata with QC results and processing notes</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="fu">update_state_metadata</span>(<span class="st">"Texas"</span>, </span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">counts_ok =</span> <span class="fu">counts_consistent</span>(tx_clean),</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">percentages_ok =</span> <span class="fu">percentages_consistent</span>(tx_clean),</span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">notes_text =</span> <span class="st">"Standardized terminology: 'Offenders' to 'Convicted Offender', 'Caucasian' to 'White', 'African American' to 'Black'; calculated Combined totals and all percentages"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Metadata added for: Texas 
✓ Metadata updated for: Texas </code></pre>
</div>
</div>
</section>
<section id="visualizations-6" class="level3" data-number="3.7.7">
<h3 data-number="3.7.7" class="anchored" data-anchor-id="visualizations-6"><span class="header-section-number">3.7.7</span> Visualizations</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/tx-visualizations-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Texas DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/tx-visualizations-2.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Texas DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/tx-visualizations-3.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Texas DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/tx-visualizations-4.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Texas DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/tx-visualizations-5.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Texas DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/tx-visualizations-6.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Texas DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/tx-visualizations-7.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Texas DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/tx-visualizations-8.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Texas DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/tx-visualizations-9.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Texas DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/tx-visualizations-10.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Texas DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/tx-visualizations-11.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Texas DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/tx-visualizations-12.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Texas DNA Database Demographic Distributions</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="foia_processing_files/figure-html/tx-bar-charts-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Texas Demographic Distributions by Offender Type</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-statistics-6" class="level3" data-number="3.7.8">
<h3 data-number="3.7.8" class="anchored" data-anchor-id="summary-statistics-6"><span class="header-section-number">3.7.8</span> Summary Statistics</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the summary statistics code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Texas DNA Database Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"="</span>, <span class="fu">strrep</span>(<span class="st">"="</span>, <span class="dv">40</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total profiles by offender type</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>totals <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Texas"</span>,</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>         variable_category <span class="sc">==</span> <span class="st">"total"</span>,</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>         variable_detailed <span class="sc">==</span> <span class="st">"total_profiles"</span>,</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>         value_type <span class="sc">==</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(offender_type, value, value_source) <span class="sc">%&gt;%</span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_formatted =</span> <span class="fu">format</span>(value, <span class="at">big.mark =</span> <span class="st">","</span>))</span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(totals)</span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Data completeness by value source</span></span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Data completeness by source:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>completeness <span class="ot">&lt;-</span> foia_combined <span class="sc">%&gt;%</span></span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Texas"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(value_source) <span class="sc">%&gt;%</span></span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_values =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(completeness)</span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Final verification</span></span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Final verification:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Counts consistent:"</span>, <span class="fu">counts_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Texas"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb162-27"><a href="#cb162-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"Percentages consistent:"</span>, <span class="fu">percentages_consistent</span>(foia_combined <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">"Texas"</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Texas DNA Database Summary:
= ======================================== 
# A tibble: 3 × 4
  offender_type       value value_source value_formatted
  &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;          
1 Convicted Offender 845322 reported     "845,322"      
2 Arrestee            73631 reported     " 73,631"      
3 Combined           918953 calculated   "918,953"      

Data completeness by source:
# A tibble: 2 × 2
  value_source n_values
  &lt;chr&gt;           &lt;int&gt;
1 calculated         41
2 reported           16

Final verification:
Counts consistent: TRUE 
Percentages consistent: TRUE </code></pre>
</div>
</div>
</section>
<section id="summary-of-texas-processing" class="level3" data-number="3.7.9">
<h3 data-number="3.7.9" class="anchored" data-anchor-id="summary-of-texas-processing"><span class="header-section-number">3.7.9</span> Summary of Texas Processing</h3>
<p>Texas data processing complete. The dataset required several adjustments:</p>
<ul>
<li><p>✅ <strong>Male Category Addition</strong>:</p>
<ul>
<li>“Male” added to <code>variable_detailed</code></li>
</ul></li>
<li><p>✅ <strong>Terminology standardization</strong>:</p>
<ul>
<li><p>“Offenders” → “Convicted Offender”</p></li>
<li><p>“Caucasian” → “White”</p></li>
<li><p>“African American” → “Black”</p></li>
</ul></li>
<li><p>✅ <strong>Calculated additions</strong>:</p>
<ul>
<li><p>Combined totals across all offender types</p></li>
<li><p>Percentage values for all demographic categories</p></li>
</ul></li>
<li><p>✅ <strong>Quality checks</strong>: All counts and percentages pass consistency validation</p></li>
<li><p>✅ <strong>Provenance tracking</strong>: Clear distinction between reported and calculated values</p></li>
</ul>
<p>The Texas data is now standardized and ready for cross-state analysis.</p>
</section>
</section>
<section id="combined-dataset" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="combined-dataset"><span class="header-section-number">3.8</span> Combined Dataset</h2>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-d351df97c9611ff42ef7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d351df97c9611ff42ef7">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"2771721\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","California","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Florida","Indiana","Indiana","Indiana","Indiana","Indiana","Indiana","Indiana","Indiana","Indiana","Indiana","Indiana","Indiana","Indiana","Indiana","Indiana","Maine","Maine","Maine","Maine","Maine","Maine","Maine","Maine","Maine","Maine","Maine","Maine","Maine","Maine","Maine","Maine","Maine","Maine","Maine","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","Nevada","South Dakota","South Dakota","South Dakota","South Dakota","South Dakota","South Dakota","South Dakota","South Dakota","South Dakota","South Dakota","South Dakota","South Dakota","South Dakota","South Dakota","South Dakota","South Dakota","South Dakota","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas","Texas"],["Convicted Offender","Arrestee","Convicted Offender","Convicted Offender","Convicted Offender","Arrestee","Arrestee","Arrestee","Convicted Offender","Convicted Offender","Convicted Offender","Convicted Offender","Arrestee","Arrestee","Arrestee","Arrestee","Convicted Offender","Arrestee","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Convicted Offender","Convicted Offender","Convicted Offender","Arrestee","Arrestee","Arrestee","Convicted Offender","Convicted Offender","Convicted Offender","Convicted Offender","Arrestee","Arrestee","Arrestee","Arrestee","Convicted Offender","Arrestee","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Convicted Offender","Arrestee","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Arrestee","Arrestee","Convicted Offender","Convicted Offender","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Convicted Offender","Arrestee","Convicted Offender","Arrestee","Convicted Offender","Convicted Offender","Convicted Offender","Convicted Offender","Convicted Offender","Convicted Offender","Arrestee","Arrestee","Arrestee","Arrestee","Arrestee","Arrestee","Convicted Offender","Arrestee","Convicted Offender","Arrestee","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Convicted Offender","Arrestee","Convicted Offender","Convicted Offender","Convicted Offender","Convicted Offender","Convicted Offender","Convicted Offender","Arrestee","Arrestee","Arrestee","Arrestee","Arrestee","Arrestee","Convicted Offender","Arrestee","Convicted Offender","Arrestee","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined","Combined"],["total","total","gender","gender","gender","gender","gender","gender","race","race","race","race","race","race","race","race","race","race","gender","gender","gender","race","race","race","race","race","total","gender","gender","gender","gender","gender","gender","race","race","race","race","race","race","race","race","race","race","gender","gender","gender","race","race","race","race","race","total","total","gender","gender","gender","gender","gender","gender","race","race","race","race","race","race","race","race","race","race","race","race","race","race","total","total","gender","gender","race","race","race","race","total","gender","gender","race","race","race","race","total","gender","gender","gender","race","race","race","race","race","race","race","race","race","race","race","race","gender","gender","gender","total","total","total","total","total","gender","gender","gender","gender","gender","gender","race","race","race","race","race","race","race","race","race","race","total","gender","gender","gender","gender","race","race","race","race","race","race","race","race","race","race","race","race","total","total","gender","gender","race","race","race","race","race","race","race","race","race","race","race","race","gender","gender","race","race","gender","gender","race","race","race","race","race","race","race","total","gender","gender","race","race","race","race","race","race","race","race","race","race","race","race","gender","gender","race","race","gender","gender","race","race","race","race","race","race","race"],["total_profiles","total_profiles","Female","Male","Unknown","Female","Male","Unknown","Black","White","Hispanic","Asian","Black","White","Hispanic","Asian","Unknown","Unknown","Female","Male","Unknown","Black","Asian","White","Hispanic","Unknown","total_profiles","Female","Male","Unknown","Female","Male","Unknown","Black","White","Hispanic","Asian","Black","White","Hispanic","Asian","Unknown","Unknown","Female","Male","Unknown","Black","Asian","White","Hispanic","Unknown","total_profiles","total_profiles","Female","Female","Male","Male","Unknown","Unknown","Black","Black","Asian","Asian","White","White","Hispanic","Hispanic","Native American","Native American","Other","Other","Unknown","Unknown","total_profiles","total_profiles","Female","Male","White","Black","Hispanic","Other","total_profiles","Female","Male","White","Black","Hispanic","Other","total_profiles","Male","Female","Unknown","White","White","Black","Black","Unknown","Unknown","Native American","Native American","Hispanic","Hispanic","Asian","Asian","Male","Female","Unknown","total_profiles","total_profiles","total_profiles","total_profiles","total_profiles","Female","Female","Male","Male","Unknown","Unknown","White","White","Unknown","Unknown","Native American","Native American","Black","Black","Asian","Asian","total_profiles","Male","Male","Female","Female","Asian","Black","Hispanic","Native American","Unknown","White","Asian","Black","Hispanic","Native American","Unknown","White","total_profiles","total_profiles","Female","Female","Asian","Black","White","Hispanic","Native American","Other","Asian","Black","White","Hispanic","Native American","Other","Male","Male","Unknown","Unknown","Female","Male","Asian","Black","Hispanic","Native American","Other","Unknown","White","total_profiles","Female","Female","Asian","Black","White","Hispanic","Native American","Other","Asian","Black","White","Hispanic","Native American","Other","Male","Male","Unknown","Unknown","Female","Male","Asian","Black","Hispanic","Native American","Other","Unknown","White"],[2019899,751822,309827,1603222,106850,208225,524231,19366,368952,588555,652121,16384,104741,231313,308450,11191,393887,96127,518052,2127453,126216,473693,27575,819868,960571,490014,2771721,15.34,79.37,5.29,27.7,69.73,2.58,18.27,29.14,32.28,0.8100000000000001,13.93,30.77,41.03,1.49,19.5,12.79,18.69,76.76000000000001,4.55,17.09,0.99,29.58,34.66,17.68,1175391,100,260885,22.2,901126,76.67,13380,1.14,413733,35.2,2659,0.23,721485,61.38,28452,2.42,667,0.06,1176,0.1,7219,0.61,279654,21087,20,80,69.65174129353234,25.87064676616916,3.980099502487562,0.4975124378109453,300741,60148,240593,209471,77804,11970,1496,33711,82.78278278278277,17.01701701701701,0.2002002002002002,31298,92.8,1299,3.9,470,1.4,345,1,171,0.5,128,0.4,27907,5737,67,344097,185074,53.785,159023,46.215,63287,18.392,280738,81.587,72,0.0209,238723,69.377,3491,1.015,5710,1.659,88174,25.625,7999,2.346,67753,51197,75.56,16556,24.44,0.08,5.96,4.35,21.54,1.32,66.75,54,4038,2947,14594,894,45226,845322,73631,121434,18721,3361,254366,309010,276245,138,2173,497,12903,33486,24202,24,358,723888,54910,29,2161,140155,778798,3858,267269,300447,162,2531,2190,342496,918953,14.37,25.43,0.4,30.09,36.56,32.68,0.02,0.26,0.67,17.52,45.48,32.87,0.03,0.49,85.63,74.56999999999999,0,2.93,15.25,84.75,0.42,29.08,32.69,0.02,0.28,0.24,37.27],["count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","count","percentage","percentage","percentage","percentage","percentage","percentage","count","count","count","count","count","count","count","count","percentage","percentage","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","count","count","count","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","percentage","count","count","percentage","count","percentage","percentage","percentage","percentage","percentage","percentage","percentage","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","count","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage","percentage"],["reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","reported","calculated","calculated","calculated","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","calculated","calculated","calculated","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","calculated","calculated","calculated","calculated","calculated","calculated","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","reported","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated","calculated"]],"container":"<table class=\"cell-border stripe hover\">\n  <thead>\n    <tr>\n      <th>state<\/th>\n      <th>offender_type<\/th>\n      <th>variable_category<\/th>\n      <th>variable_detailed<\/th>\n      <th>value<\/th>\n      <th>value_type<\/th>\n      <th>value_source<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","colvis"],"scrollX":true,"scrollY":"300px","scroller":true,"pageLength":10,"columnDefs":[{"className":"dt-left","targets":[0,1,2,3,4,5,6]},{"name":"state","targets":0},{"name":"offender_type","targets":1},{"name":"variable_category","targets":2},{"name":"variable_detailed","targets":3},{"name":"value","targets":4},{"name":"value_type","targets":5},{"name":"value_source","targets":6}],"autoWidth":true,"language":{"search":"Filter:","paginate":{"previous":"Previous","next":"Next"}},"order":[],"orderClasses":false,"orderCellsTop":true,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[0]; $(this.api().cell(row, 0).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'font-size':'12px','line-height':'90%'});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="foia_processing_files/figure-html/combine-all-states-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="foia_processing_files/figure-html/combine-all-states-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="metadata-table" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="metadata-table"><span class="header-section-number">3.9</span> Metadata table</h2>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-78642885bc2515b43721" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-78642885bc2515b43721">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["California","Florida","Indiana","Maine","Nevada","South Dakota","Texas"],["counts","both","percentages","both","both","both","counts"],["counts","both","percentages","both","both","both","counts"],["counts","both","counts","counts","both","counts","counts"],[true,false,true,false,true,false,false],[true,false,true,false,true,false,true],[false,true,true,true,true,true,false],[true,true,false,true,true,false,false],[false,true,true,false,false,false,true],[true,true,true,false,true,true,true],[false,false,false,false,false,true,false],[true,true,true,true,true,true,true],[true,true,true,true,false,true,true],[true,false,false,false,false,false,true],["Added Unknown race category to reconcile totals; calculated Combined totals and all percentages","Complete dataset provided. No processing or calculations required. All values are reported.","Converted string values to numeric; standardized 'Black' to 'African American'; calculated Combined total profiles; derived all demographic counts from reported percentages","Complete dataset provided with both counts and percentages. No processing or calculations required. All values are reported.","Standardized terminology: 'All' to 'Combined' and 'American Indian' to 'Native American'. All values remain reported.","Standardized terminology: 'White/Caucasian' to 'White' and 'Other/Unknown' to 'Unknown'. Includes comprehensive gender_race intersectional data. All values remain reported.","Standardized terminology: 'Offenders' to 'Convicted Offender', 'Caucasian' to 'White', 'African American' to 'Black'; calculated Combined totals and all percentages"]],"container":"<table class=\"cell-border stripe hover\">\n  <thead>\n    <tr>\n      <th>state<\/th>\n      <th>race_data_provided<\/th>\n      <th>gender_data_provided<\/th>\n      <th>total_profiles_provided<\/th>\n      <th>convicted_offender_reported<\/th>\n      <th>arrestee_reported<\/th>\n      <th>combined_reported<\/th>\n      <th>has_unknown_category<\/th>\n      <th>has_other_category<\/th>\n      <th>uses_nonstandard_terminology<\/th>\n      <th>provides_crosstabulation<\/th>\n      <th>counts_sum_to_total<\/th>\n      <th>percentages_sum_to_100<\/th>\n      <th>total_calculated_combined<\/th>\n      <th>notes<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","colvis"],"scrollX":true,"scrollY":"300px","scroller":true,"pageLength":8,"columnDefs":[{"className":"dt-left","targets":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{"name":"state","targets":0},{"name":"race_data_provided","targets":1},{"name":"gender_data_provided","targets":2},{"name":"total_profiles_provided","targets":3},{"name":"convicted_offender_reported","targets":4},{"name":"arrestee_reported","targets":5},{"name":"combined_reported","targets":6},{"name":"has_unknown_category","targets":7},{"name":"has_other_category","targets":8},{"name":"uses_nonstandard_terminology","targets":9},{"name":"provides_crosstabulation","targets":10},{"name":"counts_sum_to_total","targets":11},{"name":"percentages_sum_to_100","targets":12},{"name":"total_calculated_combined","targets":13},{"name":"notes","targets":14}],"autoWidth":true,"language":{"search":"Filter:","paginate":{"previous":"Previous","next":"Next"}},"order":[],"orderClasses":false,"orderCellsTop":true,"lengthMenu":[8,10,25,50,100],"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[0]; $(this.api().cell(row, 0).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[2]; $(this.api().cell(row, 2).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[7]; $(this.api().cell(row, 7).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[8]; $(this.api().cell(row, 8).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[9]; $(this.api().cell(row, 9).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[10]; $(this.api().cell(row, 10).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[11]; $(this.api().cell(row, 11).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[12]; $(this.api().cell(row, 12).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[13]; $(this.api().cell(row, 13).node()).css({'font-size':'12px','line-height':'90%'});\nvar value=data[14]; $(this.api().cell(row, 14).node()).css({'font-size':'12px','line-height':'90%'});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="saving-processed-data" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Saving Processed Data</h1>
<div class="cell">
<details class="code-fold">
<summary>Show final saving process code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define output paths</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>output_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"foia"</span>, <span class="st">"final"</span>)</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(output_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the combined dataset</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>foia_output_path <span class="ot">&lt;-</span> <span class="fu">here</span>(output_dir, <span class="st">"foia_data_clean.csv"</span>)</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(foia_combined, foia_output_path)</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"✓ Saved combined FOIA data to:"</span>, foia_output_path, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the metadata</span></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>metadata_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"foia"</span>, <span class="st">"intermediate"</span>)</span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>metadata_output_path <span class="ot">&lt;-</span> <span class="fu">here</span>(metadata_dir, <span class="st">"foia_state_metadata.csv"</span>)</span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(foia_state_metadata, metadata_output_path)</span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"✓ Saved state metadata to:"</span>, metadata_output_path, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create final frozen version (v1.0)</span></span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>frozen_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"v1.0"</span>)</span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(frozen_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a>frozen_path <span class="ot">&lt;-</span> <span class="fu">here</span>(frozen_dir, <span class="st">"FOIA_demographics.csv"</span>)</span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(foia_combined, frozen_path)</span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"✓ Created frozen version 1.0 at:"</span>, frozen_path, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">✅ All processing complete! The data is now ready for analysis.</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✓ Saved combined FOIA data to: C:/Users/Donadio/Documents/PODFRIDGE_Databases/data/foia/final/foia_data_clean.csv 
✓ Saved state metadata to: C:/Users/Donadio/Documents/PODFRIDGE_Databases/data/foia/intermediate/foia_state_metadata.csv 
✓ Created frozen version 1.0 at: C:/Users/Donadio/Documents/PODFRIDGE_Databases/data/v1.0/FOIA_demographics.csv 

✅ All processing complete! The data is now ready for analysis.</code></pre>
</div>
</div>
</section>
<section id="conclusions" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Conclusions</h1>
<ol type="1">
<li><p><strong>Data Acquisition and Harmonization</strong>: We ingested seven unique state datasets (<code>california_foia_data.csv</code> through <code>texas_foia_data.csv</code>), each with distinct reporting formats, terminology, and levels of completeness. Through a systematic processing workflow, we harmonized these into a single, tidy long-format dataset (<code>foia_combined</code>), ensuring consistency across all variables.</p></li>
<li><p><strong>Standardization of Terminology</strong>: A significant challenge was the non-standard terminology used across states. We implemented a rigorous process to map all state-specific terms to a common data model:</p>
<ul>
<li><p><strong>Offender Types</strong>: Standardized to <code>"Convicted Offender"</code>, <code>"Arrestee"</code>, and <code>"Combined"</code>.</p></li>
<li><p><strong>Race Categories</strong>: Mapped terms like <code>"Caucasian"</code>, <code>"African American"</code>, and <code>"American Indian"</code> to standardized categories (<code>"White"</code>, <code>"Black"</code>, <code>"Native American"</code>).</p></li>
<li><p><strong>Total Profiles</strong>: Consolidated terms like <code>"total_flags"</code> to <code>"total_profiles"</code>.</p></li>
</ul></li>
<li><p><strong>Imputation and Calculation of Missing Data</strong>: To ensure comparability, we calculated values that were not directly provided by the states:</p>
<ul>
<li><p><strong>Derived Percentages</strong>: For states providing only counts (CA, TX), we calculated percentage compositions.</p></li>
<li><p><strong>Derived Counts</strong>: For states providing only percentages (IN), we calculated absolute numbers using reported totals.</p></li>
<li><p><strong>Calculated Totals</strong>: We created <code>"Combined"</code> offender type totals for states that only reported separate <code>"Convicted Offender"</code> and <code>"Arrestee"</code> figures.</p></li>
<li><p><strong>Inferred Categories</strong>: We added <code>"Unknown"</code> race and <code>"Male"</code> gender categories where they were logically missing but necessary to reconcile reported totals (CA, TX).</p></li>
</ul></li>
<li><p><strong>Quality Assurance and Transparency</strong>: A core principle of this project was maintaining transparency and data provenance. This allows future researchers to understand exactly what was provided by the state versus what was derived during processing.</p>
<ul>
<li><p><strong>Validation checks</strong>: <code>counts_consistent()</code>, <code>percentages_consistent()</code></p></li>
<li><p><strong>Value tagging</strong>: <code>"reported"</code> or <code>"calculated"</code>.</p></li>
<li><p><strong>Metadata table</strong>: <code>foia_state_metadata</code> provides a clear audit trail of each state’s original characteristics and the processing steps applied.</p></li>
</ul></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>